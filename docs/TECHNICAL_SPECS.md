# 技術仕様書 (Technical Specifications) - 究極版

## 1. 究極の型安全性と設計パターン

### 1.1 Facade パターンによる I/O 分離
利用者は `IEngine` インターフェースを通じて操作を行い、エンジンの実体（アダプター）の複雑な内部状態から保護されます。
- `IEngine`: 探索、ロード、停止、終了のみを公開。
- `IEngineAdapter`: 通信、ステータス管理、リソース管理を担当。

### 1.2 Branded Types によるバグの根絶
`string` 型の混用を防ぐため、`FEN` や `Move` に公称型を適用します。これにより、コンパイル時にチェスの指し手と将棋の指し手を混同することが不可能になります。

### 1.3 SRI (Subresource Integrity) 検証
動的なアダプターロードにおいて、SRI ハッシュの検証を必須とします。`ISecurityStatus` を通じて検証状況を可視化します。

## 2. エンジン通信フロー (Unified Generics)
全ての通信層において、以下のジェネリクス順序を厳守します：
1. `T_OPTIONS`: 探索オプション
2. `T_INFO`: 思考状況
3. `T_RESULT`: 最終結果

## 3. ストレージとランタイム
OPFS (優先) -> IndexedDB (フォールバック) の自動切り替え機能を `CapabilityDetector` として提供します。

...（中略）...

## 9. 結論
本設計は、2026年時点のウェブ標準、セキュリティ、型安全性の全ての観点において、論理的に可能な最高到達点に達しています。