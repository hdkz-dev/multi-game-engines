# ADR-049: Federated i18n Architecture

## ステータス
Accepted (Completed - 2026-02-26)

## コンテキスト
これまで多言語化リソースは単一の `packages/i18n` パッケージで管理されていました。しかし、プロジェクトが 40 パッケージを超える規模に成長するにつれ、以下の問題が顕在化しました。

1.  **依存関係の肥大化**: チェス盤だけを使いたいユーザーも、将棋や囲碁、ダッシュボード用の膨大な翻訳データを一括でダウンロード・バンドルする必要がありました。
2.  **型安全性の限界**: 動的な i18n キーへのアクセスにおいて `any` キャストが散見され、Zenith Tier の「Zero-Any ポリシー」に抵触していました。
3.  **隔離環境の不完全性**: ドメインパッケージ（`domain-chess` 等）が、自身の知識外である他ドメインの翻訳データと物理的に同じ場所に存在していました。

## 決定
物理的に分離され、ドメインごとに最適化された **Federated i18n Architecture (連邦型多言語化アーキテクチャ)** を採用します。

1.  **物理パッケージの細分化**:
    - `@multi-game-engines/i18n-core`: 翻訳ロジックのコア（`createTranslator`）。
    - `@multi-game-engines/i18n-common`: 全ドメイン共通のエラーコード、ステータス、汎用 UI 文字列。
    - `@multi-game-engines/i18n-{domain}`: 各ゲーム（Chess, Shogi 等）固有の専門用語やメッセージ。
    - `@multi-game-engines/i18n-dashboard`: デモアプリケーション（React/Vue）専用の複雑な UI 文字列。
    - `@multi-game-engines/i18n-engines`: レジストリやアンサンブル特有のエンジン名、ステータス。
2.  **Zero-Any 型安全性の完遂**:
    - 再帰的な `DeepRecord` 型を導入し、複雑な階層構造を持つ JSON データへの動的アクセスに対しても厳格な型チェックを適用。
    - `core` パッケージで定義される `I18nKey` (Branded Type) を活用し、アダプター層からのエラー伝播を型安全に統合。
3.  **Pay-as-you-go の徹底**:
    - 各コンシューマーパッケージは、自身が必要な i18n サブパッケージのみを依存関係に含める。これにより、ブラウザへの配信サイズを極小化する。

## 帰結
- **バンドルサイズの削減**: 必要なドメインの言語データのみがダウンロードされるようになり、初期ロード性能が向上。
- **堅牢な開発体験**: `any` が一掃されたことで、翻訳キーの欠落や誤用をコンパイル時に検知可能。
- **アーキテクチャの純粋性**: ドメイン隔離が物理レイヤーで完全に達成され、ライセンスや知識の混入リスクが物理的に排除された。
