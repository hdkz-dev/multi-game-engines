# ADR-014: 全パッケージ MIT ライセンス化のための疎結合アーキテクチャ

- **ステータス**: 承認済み
- **日付**: 2026-02-06

## 1. コンテキスト (Context)

プロジェクト全体のライセンスを MIT とし、商用利用や組み込みの障壁を最小限に抑える必要がある。一方、強力なチェスエンジン（Stockfish 等）は GPL ライセンスであり、単純に同梱するとプロジェクト全体が GPL 感染するリスクがある。

## 2. 決定 (Decision)

1. **アダプターの役割を「プロトコルハンドラー」に限定**: `adapter-stockfish` 等のパッケージにはエンジンバイナリ (`.wasm`) を含めず、通信プロトコル（UCI/USI）の処理と型定義のみを実装する。
2. **バイナリの動的ロード**: エンジンバイナリは実行時に外部 CDN またはユーザー指定のパスから動的にロードする。
3. **物理的隔離**: エンジンは常に WebWorker (またはネイティブプロセス) 内で実行し、メインスレッドの MIT コードと静的にリンクさせない。

## 3. 結果 (Consequences)

- **メリット**:
  - プロジェクトの全パッケージを MIT ライセンスで提供可能。
  - ユーザーはライセンス感染を気にせずライブラリを導入できる。
  - エンジンの更新とアダプターの更新を独立して行える。
- **デメリット**:
  - 初回ロード時にネットワーク通信が発生する（キャッシュによる緩和が必要）。
  - サブリソース整合性 (SRI) の管理が必要。

## 4. 参照 (References)

- [MIT ライセンスアーキテクチャ計画書](../implementation_plans/mit-license-architecture.md)
