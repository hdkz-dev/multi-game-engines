# ADR-045: Absolute Zenith Quality Audit の完遂と整合性同期

## 状態

Accepted (2026-02-23)

## コンテキスト

プロジェクトが「Zenith Tier」品質に到達するためには、エラーポリシー、リソース管理、および E2E テストの安定性が最高水準で一致している必要があります。これまでの開発で生じた細かな不整合や、レビューで指摘された「最奥地」の課題を解決する包括的な監査を実施しました。

## 決定事項

1. **セキュリティポリシーの統一**: `ProtocolValidator.assertNoInjection` におけるエラーコードを `SECURITY_ERROR` に統一し、"Refuse by Exception" 原則を全ドメインに適用します。
2. **リソース管理の安全性向上**:
   - `EngineLoader` のキャッシュキーセパレータを `:` に戻し、ID 衝突による誤ったリソース解放を防止します。
   - `IndexedDBStorage` に `onblocked` タイムアウト（10秒）を導入し、マルチタブ環境でのハングを防止します。
3. **E2E テストの極致的な安定化**:
   - `networkidle` への依存を排除し、具体的な UI 要素の表示を待機するアサーションに移行します。
   - 複数エンジン共存下での競合を防ぐため、パネル単位の絞り込み Locator を標準化します。
4. **型契約の厳格化**: `IEngine` と `EngineFacade` の関係性を整理し、ブリッジ内部でのライフサイクル管理を型安全に実行できる体制を整えます。

## 結末

- プロジェクト全域において、実装、テスト、およびアクセシビリティが Zenith Tier 標準で完全に同期されました。
- 非常に安定した CI パスと、堅牢な実行時安全性が確保されました。
