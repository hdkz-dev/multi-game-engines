# 意思決定記録 (Decision Log)

## [ADR-001] モノリポ構成の採用
- **決定**: npm workspaces を使用したモノリポ構成を採用。
- **理由**: Core と複数の Adapter 間での型定義の共有を容易にし、原子的な変更（Atomic Commits）を可能にするため。

## [ADR-002] 非同期ストリームに AsyncIterable を採用
- **決定**: 思考状況の配信に RxJS 等のライブラリではなく、標準の AsyncIterable を採用。
- **理由**: フレームワーク非依存を徹底し、依存関係を最小化しつつ、現代の JS で直感的な非同期処理を実現するため。

## [ADR-003] 探索キャンセルに AbortSignal を採用
- **決定**: 独自メソッドではなく `AbortSignal` を使用。
- **理由**: 他の Web API との親和性を高め、標準的なキャンセルパターンを確立するため。

## [ADR-004] メッセージの i18n 化
- **決定**: ロード進捗やエラーに構造化された `II18nMessage` を採用。
- **理由**: OSS ライブラリとして、あらゆる言語のアプリケーションで利用可能にし、開発者が自由に翻訳を適用できるようにするため。

## [ADR-005] 実行環境の機能検知 (Capability Detection)
- **決定**: `ICapabilities` を定義し、起動時に環境を診断する。
- **理由**: OPFS や WebNN などの最新 API を最大限活用しつつ、レガシーな環境でも安定して動作させるため。

## [ADR-006] 統合ロギングインターフェースの採用
- **決定**: 外部から `ILogger` を注入可能にする。
- **理由**: アプリケーション側でのデバッグや、本番環境でのエラー追跡（Sentry 等）との統合を容易にするため。
