[
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937731",
    "pull_request_review_id": 3783383998,
    "id": 2791937731,
    "node_id": "PRRC_kwDORJ0gd86maZbD",
    "diff_hunk": "@@ -1,15 +1,211 @@\n-import { IEngineAdapterMetadata } from \"@multi-game-engines/core\";\n+import {\n+  BaseAdapter,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  ILicenseInfo,\n+  IEngineSourceConfig,\n+  ISearchTask,\n+  UCIParser,\n+  WorkerCommunicator,\n+  IEngineLoader,\n+  EngineError,\n+} from \"@multi-game-engines/core\";\n \n-export const stockfishMetadata: IEngineAdapterMetadata = {\n-  id: \"stockfish\",\n-  name: \"Stockfish via WASM\",\n-  version: \"16.1\",\n-  engineLicense: {\n+/**\n+ * Stockfish (WASM) ç”¨ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å®Ÿè£…ã€‚\n+ * \n+ * EngineLoader ã‚’ä»‹ã—ã¦ CDN (jsDelivr ç­‰) ã‹ã‚‰ WASM ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å–å¾—ã—ã€\n+ * WebWorker å†…ã§å®Ÿè¡Œã€UCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§é€šä¿¡ã‚’è¡Œã„ã¾ã™ã€‚\n+ */\n+export class StockfishAdapter extends BaseAdapter<\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult\n+> {\n+  readonly id = \"stockfish\";\n+  readonly name = \"Stockfish via WASM\";\n+  readonly version = \"16.1\";\n+\n+  readonly engineLicense: ILicenseInfo = {\n     name: \"GPL-3.0-only\",\n     url: \"https://stockfishchess.org/\",\n-  },\n-  adapterLicense: {\n+  };\n+\n+  readonly adapterLicense: ILicenseInfo = {\n     name: \"MIT\",\n     url: \"https://opensource.org/licenses/MIT\",\n-  },\n-};\n+  };\n+\n+  /** ã‚¨ãƒ³ã‚¸ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šã€‚Stage 1 ã§ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ CDN ã‚’å‚ç…§ã—ã¾ã™ã€‚ */\n+  readonly sources: Record<string, IEngineSourceConfig> = {\n+    main: {\n+      url: \"https://cdn.jsdelivr.net/npm/stockfish@16.1.0/src/stockfish.js\",\n+      // å®Ÿé‹ç”¨æ™‚ã«ã¯æ­£ç¢ºãªãƒãƒƒã‚·ãƒ¥å€¤ã‚’æŒ‡å®šã—ã¦æ”¹ç«„ã‚’é˜²æ­¢ã—ã¾ã™ã€‚\n+      sri: \"\", \n+      size: 0,\n+      type: \"worker-js\",\n+    },\n+  };",
    "path": "packages/adapter-stockfish/src/stockfish.ts",
    "commit_id": "688c607f4bb833b2a31be678f6ca69782d33a9cd",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**`sri: \"\"` ã¨ `size: 0` ã¯ SRI æ¤œè¨¼ã‚’å®Œå…¨ã«ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹**\n\nStage 1 ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã¨ã—ã¦ç†è§£ã§ãã¾ã™ãŒã€ã“ã®ã¾ã¾æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã¨ãƒªã‚½ãƒ¼ã‚¹ã®æ•´åˆæ€§æ¤œè¨¼ãŒè¡Œã‚ã‚Œã¾ã›ã‚“ã€‚ãƒªãƒªãƒ¼ã‚¹å‰ã«æ­£ç¢ºãª SRI ãƒãƒƒã‚·ãƒ¥ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’è¨­å®šã™ã‚‹ TODO ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚\n\nAs per coding guidelines: ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ (SRI): å‹•çš„ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã†éš›ã¯ã€å¿…ãš SRI ãƒãƒƒã‚·ãƒ¥ã®æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã‚’çµ„ã¿è¾¼ã‚€ã“ã¨ã€\n\n\næœ¬ç•ªç”¨ã® SRI ãƒãƒƒã‚·ãƒ¥ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆã‚„ã€SRI ãŒæœªè¨­å®šã®å ´åˆã«ãƒ“ãƒ«ãƒ‰æ™‚ã«è­¦å‘Šã‚’å‡ºã™ä»•çµ„ã¿ã®å°å…¥ã‚’ãŠæ‰‹ä¼ã„ã§ãã¾ã™ã€‚Issue ã‚’ä½œæˆã—ã¾ã™ã‹ï¼Ÿ\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/adapter-stockfish/src/stockfish.ts` around lines 40 - 49, The\nsources.main entry currently has empty sri and zero size which disables SRI;\nupdate the sources: Record<string, IEngineSourceConfig> object by adding a clear\nTODO above the main entry (or inline) stating that production must set the exact\nSRI hash and file size, e.g. reference the sources constant and the main key in\nstockfish.ts (IEngineSourceConfig) and replace sri: \"\" and size: 0 with\nplaceholder values plus a TODO comment; additionally, ensure build-time\nvalidation is noted in the comment (e.g. \"TODO: generate SRI & size at build and\nfail/warn if unset\") so reviewers know to add SRI generation/validation before\nrelease.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commits 688c607 to bd47e24",
    "created_at": "2026-02-11T08:11:11Z",
    "updated_at": "2026-02-11T12:13:38Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937731",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937731"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937731"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937731/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 40,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 49,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 59,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937737",
    "pull_request_review_id": 3783383998,
    "id": 2791937737,
    "node_id": "PRRC_kwDORJ0gd86maZbJ",
    "diff_hunk": "@@ -1,15 +1,211 @@\n-import { IEngineAdapterMetadata } from \"@multi-game-engines/core\";\n+import {\n+  BaseAdapter,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  ILicenseInfo,\n+  IEngineSourceConfig,\n+  ISearchTask,\n+  UCIParser,\n+  WorkerCommunicator,\n+  IEngineLoader,\n+  EngineError,\n+} from \"@multi-game-engines/core\";\n \n-export const stockfishMetadata: IEngineAdapterMetadata = {\n-  id: \"stockfish\",\n-  name: \"Stockfish via WASM\",\n-  version: \"16.1\",\n-  engineLicense: {\n+/**\n+ * Stockfish (WASM) ç”¨ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å®Ÿè£…ã€‚\n+ * \n+ * EngineLoader ã‚’ä»‹ã—ã¦ CDN (jsDelivr ç­‰) ã‹ã‚‰ WASM ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å–å¾—ã—ã€\n+ * WebWorker å†…ã§å®Ÿè¡Œã€UCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§é€šä¿¡ã‚’è¡Œã„ã¾ã™ã€‚\n+ */\n+export class StockfishAdapter extends BaseAdapter<\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult\n+> {\n+  readonly id = \"stockfish\";\n+  readonly name = \"Stockfish via WASM\";\n+  readonly version = \"16.1\";\n+\n+  readonly engineLicense: ILicenseInfo = {\n     name: \"GPL-3.0-only\",\n     url: \"https://stockfishchess.org/\",\n-  },\n-  adapterLicense: {\n+  };\n+\n+  readonly adapterLicense: ILicenseInfo = {\n     name: \"MIT\",\n     url: \"https://opensource.org/licenses/MIT\",\n-  },\n-};\n+  };\n+\n+  /** ã‚¨ãƒ³ã‚¸ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šã€‚Stage 1 ã§ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ CDN ã‚’å‚ç…§ã—ã¾ã™ã€‚ */\n+  readonly sources: Record<string, IEngineSourceConfig> = {\n+    main: {\n+      url: \"https://cdn.jsdelivr.net/npm/stockfish@16.1.0/src/stockfish.js\",\n+      // å®Ÿé‹ç”¨æ™‚ã«ã¯æ­£ç¢ºãªãƒãƒƒã‚·ãƒ¥å€¤ã‚’æŒ‡å®šã—ã¦æ”¹ç«„ã‚’é˜²æ­¢ã—ã¾ã™ã€‚\n+      sri: \"\", \n+      size: 0,\n+      type: \"worker-js\",\n+    },\n+  };\n+\n+  readonly parser = new UCIParser();\n+  private communicator: WorkerCommunicator | null = null;\n+  private pendingResolve: ((result: IBaseSearchResult) => void) | null = null;\n+  private infoController: ReadableStreamDefaultController<IBaseSearchInfo> | null = null;\n+  private blobUrl: string | null = null;\n+  private activeLoader: IEngineLoader | null = null;\n+\n+  /**\n+   * ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€æº–å‚™å®Œäº†çŠ¶æ…‹ã«ã—ã¾ã™ã€‚\n+   */\n+  async load(loader?: IEngineLoader): Promise<void> {\n+    if (this._status === \"ready\") return;\n+\n+    const startTime = Date.now();\n+    this.emitStatusChange(\"loading\");\n+    this.activeLoader = loader || null;\n+\n+    try {\n+      let workerUrl = this.sources.main.url;\n+\n+      // ãƒ–ãƒªãƒƒã‚¸ã‹ã‚‰ãƒ­ãƒ¼ãƒ€ãƒ¼ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€SRIæ¤œè¨¼ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åˆ©ç”¨ã™ã‚‹\n+      if (loader) {\n+        this.emitProgress({ \n+          phase: \"downloading\", \n+          percentage: 10, \n+          i18n: { key: \"loading_resource\", defaultMessage: \"Loading engine resource...\" } \n+        });\n+        this.blobUrl = await loader.loadResource(this.id, this.sources.main);\n+        workerUrl = this.blobUrl;\n+      }\n+\n+      // WebWorker ã‚’èµ·å‹•ã—ã€é€šä¿¡è·¯ã‚’ç¢ºç«‹\n+      this.communicator = new WorkerCommunicator(workerUrl);\n+      await this.communicator.spawn();\n+      this.communicator.onMessage((data) => this.handleMessage(data));\n+\n+      // ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆUCIï¼‰åˆæœŸåŒ–\n+      this.communicator.postMessage(\"uci\");\n+      \n+      // 'uciok' ãŒè¿”ã‚‹ã®ã‚’å¾…ã¤ï¼ˆæœ€å¤§10ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼‰\n+      await Promise.race([\n+        this.communicator.expectMessage<string>((data) => data === \"uciok\"),\n+        new Promise((_, reject) => setTimeout(() => reject(new Error(\"UCI initialization timeout\")), 10000))\n+      ]);",
    "path": "packages/adapter-stockfish/src/stockfish.ts",
    "commit_id": "688c607f4bb833b2a31be678f6ca69782d33a9cd",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**UCI åˆæœŸåŒ–ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚ã« `expectMessage` ã® pending ãŒæ®‹ç•™ã™ã‚‹**\n\n`Promise.race` ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒå…ˆã« reject ã—ãŸå ´åˆã€`expectMessage` ã§ç™»éŒ²ã•ã‚ŒãŸ pending expectation ãŒã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã•ã‚Œãšã€`pendingExpectations` ã‚»ãƒƒãƒˆã«æ®‹ã‚Šç¶šã‘ã¾ã™ã€‚å¾Œã‹ã‚‰ `\"uciok\"` ãŒåˆ°ç€ã™ã‚‹ã¨ã€æ—¢ã« error çŠ¶æ…‹ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã«å¯¾ã—ã¦ä¸æ­£ãª resolve ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\n\n<details>\n<summary>â™»ï¸ AbortController ã‚’ä½¿ã£ãŸæ”¹å–„æ¡ˆ</summary>\n\n```diff\n+      const initController = new AbortController();\n       await Promise.race([\n         this.communicator.expectMessage<string>((data) => data === \"uciok\"),\n-        new Promise((_, reject) => setTimeout(() => reject(new Error(\"UCI initialization timeout\")), 10000))\n+        new Promise((_, reject) => {\n+          const timer = setTimeout(() => {\n+            initController.abort();\n+            reject(new Error(\"UCI initialization timeout\"));\n+          }, 10000);\n+          initController.signal.addEventListener(\"abort\", () => clearTimeout(timer));\n+        })\n       ]);\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/adapter-stockfish/src/stockfish.ts` around lines 88 - 94, The UCI\ninit Promise.race can timeout but leaves the expectMessage() registration in\npendingExpectations, so pending handlers may later resolve incorrectly; update\nthe UCI init logic to cancel/cleanup the pending expectation when timeout occurs\nâ€” e.g., create an AbortController (or accept/return a cancel token) and pass its\nsignal to expectMessage<string>((data)=>data===\"uciok\", signal) or have\nexpectMessage return a disposer and call it in the timeout branch/finally;\nensure the pendingExpectations entry is removed (or the expectation rejects)\nwhen the timeout fires so no stray resolver runs after the adapter is errored\n(refer to expectMessage, pendingExpectations, communicator.postMessage(\"uci\")\nand the UCI initialization Promise.race).\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commits 688c607 to bd47e24",
    "created_at": "2026-02-11T08:11:11Z",
    "updated_at": "2026-02-11T12:13:37Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937737",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937737"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937737"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937737/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 88,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 94,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 104,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937751",
    "pull_request_review_id": 3783383998,
    "id": 2791937751,
    "node_id": "PRRC_kwDORJ0gd86maZbX",
    "diff_hunk": "@@ -1,15 +1,211 @@\n-import { IEngineAdapterMetadata } from \"@multi-game-engines/core\";\n+import {\n+  BaseAdapter,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  ILicenseInfo,\n+  IEngineSourceConfig,\n+  ISearchTask,\n+  UCIParser,\n+  WorkerCommunicator,\n+  IEngineLoader,\n+  EngineError,\n+} from \"@multi-game-engines/core\";\n \n-export const stockfishMetadata: IEngineAdapterMetadata = {\n-  id: \"stockfish\",\n-  name: \"Stockfish via WASM\",\n-  version: \"16.1\",\n-  engineLicense: {\n+/**\n+ * Stockfish (WASM) ç”¨ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å®Ÿè£…ã€‚\n+ * \n+ * EngineLoader ã‚’ä»‹ã—ã¦ CDN (jsDelivr ç­‰) ã‹ã‚‰ WASM ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å–å¾—ã—ã€\n+ * WebWorker å†…ã§å®Ÿè¡Œã€UCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§é€šä¿¡ã‚’è¡Œã„ã¾ã™ã€‚\n+ */\n+export class StockfishAdapter extends BaseAdapter<\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult\n+> {\n+  readonly id = \"stockfish\";\n+  readonly name = \"Stockfish via WASM\";\n+  readonly version = \"16.1\";\n+\n+  readonly engineLicense: ILicenseInfo = {\n     name: \"GPL-3.0-only\",\n     url: \"https://stockfishchess.org/\",\n-  },\n-  adapterLicense: {\n+  };\n+\n+  readonly adapterLicense: ILicenseInfo = {\n     name: \"MIT\",\n     url: \"https://opensource.org/licenses/MIT\",\n-  },\n-};\n+  };\n+\n+  /** ã‚¨ãƒ³ã‚¸ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šã€‚Stage 1 ã§ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ CDN ã‚’å‚ç…§ã—ã¾ã™ã€‚ */\n+  readonly sources: Record<string, IEngineSourceConfig> = {\n+    main: {\n+      url: \"https://cdn.jsdelivr.net/npm/stockfish@16.1.0/src/stockfish.js\",\n+      // å®Ÿé‹ç”¨æ™‚ã«ã¯æ­£ç¢ºãªãƒãƒƒã‚·ãƒ¥å€¤ã‚’æŒ‡å®šã—ã¦æ”¹ç«„ã‚’é˜²æ­¢ã—ã¾ã™ã€‚\n+      sri: \"\", \n+      size: 0,\n+      type: \"worker-js\",\n+    },\n+  };\n+\n+  readonly parser = new UCIParser();\n+  private communicator: WorkerCommunicator | null = null;\n+  private pendingResolve: ((result: IBaseSearchResult) => void) | null = null;\n+  private infoController: ReadableStreamDefaultController<IBaseSearchInfo> | null = null;\n+  private blobUrl: string | null = null;\n+  private activeLoader: IEngineLoader | null = null;\n+\n+  /**\n+   * ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€æº–å‚™å®Œäº†çŠ¶æ…‹ã«ã—ã¾ã™ã€‚\n+   */\n+  async load(loader?: IEngineLoader): Promise<void> {\n+    if (this._status === \"ready\") return;\n+\n+    const startTime = Date.now();\n+    this.emitStatusChange(\"loading\");\n+    this.activeLoader = loader || null;\n+\n+    try {\n+      let workerUrl = this.sources.main.url;\n+\n+      // ãƒ–ãƒªãƒƒã‚¸ã‹ã‚‰ãƒ­ãƒ¼ãƒ€ãƒ¼ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€SRIæ¤œè¨¼ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åˆ©ç”¨ã™ã‚‹\n+      if (loader) {\n+        this.emitProgress({ \n+          phase: \"downloading\", \n+          percentage: 10, \n+          i18n: { key: \"loading_resource\", defaultMessage: \"Loading engine resource...\" } \n+        });\n+        this.blobUrl = await loader.loadResource(this.id, this.sources.main);\n+        workerUrl = this.blobUrl;\n+      }\n+\n+      // WebWorker ã‚’èµ·å‹•ã—ã€é€šä¿¡è·¯ã‚’ç¢ºç«‹\n+      this.communicator = new WorkerCommunicator(workerUrl);\n+      await this.communicator.spawn();\n+      this.communicator.onMessage((data) => this.handleMessage(data));\n+\n+      // ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆUCIï¼‰åˆæœŸåŒ–\n+      this.communicator.postMessage(\"uci\");\n+      \n+      // 'uciok' ãŒè¿”ã‚‹ã®ã‚’å¾…ã¤ï¼ˆæœ€å¤§10ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼‰\n+      await Promise.race([\n+        this.communicator.expectMessage<string>((data) => data === \"uciok\"),\n+        new Promise((_, reject) => setTimeout(() => reject(new Error(\"UCI initialization timeout\")), 10000))\n+      ]);\n+\n+      this.emitStatusChange(\"ready\");\n+      this.emitProgress({ \n+        phase: \"ready\", \n+        percentage: 100, \n+        i18n: { key: \"ready\", defaultMessage: \"Ready\" } \n+      });\n+      \n+      // çµ±è¨ˆæƒ…å ±ã®åé›†\n+      this.emitTelemetry({\n+        event: \"load_complete\",\n+        timestamp: Date.now(),\n+        attributes: { load_time_ms: Date.now() - startTime, cached: !!this.blobUrl }\n+      });\n+    } catch (error) {\n+      this.emitStatusChange(\"error\");\n+      \n+      // é€”ä¸­ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸå ´åˆã€Blob URL ãŒãƒªãƒ¼ã‚¯ã—ãªã„ã‚ˆã†ã«ç¢ºå®Ÿã«è§£æ”¾ã™ã‚‹\n+      if (this.blobUrl && loader) {\n+        loader.revoke(this.blobUrl);\n+        this.blobUrl = null;\n+      }\n+\n+      throw EngineError.from(error, this.id);\n+    }\n+  }\n+\n+  /**\n+   * æœªåŠ å·¥ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ¢ç´¢ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\n+   */\n+  searchRaw(command: string | Uint8Array): ISearchTask<IBaseSearchInfo, IBaseSearchResult> {\n+    if (this._status !== \"ready\") {\n+      throw new Error(\"Engine is not ready. Call load() first.\");\n+    }\n+\n+    this.emitStatusChange(\"busy\");\n+\n+    // çµæœè¿”å´ç”¨ã® Promise\n+    const resultPromise = new Promise<IBaseSearchResult>((resolve) => {\n+      this.pendingResolve = resolve;\n+    });\n+\n+    // æ€è€ƒçŠ¶æ³ï¼ˆinfoï¼‰ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ç”¨ã® ReadableStream\n+    const infoStream = new ReadableStream<IBaseSearchInfo>({\n+      start: (controller) => {\n+        this.infoController = controller;\n+      },\n+    });\n+\n+    // AsyncIterable ã¨ã—ã¦å…¬é–‹\n+    const infoAsyncIterable: AsyncIterable<IBaseSearchInfo> = {\n+      [Symbol.asyncIterator]: () => {\n+        const reader = infoStream.getReader();\n+        return {\n+          async next(): Promise<IteratorResult<IBaseSearchInfo>> {\n+            const { done, value } = await reader.read();\n+            if (done) return { done: true, value: undefined };\n+            return { done: false, value: value! };\n+          },\n+        };\n+      },\n+    };\n+\n+    // ã‚¨ãƒ³ã‚¸ãƒ³ã«æ¢ç´¢ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡\n+    this.communicator?.postMessage(command);\n+\n+    return {\n+      info: infoAsyncIterable,\n+      result: resultPromise,\n+      stop: async () => {\n+        // æ¢ç´¢åœæ­¢ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡\n+        this.communicator?.postMessage(this.parser.createStopCommand());\n+      },\n+    };\n+  }",
    "path": "packages/adapter-stockfish/src/stockfish.ts",
    "commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸ”´ Critical_\n\n**`searchRaw` ã® `resultPromise` ã« reject ãƒ‘ã‚¹ãŒå­˜åœ¨ã—ãªã„**\n\n`resultPromise` ã¯ `new Promise<IBaseSearchResult>((resolve) => { ... })` ã§ç”Ÿæˆã•ã‚Œã¦ãŠã‚Šã€reject é–¢æ•°ãŒä¿æŒã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚Worker ãŒã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã—ãŸå ´åˆã‚„ `terminate()` ã•ã‚ŒãŸå ´åˆã€ã“ã® Promise ã¯æ°¸ä¹…ã«è§£æ±ºã•ã‚Œãšã€å‘¼ã³å‡ºã—å…ƒãŒãƒãƒ³ã‚°ã—ã¾ã™ã€‚\n\nã¾ãŸã€`searchRaw` ã‚’é€£ç¶šã§å‘¼ã³å‡ºã™ã¨ `this.pendingResolve` ãŒä¸Šæ›¸ãã•ã‚Œã€å‰å›ã® `resultPromise` ãŒæ°¸ä¹…ã«æœªè§£æ±ºã®ã¾ã¾æ®‹ã‚Šã¾ã™ã€‚\n\n<details>\n<summary>ğŸ› reject ãƒ‘ã‚¹ã‚’è¿½åŠ ã—ã€ç«¶åˆã‚’é˜²ãä¿®æ­£æ¡ˆ</summary>\n\n```diff\n   searchRaw(command: string | Uint8Array): ISearchTask<IBaseSearchInfo, IBaseSearchResult> {\n     if (this._status !== \"ready\") {\n-      throw new Error(\"Engine is not ready. Call load() first.\");\n+      throw new EngineError(\n+        EngineErrorCode.INTERNAL_ERROR,\n+        \"Engine is not ready. Call load() first.\",\n+        this.id\n+      );\n+    }\n+\n+    // å‰å›ã®æ¢ç´¢ãŒæ®‹ã£ã¦ã„ã‚‹å ´åˆã¯å®Œäº†ã•ã›ã‚‹\n+    if (this.pendingResolve) {\n+      this.infoController?.close();\n+      this.infoController = null;\n+      this.pendingResolve = null;\n     }\n\n     this.emitStatusChange(\"busy\");\n\n     // çµæœè¿”å´ç”¨ã® Promise\n-    const resultPromise = new Promise<IBaseSearchResult>((resolve) => {\n+    const resultPromise = new Promise<IBaseSearchResult>((resolve, reject) => {\n       this.pendingResolve = resolve;\n+      this.pendingReject = reject;\n     });\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/adapter-stockfish/src/stockfish.ts` around lines 125 - 169,\nsearchRaw currently creates resultPromise without a reject path and overwrites\nthis.pendingResolve on each call, causing orphaned promises; change searchRaw to\ncreate Promise<IBaseSearchResult>((resolve, reject) => { ... }) and store both\nthis.pendingResolve and this.pendingReject (unique symbols to locate: searchRaw,\nthis.pendingResolve) then when starting a new search, if a previous\nthis.pendingReject exists call it with an appropriate error before overwriting\nto avoid leaks; ensure any worker error/terminate handlers call\nthis.pendingReject and clear both pendingResolve/pendingReject after resolve or\nreject so no promises remain unresolved.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commits 688c607 to bd47e24",
    "created_at": "2026-02-11T08:11:11Z",
    "updated_at": "2026-02-11T12:13:41Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937751",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937751"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937751"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937751/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 125,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 169,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 179,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937755",
    "pull_request_review_id": 3783383998,
    "id": 2791937755,
    "node_id": "PRRC_kwDORJ0gd86maZbb",
    "diff_hunk": "@@ -0,0 +1,95 @@\n+import { describe, it, expect, vi } from \"vitest\";\n+import { EngineBridge } from \"../bridge/EngineBridge\";\n+import { BaseAdapter } from \"../adapters/BaseAdapter\";\n+import { ISearchTask, IBaseSearchInfo, IBaseSearchResult, IMiddleware, FEN, Move } from \"../types\";\n+import { UCIParser } from \"../protocols/UCIParser\";\n+\n+/**\n+ * å¾¹åº•çš„ã«å‹å®šç¾©ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆç”¨ãƒ¢ãƒƒã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã€‚\n+ * UCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æ¨¡æ“¬ã—ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡ºåŠ›ã‚’æ¤œè¨¼å¯èƒ½ã«ã—ã¾ã™ã€‚\n+ */\n+// eslint-disable-next-line @typescript-eslint/no-explicit-any\n+class MockAdapter extends BaseAdapter<any, IBaseSearchInfo, IBaseSearchResult> {",
    "path": "packages/core/src/__tests__/EngineBridge.test.ts",
    "commit_id": "937185b2e7999f41028c8428c8c1a36ee882683d",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_ğŸ› ï¸ Refactor suggestion_ | _ğŸŸ  Major_\n\n**`any` ã®ä½¿ç”¨ã¯ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«é•åã—ã¦ã„ã¾ã™ã€‚**\n\n`BaseAdapter<any, ...>` ã® `any` ã‚’ `unknown` ã¾ãŸã¯ `IBaseSearchOptions` ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã§ã‚ã£ã¦ã‚‚ã€ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã¯ `any` ã®ä½¿ç”¨ã‚’ç¦æ­¢ã—ã¦ã„ã¾ã™ã€‚\n\n<details>\n<summary>â™»ï¸ ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n-// eslint-disable-next-line `@typescript-eslint/no-explicit-any`\n-class MockAdapter extends BaseAdapter<any, IBaseSearchInfo, IBaseSearchResult> {\n+class MockAdapter extends BaseAdapter<IBaseSearchOptions, IBaseSearchInfo, IBaseSearchResult> {\n```\n\n`IBaseSearchOptions` ã‚’ `../types` ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãã ã•ã„ã€‚\n</details>\n\nAs per coding guidelines: `ç¦æ­¢: any ã®ä½¿ç”¨ã€‚ä»£ã‚ã‚Šã« unknown ã¨å‹ã‚¬ãƒ¼ãƒ‰ã€ã¾ãŸã¯å¢ƒç•Œä»˜ãã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨`\n\n<!-- suggestion_start -->\n\n<details>\n<summary>ğŸ“ Committable suggestion</summary>\n\n> â€¼ï¸ **IMPORTANT**\n> Carefully review the code before committing. Ensure that it accurately replaces the highlighted code, contains no missing lines, and has no issues with indentation. Thoroughly test & benchmark the code to ensure it meets the requirements.\n\n```suggestion\nclass MockAdapter extends BaseAdapter<IBaseSearchOptions, IBaseSearchInfo, IBaseSearchResult> {\n```\n\n</details>\n\n<!-- suggestion_end -->\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/__tests__/EngineBridge.test.ts` around lines 11 - 12,\nReplace the forbidden use of `any` in the test adapter declaration: change the\ngeneric on `BaseAdapter` in `class MockAdapter extends BaseAdapter<any,\nIBaseSearchInfo, IBaseSearchResult>` to a safe type (either `unknown` with\nguards or the bounded generic `IBaseSearchOptions`) and import\n`IBaseSearchOptions` from `../types`; update the class signature to use\n`IBaseSearchOptions` (or `unknown`) and ensure any places that relied on `any`\nare adjusted to satisfy the stricter type (add minimal type guards or casts in\nthe test if necessary).\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T08:11:11Z",
    "updated_at": "2026-02-11T08:11:15Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937755",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937755"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937755"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937755/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 11,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 12,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 12,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937768",
    "pull_request_review_id": 3783383998,
    "id": 2791937768,
    "node_id": "PRRC_kwDORJ0gd86maZbo",
    "diff_hunk": "@@ -0,0 +1,45 @@\n+import { describe, it, expect } from \"vitest\";\n+import { UCIParser } from \"../protocols/UCIParser\";\n+\n+describe(\"UCIParser\", () => {\n+  const parser = new UCIParser();\n+\n+  it(\"should parse info lines correctly\", () => {\n+    const line = \"info depth 10 score cp 50 nps 100000 time 500 pv e2e4 e7e5\";\n+    const info = parser.parseInfo(line);\n+    \n+    expect(info).toBeDefined();\n+    expect(info?.depth).toBe(10);\n+    expect(info?.score).toBe(50);\n+    expect(info?.nps).toBe(100000);\n+    expect(info?.time).toBe(500);\n+    expect(info?.pv).toEqual([\"e2e4\", \"e7e5\"]);\n+  });\n+\n+  it(\"should parse mate scores correctly\", () => {\n+    const line = \"info depth 5 score mate 3\";\n+    const info = parser.parseInfo(line);\n+    expect(info?.score).toBe(30000);\n+  });\n+\n+  it(\"should parse bestmove lines correctly\", () => {\n+    const line = \"bestmove e2e4 ponder e7e5\";\n+    const result = parser.parseResult(line);\n+    \n+    expect(result).toBeDefined();\n+    expect(result?.bestMove).toBe(\"e2e4\");\n+    expect(result?.ponder).toBe(\"e7e5\");\n+  });\n+\n+  it(\"should create correct search commands\", () => {\n+    const options = {\n+      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+      fen: \"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1\" as any,\n+      depth: 15,",
    "path": "packages/core/src/__tests__/UCIParser.test.ts",
    "commit_id": "e28e30870e3789aef2fd8506df14b78240f2a430",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_ğŸ› ï¸ Refactor suggestion_ | _ğŸŸ  Major_\n\n**`as any` ã®ä»£ã‚ã‚Šã«ãƒ–ãƒ©ãƒ³ãƒ‰å‹ `FEN` ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„**\n\nã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ `any` ã®ä½¿ç”¨ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã§ã‚‚ `FEN` ãƒ–ãƒ©ãƒ³ãƒ‰å‹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€å‹ã®ä¸€è²«æ€§ãŒä¿ãŸã‚Œã¾ã™ã€‚\n\n<details>\n<summary>â™»ï¸ ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n+import { FEN } from \"../types\";\n // ...\n const options = {\n-  // eslint-disable-next-line `@typescript-eslint/no-explicit-any`\n-  fen: \"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1\" as any,\n+  fen: \"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1\" as FEN,\n   depth: 15,\n   time: 1000,\n };\n```\n</details>\n\nAs per coding guidelines: \"ç¦æ­¢: `any` ã®ä½¿ç”¨ã€‚ä»£ã‚ã‚Šã« `unknown` ã¨å‹ã‚¬ãƒ¼ãƒ‰ã€ã¾ãŸã¯å¢ƒç•Œä»˜ãã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨\" ãŠã‚ˆã³ \"Branded Types ã®å¾¹åº•: `FEN`, `Move` ç­‰ã®ãƒ‰ãƒ¡ã‚¤ãƒ³å›ºæœ‰å‹ã‚’ `string` ã¨æ··ç”¨ã—ãªã„ã“ã¨\"\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/__tests__/UCIParser.test.ts` around lines 36 - 38, Replace\nthe prohibited \"as any\" on the fen property with the branded FEN type: import\nthe FEN brand type and change the test value to be typed as FEN (e.g., assign\nthe string to a variable typed FEN or cast to FEN) so the fen field uses the\ndomain-specific brand instead of any; update the test's fen usage accordingly\n(refer to the fen property and the FEN brand type).\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commit 7b7f348",
    "created_at": "2026-02-11T08:11:11Z",
    "updated_at": "2026-02-11T08:23:10Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937768",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937768"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937768"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937768/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 36,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 38,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 38,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937774",
    "pull_request_review_id": 3783383998,
    "id": 2791937774,
    "node_id": "PRRC_kwDORJ0gd86maZbu",
    "diff_hunk": "@@ -0,0 +1,158 @@\n+import {\n+  IEngineBridge,\n+  IEngineAdapter,\n+  IEngine,\n+  IMiddleware,\n+  ICapabilities,\n+  ISecurityStatus,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  MiddlewarePriority,\n+  EngineStatus,\n+  ILoadProgress,\n+  ITelemetryEvent,\n+  EngineErrorCode,\n+  IEngineLoader,\n+} from \"../types\";\n+import { EngineFacade } from \"./EngineFacade\";\n+import { CapabilityDetector } from \"../capabilities/CapabilityDetector\";\n+import { SecurityAdvisor } from \"../capabilities/SecurityAdvisor\";\n+import { EngineLoader } from \"./EngineLoader\";\n+import { createFileStorage } from \"../storage\";\n+import { EngineError } from \"../errors/EngineError\";\n+\n+/**\n+ * è¤‡æ•°ã®ã‚¨ãƒ³ã‚¸ãƒ³ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’é›†ä¸­ç®¡ç†ã™ã‚‹ãƒ–ãƒªãƒƒã‚¸ã‚¯ãƒ©ã‚¹ã€‚\n+ * \n+ * å½¹å‰²:\n+ * 1. å„ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ï¼ˆStockfish, ã‚„ã­ã†ã‚‰ç‹ç­‰ï¼‰ã®ç™»éŒ²ã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†\n+ * 2. ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒã‚§ãƒ¼ãƒ³ï¼ˆå…¥å‡ºåŠ›ã®åŠ å·¥ï¼‰ã®çµ±åˆ\n+ * 3. ã‚¨ãƒ³ã‚¸ãƒ³ã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªï¼‰ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é›†ç´„ï¼ˆãƒãƒ–ãƒªãƒ³ã‚°ï¼‰\n+ * 4. å®Ÿè¡Œç’°å¢ƒã®èƒ½åŠ›è¨ºæ–­ã¨ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã®æä¾›\n+ */\n+export class EngineBridge implements IEngineBridge {\n+  /**\n+   * ç™»éŒ²ã•ã‚ŒãŸã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ãƒãƒƒãƒ—ã€‚\n+   * ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼ˆOptions/Info/Resultï¼‰ãŒã‚¨ãƒ³ã‚¸ãƒ³ã”ã¨ã«ç•°ãªã‚‹ãŸã‚ã€\n+   * å†…éƒ¨ç®¡ç†ç”¨ã¨ã—ã¦æ„å›³çš„ã« any ã‚’è¨±å®¹ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ä¿æŒã—ã¾ã™ã€‚\n+   */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private adapters = new Map<string, IEngineAdapter<any, any, any>>();\n+  \n+  /** \n+   * ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«é©ç”¨ã•ã‚Œã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ãƒªã‚¹ãƒˆã€‚\n+   * é€šä¿¡ãƒ‡ãƒ¼ã‚¿å‹ãŒå¤šå²ã«ã‚ãŸã‚‹ãŸã‚ã€å†…éƒ¨çš„ã«ã¯ any ã‚’è¨±å®¹ã—ã¾ã™ã€‚\n+   */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private middlewares: IMiddleware<any, any>[] = [];\n+  \n+  /** éåŒæœŸã§åˆæœŸåŒ–ã•ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã® Promise */\n+  private loaderPromise: Promise<EngineLoader> | null = null;\n+\n+  // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ã‚»ãƒƒãƒˆ\n+  private statusListeners = new Set<(id: string, status: EngineStatus) => void>();\n+  private progressListeners = new Set<(id: string, progress: ILoadProgress) => void>();\n+  private telemetryListeners = new Set<(id: string, event: ITelemetryEvent) => void>();\n+\n+  /**\n+   * ç’°å¢ƒã«é©ã—ãŸ EngineLoader ã‚’éåŒæœŸã§å–å¾—ã—ã¾ã™ã€‚\n+   * åˆå›å‘¼ã³å‡ºã—æ™‚ã« CapabilityDetector ã¨ FileStorage ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚\n+   */\n+  async getLoader(): Promise<IEngineLoader> {\n+    if (!this.loaderPromise) {\n+      this.loaderPromise = (async () => {\n+        const caps = await this.checkCapabilities();\n+        const storage = createFileStorage(caps);\n+        return new EngineLoader(storage);\n+      })();\n+    }\n+    return this.loaderPromise;\n+  }\n+\n+  /**\n+   * ã‚¨ãƒ³ã‚¸ãƒ³ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’ãƒ–ãƒªãƒƒã‚¸ã«ç™»éŒ²ã—ã¾ã™ã€‚\n+   * ç™»éŒ²æ™‚ã«ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ–ãƒªãƒƒã‚¸ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªã‚¹ãƒŠãƒ¼ã¸è»¢é€ã™ã‚‹è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚\n+   */\n+  registerAdapter<\n+    T_OPTIONS extends IBaseSearchOptions,\n+    T_INFO extends IBaseSearchInfo,\n+    T_RESULT extends IBaseSearchResult,\n+  >(adapter: IEngineAdapter<T_OPTIONS, T_INFO, T_RESULT>): void {\n+    if (this.adapters.has(adapter.id)) {\n+      console.warn(`Adapter with ID \"${adapter.id}\" is already registered. Overwriting.`);\n+    }\n+\n+    // ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å€‹åˆ¥ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ä¼æ’­ï¼ˆãƒãƒ–ãƒªãƒ³ã‚°ï¼‰ã•ã›ã‚‹\n+    adapter.onStatusChange((status) => {\n+      this.statusListeners.forEach(cb => cb(adapter.id, status));\n+    });\n+    adapter.onProgress((progress) => {\n+      this.progressListeners.forEach(cb => cb(adapter.id, progress));\n+    });\n+    adapter.onTelemetry?.((event) => {\n+      this.telemetryListeners.forEach(cb => cb(adapter.id, event));\n+    });\n+\n+    this.adapters.set(adapter.id, adapter);\n+  }",
    "path": "packages/core/src/bridge/EngineBridge.ts",
    "commit_id": "688c607f4bb833b2a31be678f6ca69782d33a9cd",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å†ç™»éŒ²æ™‚ã«ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­ãŒãƒªãƒ¼ã‚¯ã™ã‚‹**\n\n`registerAdapter()` ã¯æ¯å› `adapter.onStatusChange()`, `adapter.onProgress()`, `adapter.onTelemetry()` ã‚’å‘¼ã³å‡ºã—ã¾ã™ãŒã€è¿”å´ã•ã‚Œã‚‹ unsubscribe é–¢æ•°ã‚’ä¿æŒã—ã¦ã„ã¾ã›ã‚“ã€‚åŒã˜ ID ã§å†ç™»éŒ²ã—ãŸå ´åˆã€æ—§ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®è³¼èª­ãŒã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªã‚¹ãƒŠãƒ¼ã¸ã®ä¼æ’­ã‚’ç¶šã‘ã€ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã¨é‡è¤‡ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«ã®åŸå› ã«ãªã‚Šã¾ã™ã€‚\n\n<details>\n<summary>ğŸ› unsubscribe é–¢æ•°ã‚’ä¿æŒã—ã€å†ç™»éŒ²æ™‚ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹ææ¡ˆ</summary>\n\n```diff\n+  private adapterUnsubscribers = new Map<string, (() => void)[]>();\n+\n   registerAdapter<\n     T_OPTIONS extends IBaseSearchOptions,\n     T_INFO extends IBaseSearchInfo,\n     T_RESULT extends IBaseSearchResult,\n   >(adapter: IEngineAdapter<T_OPTIONS, T_INFO, T_RESULT>): void {\n     if (this.adapters.has(adapter.id)) {\n       console.warn(`Adapter with ID \"${adapter.id}\" is already registered. Overwriting.`);\n+      // æ—§ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®è³¼èª­ã‚’è§£é™¤\n+      this.adapterUnsubscribers.get(adapter.id)?.forEach(unsub => unsub());\n     }\n \n-    adapter.onStatusChange((status) => {\n+    const unsubs: (() => void)[] = [];\n+    unsubs.push(adapter.onStatusChange((status) => {\n       this.statusListeners.forEach(cb => cb(adapter.id, status));\n-    });\n-    adapter.onProgress((progress) => {\n+    }));\n+    unsubs.push(adapter.onProgress((progress) => {\n       this.progressListeners.forEach(cb => cb(adapter.id, progress));\n-    });\n+    }));\n     adapter.onTelemetry?.((event) => {\n       this.telemetryListeners.forEach(cb => cb(adapter.id, event));\n     });\n+    this.adapterUnsubscribers.set(adapter.id, unsubs);\n \n     this.adapters.set(adapter.id, adapter);\n   }\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/bridge/EngineBridge.ts` around lines 82 - 98, The\nregisterAdapter logic currently calls adapter.onStatusChange, adapter.onProgress\nand adapter.onTelemetry without retaining unsubscribe callbacks, causing leaks\nand duplicate events when an adapter with the same id is re-registered; modify\nregisterAdapter to store the unsubscribe functions (e.g., in a new Map keyed by\nadapter.id) for each subscription returned by\nonStatusChange/onProgress/onTelemetry (handle optional onTelemetry with ?.), and\nwhen an adapter with that id already exists call and clear those stored\nunsubscribers before attaching new listeners (also ensure unsubscribers are\ncalled when removing adapters); update references to adapters, statusListeners,\nprogressListeners and telemetryListeners accordingly.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commits 688c607 to bd47e24",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T12:13:47Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937774",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937774"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937774"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937774/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 82,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 98,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 98,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937780",
    "pull_request_review_id": 3783383998,
    "id": 2791937780,
    "node_id": "PRRC_kwDORJ0gd86maZb0",
    "diff_hunk": "@@ -0,0 +1,158 @@\n+import {\n+  IEngineBridge,\n+  IEngineAdapter,\n+  IEngine,\n+  IMiddleware,\n+  ICapabilities,\n+  ISecurityStatus,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  MiddlewarePriority,\n+  EngineStatus,\n+  ILoadProgress,\n+  ITelemetryEvent,\n+  EngineErrorCode,\n+  IEngineLoader,\n+} from \"../types\";\n+import { EngineFacade } from \"./EngineFacade\";\n+import { CapabilityDetector } from \"../capabilities/CapabilityDetector\";\n+import { SecurityAdvisor } from \"../capabilities/SecurityAdvisor\";\n+import { EngineLoader } from \"./EngineLoader\";\n+import { createFileStorage } from \"../storage\";\n+import { EngineError } from \"../errors/EngineError\";\n+\n+/**\n+ * è¤‡æ•°ã®ã‚¨ãƒ³ã‚¸ãƒ³ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’é›†ä¸­ç®¡ç†ã™ã‚‹ãƒ–ãƒªãƒƒã‚¸ã‚¯ãƒ©ã‚¹ã€‚\n+ * \n+ * å½¹å‰²:\n+ * 1. å„ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ï¼ˆStockfish, ã‚„ã­ã†ã‚‰ç‹ç­‰ï¼‰ã®ç™»éŒ²ã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†\n+ * 2. ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒã‚§ãƒ¼ãƒ³ï¼ˆå…¥å‡ºåŠ›ã®åŠ å·¥ï¼‰ã®çµ±åˆ\n+ * 3. ã‚¨ãƒ³ã‚¸ãƒ³ã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªï¼‰ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é›†ç´„ï¼ˆãƒãƒ–ãƒªãƒ³ã‚°ï¼‰\n+ * 4. å®Ÿè¡Œç’°å¢ƒã®èƒ½åŠ›è¨ºæ–­ã¨ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã®æä¾›\n+ */\n+export class EngineBridge implements IEngineBridge {\n+  /**\n+   * ç™»éŒ²ã•ã‚ŒãŸã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ãƒãƒƒãƒ—ã€‚\n+   * ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼ˆOptions/Info/Resultï¼‰ãŒã‚¨ãƒ³ã‚¸ãƒ³ã”ã¨ã«ç•°ãªã‚‹ãŸã‚ã€\n+   * å†…éƒ¨ç®¡ç†ç”¨ã¨ã—ã¦æ„å›³çš„ã« any ã‚’è¨±å®¹ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ä¿æŒã—ã¾ã™ã€‚\n+   */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private adapters = new Map<string, IEngineAdapter<any, any, any>>();\n+  \n+  /** \n+   * ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«é©ç”¨ã•ã‚Œã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ãƒªã‚¹ãƒˆã€‚\n+   * é€šä¿¡ãƒ‡ãƒ¼ã‚¿å‹ãŒå¤šå²ã«ã‚ãŸã‚‹ãŸã‚ã€å†…éƒ¨çš„ã«ã¯ any ã‚’è¨±å®¹ã—ã¾ã™ã€‚\n+   */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private middlewares: IMiddleware<any, any>[] = [];\n+  \n+  /** éåŒæœŸã§åˆæœŸåŒ–ã•ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã® Promise */\n+  private loaderPromise: Promise<EngineLoader> | null = null;\n+\n+  // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ã‚»ãƒƒãƒˆ\n+  private statusListeners = new Set<(id: string, status: EngineStatus) => void>();\n+  private progressListeners = new Set<(id: string, progress: ILoadProgress) => void>();\n+  private telemetryListeners = new Set<(id: string, event: ITelemetryEvent) => void>();\n+\n+  /**\n+   * ç’°å¢ƒã«é©ã—ãŸ EngineLoader ã‚’éåŒæœŸã§å–å¾—ã—ã¾ã™ã€‚\n+   * åˆå›å‘¼ã³å‡ºã—æ™‚ã« CapabilityDetector ã¨ FileStorage ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚\n+   */\n+  async getLoader(): Promise<IEngineLoader> {\n+    if (!this.loaderPromise) {\n+      this.loaderPromise = (async () => {\n+        const caps = await this.checkCapabilities();\n+        const storage = createFileStorage(caps);\n+        return new EngineLoader(storage);\n+      })();\n+    }\n+    return this.loaderPromise;\n+  }\n+\n+  /**\n+   * ã‚¨ãƒ³ã‚¸ãƒ³ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’ãƒ–ãƒªãƒƒã‚¸ã«ç™»éŒ²ã—ã¾ã™ã€‚\n+   * ç™»éŒ²æ™‚ã«ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ–ãƒªãƒƒã‚¸ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªã‚¹ãƒŠãƒ¼ã¸è»¢é€ã™ã‚‹è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚\n+   */\n+  registerAdapter<\n+    T_OPTIONS extends IBaseSearchOptions,\n+    T_INFO extends IBaseSearchInfo,\n+    T_RESULT extends IBaseSearchResult,\n+  >(adapter: IEngineAdapter<T_OPTIONS, T_INFO, T_RESULT>): void {\n+    if (this.adapters.has(adapter.id)) {\n+      console.warn(`Adapter with ID \"${adapter.id}\" is already registered. Overwriting.`);\n+    }\n+\n+    // ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å€‹åˆ¥ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ä¼æ’­ï¼ˆãƒãƒ–ãƒªãƒ³ã‚°ï¼‰ã•ã›ã‚‹\n+    adapter.onStatusChange((status) => {\n+      this.statusListeners.forEach(cb => cb(adapter.id, status));\n+    });\n+    adapter.onProgress((progress) => {\n+      this.progressListeners.forEach(cb => cb(adapter.id, progress));\n+    });\n+    adapter.onTelemetry?.((event) => {\n+      this.telemetryListeners.forEach(cb => cb(adapter.id, event));\n+    });\n+\n+    this.adapters.set(adapter.id, adapter);\n+  }\n+\n+  /**\n+   * æŒ‡å®šã•ã‚ŒãŸã‚¨ãƒ³ã‚¸ãƒ³IDã«å¯¾å¿œã™ã‚‹åˆ©ç”¨è€…å‘ã‘ Facade ã‚’å–å¾—ã—ã¾ã™ã€‚\n+   * \n+   * @throws {EngineError} ã‚¨ãƒ³ã‚¸ãƒ³ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã«ç™ºç”Ÿ\n+   */\n+  getEngine<\n+    T_OPTIONS extends IBaseSearchOptions = IBaseSearchOptions,\n+    T_INFO extends IBaseSearchInfo = IBaseSearchInfo,\n+    T_RESULT extends IBaseSearchResult = IBaseSearchResult,\n+  >(id: string): IEngine<T_OPTIONS, T_INFO, T_RESULT> {\n+    const adapter = this.adapters.get(id);\n+    if (!adapter) {\n+      throw new EngineError(EngineErrorCode.INTERNAL_ERROR, `Engine \"${id}\" not found.`);\n+    }\n+\n+    // å„ªå…ˆåº¦ãŒé«˜ã„é †ã«ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ã‚½ãƒ¼ãƒˆ\n+    const sortedMiddlewares = [...this.middlewares].sort(\n+      (a, b) => (b.priority ?? MiddlewarePriority.NORMAL) - (a.priority ?? MiddlewarePriority.NORMAL)\n+    );\n+\n+    // åˆ©ç”¨è€…ã¯ã“ã® Facade ã‚’é€šã˜ã¦ã‚¨ãƒ³ã‚¸ãƒ³ã‚’æ“ä½œã™ã‚‹ï¼ˆã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®å®Ÿè£…è©³ç´°ã¯éš è”½ã•ã‚Œã‚‹ï¼‰\n+    return new EngineFacade<T_OPTIONS, T_INFO, T_RESULT>(adapter, sortedMiddlewares, this);\n+  }",
    "path": "packages/core/src/bridge/EngineBridge.ts",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**`getEngine()` ãŒå‘¼ã³å‡ºã—ã”ã¨ã«æ–°ã—ã„ `EngineFacade` ã‚’ç”Ÿæˆã™ã‚‹**\n\nåŒã˜ ID ã«å¯¾ã—ã¦ `getEngine()` ã‚’è¤‡æ•°å›å‘¼ã¶ã¨ã€ç‹¬ç«‹ã—ãŸ `activeTask` çŠ¶æ…‹ã‚’æŒã¤åˆ¥ã€…ã® Facade ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒè¿”ã•ã‚Œã¾ã™ã€‚ä¸€æ–¹ã® Facade ã§é–‹å§‹ã—ãŸæ¢ç´¢ãŒã€ä»–æ–¹ã® Facade ã‹ã‚‰ã¯èªè­˜ã•ã‚Œãšã€æ’ä»–åˆ¶å¾¡ï¼ˆauto-abortï¼‰ãŒæ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚\n\nã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã‹ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã€Œå‘¼ã³å‡ºã—ã”ã¨ã«æ–°è¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒè¿”ã‚‹ã€æ—¨ã‚’æ˜è¨˜ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/bridge/EngineBridge.ts` around lines 105 - 122, getEngine\ncurrently constructs a new EngineFacade on each call so multiple calls for the\nsame id produce independent facades (separate activeTask state) which breaks\ncross-facade coordination (auto-abort). Fix by caching EngineFacade instances\ninside EngineBridge: add a facades Map keyed by id, return the cached\nEngineFacade if present, and only create+store a new EngineFacade (using\nadapter, sortedMiddlewares, this) when none exists; ensure you invalidate or\nupdate the cached facade when adapters or middlewares change. Reference symbols:\ngetEngine, EngineFacade, activeTask, adapters, middlewares on EngineBridge.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commits 688c607 to bd47e24",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T12:13:45Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937780",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937780"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937780"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937780/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 125,
    "original_start_line": 105,
    "start_side": "RIGHT",
    "line": 146,
    "original_line": 122,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 122,
    "position": 146,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937785",
    "pull_request_review_id": 3783383998,
    "id": 2791937785,
    "node_id": "PRRC_kwDORJ0gd86maZb5",
    "diff_hunk": "@@ -0,0 +1,174 @@\n+import {\n+  IEngine,\n+  IEngineAdapter,\n+  IEngineAdapterInfo,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  ISearchTask,\n+  ILicenseInfo,\n+  IMiddleware,\n+  IMiddlewareContext,\n+  IEngineBridge,\n+} from \"../types\";\n+\n+/**\n+ * åˆ©ç”¨è€…å‘ã‘ã® Facade ã‚¯ãƒ©ã‚¹ã€‚\n+ * \n+ * ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®è©³ç´°ï¼ˆWorkeré€šä¿¡ã€ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼‰ã‚’æŠ½è±¡åŒ–ã—ã€\n+ * ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®é©ç”¨ã‚„ã‚¿ã‚¹ã‚¯ç®¡ç†ï¼ˆæ’ä»–åˆ¶å¾¡ã€çµ±è¨ˆåé›†ï¼‰ã‚’ä¸€å…ƒç®¡ç†ã—ã¾ã™ã€‚\n+ */\n+export class EngineFacade<\n+  T_OPTIONS extends IBaseSearchOptions = IBaseSearchOptions,\n+  T_INFO extends IBaseSearchInfo = IBaseSearchInfo,\n+  T_RESULT extends IBaseSearchResult = IBaseSearchResult,\n+> implements IEngine<T_OPTIONS, T_INFO, T_RESULT>\n+{\n+  /** ç¾åœ¨é€²è¡Œä¸­ã®æ¢ç´¢ã‚¿ã‚¹ã‚¯ã‚’ä¿æŒ */\n+  private activeTask: ISearchTask<T_INFO, T_RESULT> | null = null;\n+\n+  constructor(\n+    private readonly adapterInstance: IEngineAdapter<T_OPTIONS, T_INFO, T_RESULT>,\n+    /**\n+     * ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¯å¤šå²ã«ã‚ãŸã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã‚’æ‰±ã†å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€\n+     * å†…éƒ¨ç®¡ç†ç”¨ã« any ã‚’ä½¿ç”¨ã€‚å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã¯å‹å®‰å…¨æ€§ãŒç¶­æŒã•ã‚Œã‚‹ã€‚\n+     */\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    private readonly middlewares: IMiddleware<any, any>[] = [],\n+    private readonly bridge?: IEngineBridge,\n+  ) {}\n+\n+  /** ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ç¾åœ¨çŠ¶æ…‹ï¼ˆèª­å–å°‚ç”¨ï¼‰ */\n+  get adapter(): IEngineAdapterInfo {\n+    return this.adapterInstance;\n+  }\n+\n+  /**\n+   * ã‚¨ãƒ³ã‚¸ãƒ³ã®åˆæœŸåŒ–ã€‚\n+   * ãƒ–ãƒªãƒƒã‚¸ã®ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ WASM ç­‰ã‚’æº–å‚™ã—ã¾ã™ã€‚\n+   */\n+  async load(): Promise<void> {\n+    const loader = this.bridge ? await this.bridge.getLoader() : undefined;\n+    await this.adapterInstance.load(loader);\n+  }\n+\n+  /**\n+   * æ¢ç´¢ã‚’é–‹å§‹ã—ã¾ã™ã€‚\n+   * æ’ä»–åˆ¶å¾¡ï¼ˆå‰ã®ã‚¿ã‚¹ã‚¯ã®è‡ªå‹•åœæ­¢ï¼‰ãŠã‚ˆã³ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã®åé›†ã‚’è¡Œã„ã¾ã™ã€‚\n+   */\n+  async search(options: T_OPTIONS): Promise<ISearchTask<T_INFO, T_RESULT>> {\n+    const startTime = Date.now();\n+\n+    // 1. æ—¢å­˜ã‚¿ã‚¹ã‚¯ãŒã‚ã‚Œã°åœæ­¢ (2026 Best Practice: Auto-abort)\n+    if (this.activeTask) {\n+      await this.activeTask.stop();\n+    }\n+\n+    const context: IMiddlewareContext<T_OPTIONS> = {\n+      engineId: this.adapterInstance.id,\n+      adapterName: this.adapterInstance.name,\n+      timestamp: startTime,\n+      options: options,\n+    };\n+\n+    // æ¢ç´¢é–‹å§‹ã®ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚’ç™ºè¡Œ\n+    this.adapterInstance.emitTelemetry?.({\n+      event: \"search_start\",\n+      timestamp: startTime,\n+      attributes: { engineId: this.adapterInstance.id }\n+    });\n+\n+    // 2. ã‚³ãƒãƒ³ãƒ‰ç”Ÿæˆã¨ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢é©ç”¨\n+    let command = this.adapterInstance.parser.createSearchCommand(options);\n+    for (const middleware of this.middlewares) {\n+      if (middleware.onCommand) {\n+        command = await middleware.onCommand(command, context);\n+      }\n+    }\n+\n+    // 3. ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã«ã‚ˆã‚‹å®Ÿè¡Œ\n+    const task = this.adapterInstance.searchRaw(command);\n+    this.activeTask = task;\n+\n+    // 4. AbortSignal ã¨ã®é€£å‹•\n+    if (options.signal) {\n+      options.signal.addEventListener(\"abort\", () => {\n+        void task.stop();\n+      }, { once: true });\n+    }",
    "path": "packages/core/src/bridge/EngineFacade.ts",
    "commit_id": "937185b2e7999f41028c8428c8c1a36ee882683d",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**`signal` ãŒæ—¢ã« abort æ¸ˆã¿ã®å ´åˆã€`abort` ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ãªã„**\n\n`options.signal` ãŒ `search()` å‘¼ã³å‡ºã—æ™‚ç‚¹ã§æ—¢ã« `aborted` çŠ¶æ…‹ã®å ´åˆã€`abort` ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚‚ã† dispatch ã•ã‚Œãªã„ãŸã‚ã€`addEventListener` ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚äº‹å‰ã« `signal.aborted` ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\n\n<details>\n<summary>ğŸ› ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n     // 4. AbortSignal ã¨ã®é€£å‹•\n     if (options.signal) {\n+      if (options.signal.aborted) {\n+        void task.stop();\n+      } else {\n         options.signal.addEventListener(\"abort\", () => {\n           void task.stop();\n         }, { once: true });\n+      }\n     }\n```\n</details>\n\n<!-- suggestion_start -->\n\n<details>\n<summary>ğŸ“ Committable suggestion</summary>\n\n> â€¼ï¸ **IMPORTANT**\n> Carefully review the code before committing. Ensure that it accurately replaces the highlighted code, contains no missing lines, and has no issues with indentation. Thoroughly test & benchmark the code to ensure it meets the requirements.\n\n```suggestion\n    if (options.signal) {\n      if (options.signal.aborted) {\n        void task.stop();\n      } else {\n        options.signal.addEventListener(\"abort\", () => {\n          void task.stop();\n        }, { once: true });\n      }\n    }\n```\n\n</details>\n\n<!-- suggestion_end -->\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/bridge/EngineFacade.ts` around lines 94 - 98, If\noptions.signal may already be aborted when search() is called, check\noptions.signal.aborted before adding the event listener and call task.stop()\nimmediately in that case; keep the existing addEventListener(...) with { once:\ntrue } for future aborts. Concretely, before\noptions.signal.addEventListener(...) inspect options.signal.aborted and invoke\ntask.stop() if true, otherwise attach the listener that calls task.stop()\n(referencing options.signal, addEventListener, and task.stop).\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:15Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937785",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937785"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937785"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937785/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 94,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 98,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 98,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937788",
    "pull_request_review_id": 3783383998,
    "id": 2791937788,
    "node_id": "PRRC_kwDORJ0gd86maZb8",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+import { IFileStorage, IEngineSourceConfig, IEngineLoader, EngineErrorCode } from \"../types\";\n+import { SecurityAdvisor } from \"../capabilities/SecurityAdvisor\";\n+import { EngineError } from \"../errors/EngineError\";\n+\n+/**\n+ * ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒã‚¤ãƒŠãƒªã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®‰å…¨ã‹ã¤åŠ¹ç‡çš„ã«ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã®ã‚µãƒ¼ãƒ“ã‚¹ã€‚\n+ * \n+ * ç‰¹å¾´:\n+ * - SRI (Subresource Integrity) ã«ã‚ˆã‚‹æ”¹ç«„é˜²æ­¢\n+ * - FileStorage (OPFS/IndexedDB) ã«ã‚ˆã‚‹æ°¸ç¶šåŒ–ã‚­ãƒ£ãƒƒã‚·ãƒ¥\n+ * - Blob URL ã«ã‚ˆã‚‹ WebWorker ã®ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªèµ·å‹•\n+ */\n+export class EngineLoader implements IEngineLoader {\n+  constructor(private readonly storage: IFileStorage) {}\n+\n+  /**\n+   * æŒ‡å®šã•ã‚ŒãŸè¨­å®šã«åŸºã¥ã„ã¦ãƒªã‚½ãƒ¼ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚\n+   * ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ãã‚Œã‚’åˆ©ç”¨ã—ã€å­˜åœ¨ã—ãªã„å ´åˆã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚\n+   * \n+   * @returns ç”Ÿæˆã•ã‚ŒãŸ Blob URLã€‚WebWorker ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ç›´æ¥æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚\n+   * @throws {EngineError} SRIä¸ä¸€è‡´ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³æ™‚ã«ç™ºç”Ÿ\n+   */\n+  async loadResource(engineId: string, config: IEngineSourceConfig): Promise<string> {\n+    // 1. SRI ã®å½¢å¼ãƒã‚§ãƒƒã‚¯ (Fail-fast)\n+    if (config.sri && !SecurityAdvisor.isValidSRI(config.sri)) {\n+      throw new EngineError(\n+        EngineErrorCode.SRI_MISMATCH,\n+        `Invalid SRI hash format: ${config.sri}`,\n+        engineId\n+      );\n+    }",
    "path": "packages/core/src/bridge/EngineLoader.ts",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**SRI ãŒç©ºæ–‡å­—åˆ—ã®å ´åˆã€æ•´åˆæ€§æ¤œè¨¼ãŒå®Œå…¨ã«ãƒã‚¤ãƒ‘ã‚¹ã•ã‚Œã‚‹**\n\n`config.sri` ãŒç©ºæ–‡å­—åˆ— `\"\"` ã®å ´åˆã€falsy ã¨è©•ä¾¡ã•ã‚Œã‚‹ãŸã‚ SRI ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯ãŒã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã€ã•ã‚‰ã« `SecurityAdvisor.getSafeFetchOptions(\"\")` ã‚‚ `integrity` ãªã—ã® `{}` ã‚’è¿”ã—ã¾ã™ã€‚çµæœã¨ã—ã¦ã€SRI æ¤œè¨¼ãªã—ã§ãƒªã‚½ãƒ¼ã‚¹ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã¾ã™ã€‚\n\n`IEngineSourceConfig.sri` ã¯å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆ`readonly sri: string`ï¼‰ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ç©ºæ–‡å­—åˆ—ã‚’è¨±å®¹ã™ã‚‹ã®ã¯è¨­è¨ˆæ„å›³ã¨çŸ›ç›¾ã—ã¾ã™ã€‚å®Ÿéš›ã« `StockfishAdapter` ã® `sources.main.sri` ã¯ `\"\"` ã«è¨­å®šã•ã‚Œã¦ãŠã‚Šã€ã“ã®ãƒ‘ã‚¹ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚\n\nã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã¯ã€Œå‹•çš„ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã†éš›ã¯ã€å¿…ãš SRI ãƒãƒƒã‚·ãƒ¥ã®æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã‚’çµ„ã¿è¾¼ã‚€ã“ã¨ã€ã¨å®šã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚\n\n<details>\n<summary>ğŸ”’ ææ¡ˆ: SRI ãŒæœªè¨­å®šã®å ´åˆã¯æ˜ç¤ºçš„ã«ã‚¨ãƒ©ãƒ¼ã¾ãŸã¯è­¦å‘Šã‚’å‡ºã™</summary>\n\n```diff\n   async loadResource(engineId: string, config: IEngineSourceConfig): Promise<string> {\n     // 1. SRI ã®å½¢å¼ãƒã‚§ãƒƒã‚¯ (Fail-fast)\n-    if (config.sri && !SecurityAdvisor.isValidSRI(config.sri)) {\n+    if (!config.sri) {\n+      console.warn(`[EngineLoader] No SRI hash provided for engine \"${engineId}\". Resource integrity cannot be verified.`);\n+    } else if (!SecurityAdvisor.isValidSRI(config.sri)) {\n       throw new EngineError(\n         EngineErrorCode.SRI_MISMATCH,\n         `Invalid SRI hash format: ${config.sri}`,\n         engineId\n       );\n     }\n```\n</details>\n\nAs per coding guidelines: ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ (SRI): å‹•çš„ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã†éš›ã¯ã€å¿…ãš SRI ãƒãƒƒã‚·ãƒ¥ã®æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã‚’çµ„ã¿è¾¼ã‚€ã“ã¨ã€\n\n<!-- suggestion_start -->\n\n<details>\n<summary>ğŸ“ Committable suggestion</summary>\n\n> â€¼ï¸ **IMPORTANT**\n> Carefully review the code before committing. Ensure that it accurately replaces the highlighted code, contains no missing lines, and has no issues with indentation. Thoroughly test & benchmark the code to ensure it meets the requirements.\n\n```suggestion\n  async loadResource(engineId: string, config: IEngineSourceConfig): Promise<string> {\n    // 1. SRI ã®å½¢å¼ãƒã‚§ãƒƒã‚¯ (Fail-fast)\n    if (!config.sri) {\n      console.warn(`[EngineLoader] No SRI hash provided for engine \"${engineId}\". Resource integrity cannot be verified.`);\n    } else if (!SecurityAdvisor.isValidSRI(config.sri)) {\n      throw new EngineError(\n        EngineErrorCode.SRI_MISMATCH,\n        `Invalid SRI hash format: ${config.sri}`,\n        engineId\n      );\n    }\n```\n\n</details>\n\n<!-- suggestion_end -->\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/bridge/EngineLoader.ts` around lines 23 - 31, loadResource\nã® SRI ãƒã‚§ãƒƒã‚¯ã¯ falsy åˆ¤å®šã®ãŸã‚ç©ºæ–‡å­—åˆ— \"\" ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ã—ã¾ã„ SRI\næ¤œè¨¼ãŒãƒã‚¤ãƒ‘ã‚¹ã•ã‚Œã‚‹ãŸã‚ã€IEngineSourceConfig.sri ãŒç©ºæ–‡å­—åˆ—ã®å ´åˆã‚’æ˜ç¤ºçš„ã«ä¸æ­£æ‰±ã„ã«ã—ã¦å¤±æ•—ã•ã›ã¦ãã ã•ã„; å…·ä½“çš„ã«ã¯\nEngineLoader.ts ã® loadResource å†…ã®æ¡ä»¶ã‚’å˜ãªã‚‹ `if (config.sri && ...)`\nã‹ã‚‰ç©ºæ–‡å­—åˆ—ã‚‚æ¤œå‡ºã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã«å¤‰æ›´ã—ã€ç©ºã¾ãŸã¯æœªè¨­å®šã® SRI ã®ã¨ãã¯ EngineError(EngineErrorCode.SRI_MISMATCH,\n...) ã‚’æŠ•ã’ã—ã¦å‡¦ç†ã‚’ä¸­æ–­ã—ã€ã¾ãŸ SecurityAdvisor.getSafeFetchOptions ã‚’å‘¼ã¶å‰ã« config.sri\nãŒæœ‰åŠ¹ãªãƒãƒƒã‚·ãƒ¥ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ï¼ˆå‚ç…§ã‚·ãƒ³ãƒœãƒ«: loadResource, IEngineSourceConfig.sri,\nSecurityAdvisor.getSafeFetchOptions, EngineError, EngineErrorCodeï¼‰ã€‚\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:15Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937788",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937788"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937788"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937788/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 14,
    "original_start_line": 23,
    "start_side": "RIGHT",
    "line": 30,
    "original_line": 31,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 31,
    "position": 30,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937800",
    "pull_request_review_id": 3783383998,
    "id": 2791937800,
    "node_id": "PRRC_kwDORJ0gd86maZcI",
    "diff_hunk": "@@ -0,0 +1,73 @@\n+import { ICapabilities } from \"../types\";\n+\n+/**\n+ * å®Ÿè¡Œç’°å¢ƒï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã€Node.jsã€Workerï¼‰ã®èƒ½åŠ›ã‚’è¨ºæ–­ã™ã‚‹ã‚¯ãƒ©ã‚¹ã€‚\n+ * 2026å¹´æœ€æ–°åŸºæº–ã® Web API ã¸ã®å¯¾å¿œçŠ¶æ³ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€æœ€é©ãªå®Ÿè¡Œæˆ¦ç•¥ã‚’é¸æŠå¯èƒ½ã«ã—ã¾ã™ã€‚\n+ */\n+export class CapabilityDetector {\n+  /**\n+   * ç¾åœ¨ã®ç’°å¢ƒã®èƒ½åŠ›ã‚’éåŒæœŸã§è¨ºæ–­ã—ã¾ã™ã€‚\n+   */\n+  static async detect(): Promise<ICapabilities> {\n+    const details: Record<string, string> = {};\n+    /**\n+     * ãƒ–ãƒ©ã‚¦ã‚¶ã€WebWorkerã€Node.js ãªã©ã®å¤šæ§˜ãªå®Ÿè¡Œç’°å¢ƒã§å…±é€šã—ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«API\n+     * ï¼ˆnavigator, WebTransport ç­‰ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã€æ„å›³çš„ã« any ã‚’ä½¿ç”¨ã€‚\n+     */\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    const g = globalThis as any;",
    "path": "packages/core/src/capabilities/CapabilityDetector.ts",
    "commit_id": "937185b2e7999f41028c8428c8c1a36ee882683d",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_ğŸ› ï¸ Refactor suggestion_ | _ğŸŸ  Major_\n\n**ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³é•å: `any` ã®ä½¿ç”¨ãŒç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚**\n\n`globalThis as any` ã¯ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®ã€Œç¦æ­¢: `any` ã®ä½¿ç”¨ã€‚ä»£ã‚ã‚Šã« `unknown` ã¨å‹ã‚¬ãƒ¼ãƒ‰ã€ã¾ãŸã¯å¢ƒç•Œä»˜ãã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€ã«æŠµè§¦ã—ã¾ã™ã€‚ESLint ã®æŠ‘åˆ¶ã‚³ãƒ¡ãƒ³ãƒˆã§æ„å›³ã¯èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ãŒã€ã‚°ãƒ­ãƒ¼ãƒãƒ« API ã‚¢ã‚¯ã‚»ã‚¹ã«å¿…è¦ãªæœ€å°é™ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã§ `any` ã‚’å›é¿ã§ãã¾ã™ã€‚\n\n<details>\n<summary>â™»ï¸ ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n+/** ç’°å¢ƒæ¤œå‡ºã«å¿…è¦ãªã‚°ãƒ­ãƒ¼ãƒãƒ« API ã®æœ€å°å‹å®šç¾© */\n+interface GlobalEnv {\n+  navigator?: {\n+    storage?: { getDirectory?: unknown };\n+    ml?: unknown;\n+    gpu?: unknown;\n+  };\n+  SharedArrayBuffer?: unknown;\n+  WebTransport?: unknown;\n+}\n+\n export class CapabilityDetector {\n   static async detect(): Promise<ICapabilities> {\n     const details: Record<string, string> = {};\n-    // eslint-disable-next-line `@typescript-eslint/no-explicit-any`\n-    const g = globalThis as any;\n+    const g = globalThis as unknown as GlobalEnv;\n```\n</details>\n\nAs per coding guidelines: \"ç¦æ­¢: `any` ã®ä½¿ç”¨ã€‚ä»£ã‚ã‚Šã« `unknown` ã¨å‹ã‚¬ãƒ¼ãƒ‰ã€ã¾ãŸã¯å¢ƒç•Œä»˜ãã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨\"\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/capabilities/CapabilityDetector.ts` around lines 17 - 18,\nã“ã®è¡Œã§ä½¿ã£ã¦ã„ã‚‹ `globalThis as any` ã‚’ç¦æ­¢ã•ã‚ŒãŸ `any` ã‚’ä½¿ã‚ãªã„å½¢ã«ç½®ãæ›ãˆã¦ãã ã•ã„: å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«å¿…è¦ãªã‚°ãƒ­ãƒ¼ãƒãƒ«\nAPI ã ã‘ã‚’å«ã‚€å°ã•ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆä¾‹: CapabilityDetector ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰/ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¾¤ï¼‰ã‚’ä½œã‚Šã€`g`\nã‚’ãã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ï¼ˆã¾ãŸã¯ `unknown` ã‚’ä½¿ã£ã¦ã‹ã‚‰å‹ã‚¬ãƒ¼ãƒ‰ã§æ¤œè¨¼ï¼‰ã«ã‚­ãƒ£ã‚¹ãƒˆã—ã¦ã‹ã‚‰ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¦ãã ã•ã„; å¯¾è±¡ã‚·ãƒ³ãƒœãƒ«ã¯å¤‰æ•° `g`\nã¨ãƒ•ã‚¡ã‚¤ãƒ«å†…ã® CapabilityDetector å‘¨è¾ºã®ã‚°ãƒ­ãƒ¼ãƒãƒ«å‚ç…§ã§ã™ã€‚\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:15Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937800",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937800"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937800"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 17,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 18,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 18,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937802",
    "pull_request_review_id": 3783383998,
    "id": 2791937802,
    "node_id": "PRRC_kwDORJ0gd86maZcK",
    "diff_hunk": "@@ -0,0 +1,41 @@\n+import { EngineErrorCode, IEngineError } from \"../types\";\n+\n+/**\n+ * ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ä½¿ç”¨ã™ã‚‹æ¨™æº–ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ã€‚\n+ */\n+export class EngineError extends Error implements IEngineError {\n+  constructor(\n+    public readonly code: EngineErrorCode,\n+    message: string,\n+    public readonly engineId?: string,\n+    public readonly originalError?: unknown\n+  ) {\n+    super(message);\n+    this.name = \"EngineError\";\n+    \n+    /**\n+     * V8 ãªã©ã®å¯¾å¿œç’°å¢ƒã§ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’æ­£ç¢ºã«ä¿æŒã™ã‚‹ãŸã‚ã« captureStackTrace ã‚’ä½¿ç”¨ã€‚\n+     * æ¨™æº–ã® Error å‹å®šç¾©ã«å«ã¾ã‚Œãªã„ãŸã‚ any ã‚’ä½¿ç”¨ã€‚\n+     */\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    if ((Error as any).captureStackTrace) {\n+      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+      (Error as any).captureStackTrace(this, EngineError);\n+    }",
    "path": "packages/core/src/errors/EngineError.ts",
    "commit_id": "937185b2e7999f41028c8428c8c1a36ee882683d",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_ğŸ› ï¸ Refactor suggestion_ | _ğŸŸ  Major_\n\n**ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¾“ã„ã€`any` ã®ä½¿ç”¨ã‚’é¿ã‘ã¦ãã ã•ã„ã€‚**\n\n`captureStackTrace` ã¯ V8 å›ºæœ‰ã® API ã§ã‚ã‚Šã€æ¨™æº–ã® `Error` å‹å®šç¾©ã«å«ã¾ã‚Œãªã„ã“ã¨ã¯ç†è§£ã§ãã¾ã™ãŒã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã¯ `any` ã®ä½¿ç”¨ãŒç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚å‹å®‰å…¨ãªä»£æ›¿æ¡ˆã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚\n\n<details>\n<summary>â™»ï¸ ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n-    // eslint-disable-next-line `@typescript-eslint/no-explicit-any`\n-    if ((Error as any).captureStackTrace) {\n-      // eslint-disable-next-line `@typescript-eslint/no-explicit-any`\n-      (Error as any).captureStackTrace(this, EngineError);\n-    }\n+    const ErrorWithCapture = Error as unknown as {\n+      captureStackTrace?: (target: object, constructor: NewableFunction) => void;\n+    };\n+    if (ErrorWithCapture.captureStackTrace) {\n+      ErrorWithCapture.captureStackTrace(this, EngineError);\n+    }\n```\n</details>\n\nAs per coding guidelines: ã€Œç¦æ­¢: `any` ã®ä½¿ç”¨ã€‚ä»£ã‚ã‚Šã« `unknown` ã¨å‹ã‚¬ãƒ¼ãƒ‰ã€ã¾ãŸã¯å¢ƒç•Œä»˜ãã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€\n\n<!-- suggestion_start -->\n\n<details>\n<summary>ğŸ“ Committable suggestion</summary>\n\n> â€¼ï¸ **IMPORTANT**\n> Carefully review the code before committing. Ensure that it accurately replaces the highlighted code, contains no missing lines, and has no issues with indentation. Thoroughly test & benchmark the code to ensure it meets the requirements.\n\n```suggestion\n     */\n    const ErrorWithCapture = Error as unknown as {\n      captureStackTrace?: (target: object, constructor: NewableFunction) => void;\n    };\n    if (ErrorWithCapture.captureStackTrace) {\n      ErrorWithCapture.captureStackTrace(this, EngineError);\n    }\n```\n\n</details>\n\n<!-- suggestion_end -->\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/errors/EngineError.ts` around lines 19 - 24, Replace the\nunsafe \"any\" casts around captureStackTrace by declaring a small V8-specific\ntype and casting Error through unknown to that interface, then use optional\nchaining to call captureStackTrace; specifically, create an interface (e.g.\nV8ErrorConstructor with captureStackTrace?: (target: Function, ctor?: Function)\n=> void), cast Error as unknown as V8ErrorConstructor, and invoke\nv8Error.captureStackTrace?.(this, EngineError) instead of using (Error as\nany).captureStackTrace and (Error as any).captureStackTrace(this, EngineError);\nthis removes any while keeping type safety around EngineError and\ncaptureStackTrace usage.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:15Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937802",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937802"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937802"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937802/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 19,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 24,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 24,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937805",
    "pull_request_review_id": 3783383998,
    "id": 2791937805,
    "node_id": "PRRC_kwDORJ0gd86maZcN",
    "diff_hunk": "@@ -1 +1,8 @@\n-export * from \"./types.js\";\n+export * from \"./types\";\n+export * from \"./protocols/index\";\n+export * from \"./capabilities/index\";\n+export * from \"./storage/index\";\n+export * from \"./adapters/index\";\n+export * from \"./bridge/index\";\n+export * from \"./workers/index\";\n+export * from \"./errors/EngineError\";",
    "path": "packages/core/src/index.ts",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n<details>\n<summary>ğŸ§© Analysis chain</summary>\n\nğŸ Script executed:\n\n```shell\n#!/bin/bash\n# Verify what each sub-module index.ts exports\necho \"=== adapters/index.ts ===\"\nif [ -f packages/core/src/adapters/index.ts ]; then\n  cat packages/core/src/adapters/index.ts\nelse\n  echo \"File not found\"\nfi\necho \"\"\necho \"=== workers/index.ts ===\"\nif [ -f packages/core/src/workers/index.ts ]; then\n  cat packages/core/src/workers/index.ts\nelse\n  echo \"File not found\"\nfi\necho \"\"\necho \"=== bridge/index.ts ===\"\nif [ -f packages/core/src/bridge/index.ts ]; then\n  cat packages/core/src/bridge/index.ts\nelse\n  echo \"File not found\"\nfi\necho \"\"\necho \"=== storage/index.ts ===\"\nif [ -f packages/core/src/storage/index.ts ]; then\n  cat packages/core/src/storage/index.ts\nelse\n  echo \"File not found\"\nfi\necho \"\"\necho \"=== types/index.ts (or types.ts) ===\"\nif [ -f packages/core/src/types/index.ts ]; then\n  cat packages/core/src/types/index.ts\nelif [ -f packages/core/src/types.ts ]; then\n  cat packages/core/src/types.ts\nelse\n  echo \"File not found\"\nfi\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 13070\n\n---\n\n\n\n</details>\n\n**Facade ãƒ‘ã‚¿ãƒ¼ãƒ³é•åï¼šå†…éƒ¨å®Ÿè£…ã‚¯ãƒ©ã‚¹ãŒå…¬é–‹ API ã‚µãƒ¼ãƒ•ã‚§ã‚¹ã«éœ²å‡ºã—ã¦ã„ã¾ã™ã€‚**\n\næ¤œæŸ»çµæœã‹ã‚‰ã€ä»¥ä¸‹ã®å†…éƒ¨å®Ÿè£…ã‚¯ãƒ©ã‚¹ãŒæ¶ˆè²»è€…ã«ç›´æ¥å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ï¼š\n\n- `adapters/index.ts`: `BaseAdapter`ï¼ˆé©ç”¨ä¸å¯ï¼‰\n- `workers/index.ts`: `WorkerCommunicator`ï¼ˆé©ç”¨ä¸å¯ï¼‰\n- `bridge/index.ts`: `EngineBridge`ã€`EngineFacade`ã€`EngineLoader`ï¼ˆå…·è±¡å®Ÿè£…ï¼‰\n- `storage/index.ts`: `OPFSStorage`ã€`IndexedDBStorage`ï¼ˆå…·è±¡å®Ÿè£…ï¼‰\n\nã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã¯ã€æ¶ˆè²»è€…ã¯ `IEngine` ã®ã¿ã‚’ä»‹ã—ã¦ã‚¨ãƒ³ã‚¸ãƒ³ã‚’åˆ©ç”¨ã—ã€`IEngineAdapter` ãªã©ã®å†…éƒ¨å®Ÿè£…ã¯éš è”½ã™ã¹ãã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ç¾åœ¨ã® `export *` ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯ã€ã“ã‚Œã‚‰ã®å®Ÿè£…è©³ç´°ãŒ `packages/core/src/index.ts` ã‚’é€šã˜ã¦å…¬é–‹ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚\n\n**å¯¾ç­–ï¼š** å„ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® `index.ts` ã§å…¬é–‹å¯¾è±¡ã‚’æ˜ç¤ºçš„ã«åˆ¶é™ã—ã¦ãã ã•ã„ã€‚æ¶ˆè²»è€…å‘ã‘ã«ã¯å¯¾å¿œã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆä¾‹ï¼š`IEngineAdapter`ï¼‰ã®ã¿ã‚’ã€å¿…è¦ã«å¿œã˜ã¦å·¥å ´é–¢æ•°ã‚’é€šã˜ã¦æä¾›ã—ã€å…·è±¡ã‚¯ãƒ©ã‚¹ã¯å†…éƒ¨ã«ç•™ã‚ã¦ãã ã•ã„ã€‚\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/index.ts` around lines 1 - 8, The root export file is\nre-exporting concrete internal classes (BaseAdapter, WorkerCommunicator,\nEngineBridge, EngineFacade, EngineLoader, OPFSStorage, IndexedDBStorage) which\nexposes implementation details; update the submodule index files to export only\nthe public interfaces and factory creators (e.g., export IEngine,\nIEngineAdapter, and any createXFactory functions) and remove exports of the\nconcrete classes, then update the central exports in packages/core/src/index.ts\nto only re-export those interfaces and factories (not the concrete symbols) so\nconsumers see IEngine and IEngineAdapter-only surface; ensure any code that\nneeds the concrete classes remains internal to the module or accessed via\nfactory functions.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:15Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937805",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937805"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937805"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937805/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 1,
    "original_start_line": 1,
    "start_side": "RIGHT",
    "line": 7,
    "original_line": 8,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 9,
    "position": 8,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937814",
    "pull_request_review_id": 3783383998,
    "id": 2791937814,
    "node_id": "PRRC_kwDORJ0gd86maZcW",
    "diff_hunk": "@@ -0,0 +1,94 @@\n+import {\n+  IProtocolParser,\n+} from \"./types\";\n+import {\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  Move,\n+} from \"../types\";\n+\n+/**\n+ * æ±ç”¨çš„ãª UCI (Universal Chess Interface) ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ‘ãƒ¼ã‚µãƒ¼ã€‚\n+ * Stockfish ãªã©ã®ãƒã‚§ã‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã€ãŠã‚ˆã³æ´¾ç”Ÿãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®åŸºåº•ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚\n+ */\n+export class UCIParser implements IProtocolParser<IBaseSearchOptions, IBaseSearchInfo, IBaseSearchResult> {\n+  /**\n+   * \"info depth 10 score cp 50 pv e2e4 ...\" å½¢å¼ã®è¡Œã‚’è§£æã—ã¾ã™ã€‚\n+   */\n+  parseInfo(line: string): IBaseSearchInfo | null {\n+    if (!line.startsWith(\"info \")) return null;\n+\n+    const info: IBaseSearchInfo = {\n+      depth: 0,\n+      score: 0,\n+      raw: line,\n+    };\n+\n+    const parts = line.split(\" \");\n+    for (let i = 1; i < parts.length; i++) {\n+      switch (parts[i]) {\n+        case \"depth\":\n+          info.depth = parseInt(parts[++i], 10);\n+          break;\n+        case \"score\": {\n+          const scoreType = parts[++i]; // \"cp\" or \"mate\"\n+          const scoreValue = parseInt(parts[++i], 10);\n+          info.score = scoreType === \"mate\" ? scoreValue * 10000 : scoreValue;\n+          break;\n+        }\n+        case \"nps\":\n+          info.nps = parseInt(parts[++i], 10);\n+          break;\n+        case \"time\":\n+          info.time = parseInt(parts[++i], 10);\n+          break;\n+        case \"pv\":\n+          info.pv = parts.slice(i + 1) as Move[];\n+          i = parts.length; // PV ã¯è¡Œã®æœ€å¾Œã¾ã§ç¶šã\n+          break;\n+      }\n+    }\n+\n+    return info;\n+  }\n+\n+  /**\n+   * \"bestmove e2e4 ponder e7e5\" å½¢å¼ã®è¡Œã‚’è§£æã—ã¾ã™ã€‚\n+   */\n+  parseResult(line: string): IBaseSearchResult | null {\n+    if (!line.startsWith(\"bestmove \")) return null;\n+\n+    const parts = line.split(\" \");\n+    const result: IBaseSearchResult = {\n+      bestMove: parts[1] as Move,\n+      raw: line,\n+    };\n+\n+    const ponderIndex = parts.indexOf(\"ponder\");\n+    if (ponderIndex !== -1 && ponderIndex + 1 < parts.length) {\n+      result.ponder = parts[ponderIndex + 1] as Move;\n+    }\n+\n+    return result;\n+  }\n+\n+  /**\n+   * æ¢ç´¢é–‹å§‹ã‚³ãƒãƒ³ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã™ã€‚\n+   */\n+  createSearchCommand(options: IBaseSearchOptions): string {\n+    let cmd = `position fen ${options.fen}\n+go`;\n+    if (options.depth) cmd += ` depth ${options.depth}`;\n+    if (options.time) cmd += ` movetime ${options.time}`;\n+    if (options.nodes) cmd += ` nodes ${options.nodes}`;\n+    return cmd;\n+  }",
    "path": "packages/core/src/protocols/UCIParser.ts",
    "commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**`createSearchCommand` ãŒ `position` ã¨ `go` ã‚’æ”¹è¡Œã§çµåˆã—ãŸå˜ä¸€æ–‡å­—åˆ—ã‚’è¿”ã—ã¦ã„ã¾ã™ã€‚**\n\nUCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã¯ `position fen ...` ã¨ `go ...` ã¯åˆ¥ã€…ã®ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å˜ä¸€æ–‡å­—åˆ—ã¨ã—ã¦è¿”ã—ãŸå ´åˆã€å‘¼ã³å‡ºã—å…ƒãŒæ”¹è¡Œã§åˆ†å‰²ã—ã¦é€ä¿¡ã—ãªã‘ã‚Œã°ã‚¨ãƒ³ã‚¸ãƒ³ãŒæ­£ã—ãè§£é‡ˆã§ãã¾ã›ã‚“ã€‚\n\nã‚³ãƒãƒ³ãƒ‰ã‚’é…åˆ—ã§è¿”ã™ã‹ã€å‘¼ã³å‡ºã—å…ƒã§åˆ†å‰²ã™ã‚‹è¦ç´„ã‚’æ˜ç¤ºã™ã‚‹ã“ã¨ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚\n\n<details>\n<summary>â™»ï¸ ä¿®æ­£æ¡ˆï¼ˆé…åˆ—ã‚’è¿”ã™å ´åˆï¼‰</summary>\n\nã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ `IProtocolParser.createSearchCommand` ã®æˆ»ã‚Šå€¤å‹ã®å¤‰æ›´ãŒå¿…è¦ã«ãªã‚Šã¾ã™ãŒã€ã‚ˆã‚Šå®‰å…¨ãªè¨­è¨ˆã§ã™ï¼š\n\n```diff\n-  createSearchCommand(options: IBaseSearchOptions): string {\n-    let cmd = `position fen ${options.fen}\n-go`;\n-    if (options.depth) cmd += ` depth ${options.depth}`;\n-    if (options.time) cmd += ` movetime ${options.time}`;\n-    if (options.nodes) cmd += ` nodes ${options.nodes}`;\n-    return cmd;\n+  createSearchCommand(options: IBaseSearchOptions): string[] {\n+    const position = `position fen ${options.fen}`;\n+    let go = \"go\";\n+    if (options.depth) go += ` depth ${options.depth}`;\n+    if (options.time) go += ` movetime ${options.time}`;\n+    if (options.nodes) go += ` nodes ${options.nodes}`;\n+    return [position, go];\n   }\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/protocols/UCIParser.ts` around lines 79 - 86, The\ncreateSearchCommand currently concatenates \"position fen ...\" and \"go ...\" into\none newline-separated string; change it to return an array of individual UCI\ncommands (e.g., [\"position fen ...\", \"go ...\"]) so each command is sent\nseparately: update the createSearchCommand signature in IProtocolParser to\nreturn string[] (or an agreed tuple) and modify createSearchCommand (referenced\nby name and using IBaseSearchOptions) to build a first element \"position fen\n{options.fen}\" and a second element \"go\" with depth/movetime/nodes appended to\nthat second string; also update all callers to accept and send each array\nelement as a separate UCI command.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:15Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937814",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937814"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937814"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937814/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 79,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 86,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 86,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937815",
    "pull_request_review_id": 3783384054,
    "id": 2791937815,
    "node_id": "PRRC_kwDORJ0gd86maZcX",
    "diff_hunk": "@@ -0,0 +1,132 @@\n+<!DOCTYPE html>\n+<html lang=\"en\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <title>Multi-Game Engines - Simple Chess Example</title>\n+    <style>\n+        body { font-family: sans-serif; padding: 20px; line-height: 1.6; }\n+        #log { background: #f4f4f4; border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: auto; font-family: monospace; white-space: pre-wrap; }\n+        .controls { margin-bottom: 20px; }\n+        .status { margin-bottom: 10px; font-weight: bold; }\n+        .progress-bar { width: 100%; background: #eee; height: 20px; margin-bottom: 10px; }\n+        #progress-fill { width: 0%; background: #4caf50; height: 100%; transition: width 0.3s; }\n+    </style>\n+</head>\n+<body>\n+    <h1>Stockfish WASM Demo (2026 Edition)</h1>\n+    \n+    <div class=\"status\" id=\"status\">Status: Idle</div>\n+    <div class=\"progress-bar\"><div id=\"progress-fill\"></div></div>\n+    \n+    <div class=\"controls\">\n+        <button id=\"loadBtn\">1. Load Engine</button>\n+        <button id=\"searchBtn\" disabled>2. Start Search (startpos)</button>\n+        <button id=\"stopBtn\" disabled>Stop</button>\n+    </div>\n+\n+    <div id=\"log\">Logs will appear here...</div>\n+\n+    <!-- é–‹ç™ºä¸­ã¯ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ importmap ãªã©ã§è§£æ±ºã™ã‚‹ã‹ã€\n+         ç›´æ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã§èª­ã¿è¾¼ã‚€å½¢ã«ãªã‚Šã¾ã™ãŒã€\n+         ã“ã“ã§ã¯ ESM ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦è¨˜è¿°ã—ã¾ã™ -->\n+    <script type=\"module\">\n+        // æœ¬æ¥ã¯ npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦è§£æ±ºã•ã‚Œã¾ã™ãŒã€\n+        // ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦å‹•ä½œã•ã›ã‚‹ãŸã‚ã«ã€ç›¸å¯¾ãƒ‘ã‚¹ã§ãƒ“ãƒ«ãƒ‰æ¸ˆã¿æˆæœç‰©ã‚’æŒ‡å®šã™ã‚‹ã‹ã€\n+        // é–‹ç™ºç”¨ã‚µãƒ¼ãƒãƒ¼ã‚’ä»‹ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚\n+        \n+        import { EngineBridge } from '../../packages/core/dist/index.mjs';\n+        import { StockfishAdapter } from '../../packages/adapter-stockfish/dist/index.js';\n+\n+        const logEl = document.getElementById('log');\n+        const statusEl = document.getElementById('status');\n+        const progressFill = document.getElementById('progress-fill');\n+        const loadBtn = document.getElementById('loadBtn');\n+        const searchBtn = document.getElementById('searchBtn');\n+        const stopBtn = document.getElementById('stopBtn');\n+\n+        function log(msg) {\n+            logEl.textContent += msg + '\n+';\n+            logEl.scrollTop = logEl.scrollHeight;\n+        }\n+\n+        const bridge = new EngineBridge();\n+        const adapter = new StockfishAdapter();\n+        bridge.registerAdapter(adapter);\n+\n+        const engine = bridge.getEngine('stockfish');\n+\n+        // ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­\n+        adapter.onStatusChange((status) => {\n+            statusEl.textContent = `Status: ${status}`;\n+            searchBtn.disabled = status !== 'ready';\n+        });\n+\n+        adapter.onProgress((p) => {\n+            progressFill.style.width = `${p.percentage}%`;\n+            log(`[Progress] ${p.phase}: ${p.i18n.defaultMessage}`);\n+        });\n+\n+        loadBtn.onclick = async () => {\n+            log('Loading engine...');\n+            try {\n+                await engine.load();\n+                log('Engine loaded successfully!');\n+            } catch (e) {\n+                log('Error loading engine: ' + e.message);\n+            }\n+        };\n+\n+        let currentTask = null;\n+\n+        searchBtn.onclick = async () => {\n+            log('Starting search...');\n+            searchBtn.disabled = true;\n+            stopBtn.disabled = false;\n+\n+            currentTask = engine.search({\n+                fen: 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1',\n+                depth: 15\n+            });",
    "path": "examples/simple-chess/index.html",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "gemini-code-assist[bot]",
      "id": 176961590,
      "node_id": "BOT_kgDOCow4Ng",
      "avatar_url": "https://avatars.githubusercontent.com/in/956858?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D",
      "html_url": "https://github.com/apps/gemini-code-assist",
      "followers_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "![critical](https://www.gstatic.com/codereviewagent/critical.svg)\n\n`engine.search()` ã¯ `Promise<ISearchTask>` ã‚’è¿”ã™éåŒæœŸé–¢æ•°ã§ã™ãŒã€`await` ãŒæŠœã‘ã¦ã„ã¾ã™ã€‚\nã“ã®ãŸã‚ã€`currentTask` å¤‰æ•°ã«ã¯ `ISearchTask` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ãªã `Promise` ãŒä»£å…¥ã•ã‚Œã¦ã—ã¾ã„ã€å¾Œç¶šã® `currentTask.info` ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã§å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚\n\n```suggestion\n            currentTask = await engine.search({\n                fen: 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1',\n                depth: 15\n            });\n```",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:12Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937815",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937815"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937815"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 88,
    "original_start_line": 88,
    "start_side": "RIGHT",
    "line": 91,
    "original_line": 91,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 91,
    "position": 91,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937817",
    "pull_request_review_id": 3783383998,
    "id": 2791937817,
    "node_id": "PRRC_kwDORJ0gd86maZcZ",
    "diff_hunk": "@@ -0,0 +1,64 @@\n+import { IFileStorage } from \"../types\";\n+\n+/**\n+ * OPFS (Origin Private File System) ã‚’ä½¿ç”¨ã—ãŸã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®Ÿè£…ã€‚\n+ * é«˜é€Ÿãªãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ã§ã€å¤§å®¹é‡ãƒã‚¤ãƒŠãƒªã®ä¿å­˜ã«é©ã—ã¦ã„ã¾ã™ã€‚\n+ */\n+export class OPFSStorage implements IFileStorage {\n+  private rootPromise: Promise<FileSystemDirectoryHandle> | null = null;\n+\n+  private getRoot(): Promise<FileSystemDirectoryHandle> {\n+    if (!this.rootPromise) {\n+      this.rootPromise = navigator.storage.getDirectory();\n+    }\n+    return this.rootPromise;\n+  }\n+\n+  async set(key: string, data: ArrayBuffer | Blob): Promise<void> {\n+    const root = await this.getRoot();\n+    const fileHandle = await root.getFileHandle(key, { create: true });\n+    const writable = await fileHandle.createWritable();\n+    await writable.write(data);\n+    await writable.close();\n+  }",
    "path": "packages/core/src/storage/OPFSStorage.ts",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**`set()` ã§ `writable.write()` ãŒå¤±æ•—ã—ãŸå ´åˆã€`WritableStream` ãŒãƒªãƒ¼ã‚¯ã™ã‚‹**\n\n`write()` ã§ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã¨ `close()` ãŒå‘¼ã°ã‚Œãšã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ³ãƒ‰ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚ŒãŸã¾ã¾ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚`try/finally` ã§ `close()` ã‚’ä¿è¨¼ã—ã¦ãã ã•ã„ã€‚\n\n<details>\n<summary>ğŸ› ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n   async set(key: string, data: ArrayBuffer | Blob): Promise<void> {\n     const root = await this.getRoot();\n     const fileHandle = await root.getFileHandle(key, { create: true });\n     const writable = await fileHandle.createWritable();\n-    await writable.write(data);\n-    await writable.close();\n+    try {\n+      await writable.write(data);\n+    } finally {\n+      await writable.close();\n+    }\n   }\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/storage/OPFSStorage.ts` around lines 17 - 23, In set(),\nensure the FileSystemWritableFileStream returned by fileHandle.createWritable()\nis always finalized: wrap the write/close in try/catch and on error call\nwritable.abort() (and rethrow) so the stream/file lock is released; reference\nthe set method, the writable variable and\nfileHandle.getFileHandle/createWritableâ€”replace the current await\nwritable.write(data); await writable.close(); with a try { await\nwritable.write(data); await writable.close(); } catch (err) { await\nwritable.abort().catch(()=>{}); throw err; } to guarantee no leaked writable\nstream.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commits 688c607 to bd47e24",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T12:13:50Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937817",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937817"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937817"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937817/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 19,
    "original_start_line": 17,
    "start_side": "RIGHT",
    "line": 31,
    "original_line": 23,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 23,
    "position": 31,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937821",
    "pull_request_review_id": 3783383998,
    "id": 2791937821,
    "node_id": "PRRC_kwDORJ0gd86maZcd",
    "diff_hunk": "@@ -418,10 +440,18 @@ export interface IEngineBridge {\n     middleware: IMiddleware<T_INFO, T_RESULT>,\n   ): void;\n \n+  /** ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’å–å¾—ã—ã¾ã™ (2026 Best Practice) */\n+  getLoader(): Promise<IEngineLoader>;\n+\n   /** å®Ÿè¡Œç’°å¢ƒãŒ 2026å¹´æœ€æ–°åŸºæº–ã® Web æ¨™æº–ã‚’æº€ãŸã—ã¦ã„ã‚‹ã‹è¨ºæ–­ã—ã¾ã™ */\n   checkCapabilities(): Promise<ICapabilities>;\n   /** ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çŠ¶æ…‹ã®è©³ç´°ã‚’å–å¾—ã—ã¾ã™ */\n   getSecurityStatus(): ISecurityStatus;\n+\n+  /** ã‚¨ãƒ³ã‚¸ãƒ³ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰åŒ–ã‚’ä¸­å¤®ã§è³¼èª­ã—ã¾ã™ (2026 Best Practice) */\n+  onGlobalStatusChange?(callback: (id: string, status: EngineStatus) => void): void;\n+  /** ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚’ä¸€æ‹¬ã§è³¼èª­ã—ã¾ã™ (2026 Best Practice) */\n+  onGlobalTelemetry?(callback: (id: string, event: ITelemetryEvent) => void): void;",
    "path": "packages/core/src/types.ts",
    "commit_id": "b83cd1cc903f37506f986ad6fb2feec970ae7f02",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**`onGlobalStatusChange` / `onGlobalTelemetry` ãŒè³¼èª­è§£é™¤é–¢æ•°ã‚’è¿”ã•ãªã„è¨­è¨ˆã¯ã€ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ãƒ¬ãƒ™ãƒ«ã®è³¼èª­ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ä¸æ•´åˆã§ã™ã€‚**\n\n`IEngineAdapter` ã® `onStatusChange`ï¼ˆLine 378ï¼‰ã€`onProgress`ï¼ˆLine 380ï¼‰ã€`onTelemetry`ï¼ˆLine 382ï¼‰ã¯ã™ã¹ã¦ `() => void` ã‚’è¿”ã—ã¦ã‚¢ãƒ³ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã‚’å¯èƒ½ã«ã—ã¦ã„ã¾ã™ãŒã€`IEngineBridge` ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«è³¼èª­ãƒ¡ã‚½ãƒƒãƒ‰ã«ã¯è¿”ã‚Šå€¤ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ¶ˆè²»å´ã§è³¼èª­è§£é™¤ãŒã§ããšã€ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã®åŸå› ã«ãªã‚Šå¾—ã¾ã™ã€‚\n\n<details>\n<summary>â™»ï¸ ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n  /** ã‚¨ãƒ³ã‚¸ãƒ³ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰åŒ–ã‚’ä¸­å¤®ã§è³¼èª­ã—ã¾ã™ (2026 Best Practice) */\n- onGlobalStatusChange?(callback: (id: string, status: EngineStatus) => void): void;\n+ onGlobalStatusChange?(callback: (id: string, status: EngineStatus) => void): () => void;\n  /** ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚’ä¸€æ‹¬ã§è³¼èª­ã—ã¾ã™ (2026 Best Practice) */\n- onGlobalTelemetry?(callback: (id: string, event: ITelemetryEvent) => void): void;\n+ onGlobalTelemetry?(callback: (id: string, event: ITelemetryEvent) => void): () => void;\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/types.ts` around lines 451 - 454, The global subscription\nmethods onGlobalStatusChange and onGlobalTelemetry currently donâ€™t return\nunsubscribe functions, causing inconsistency with\nIEngineAdapter.onStatusChange/onProgress/onTelemetry which return () => void;\nchange the signatures in IEngineBridge (or the containing type) so both\nonGlobalStatusChange(callback: (id: string, status: EngineStatus) => void) and\nonGlobalTelemetry(callback: (id: string, event: ITelemetryEvent) => void) return\na () => void unsubscribe function, and update any implementations to return a\nclosure that removes the listener when invoked.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:16Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937821",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937821"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937821"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937821/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 451,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 454,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 94,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937823",
    "pull_request_review_id": 3783383998,
    "id": 2791937823,
    "node_id": "PRRC_kwDORJ0gd86maZcf",
    "diff_hunk": "@@ -0,0 +1,113 @@\n+import { EngineError } from \"../errors/EngineError\";\n+import { EngineErrorCode } from \"../types\";\n+\n+/**\n+ * WebWorker ã¨ã®ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼é€šä¿¡ã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹ã€‚\n+ * \n+ * ä¸»ãªæ©Ÿèƒ½:\n+ * - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€å—ä¿¡ (postMessage)\n+ * - ç‰¹å®šã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¾…æ©Ÿã™ã‚‹ Promise ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (expectMessage)\n+ * - Worker å†…éƒ¨ã‚¨ãƒ©ãƒ¼ã®æ¤œçŸ¥ã¨ã€å¾…æ©Ÿä¸­ã® Promise ã¸ã®ä¾‹å¤–ä¼æ’­\n+ */\n+export class WorkerCommunicator {\n+  private worker: Worker | null = null;\n+  /** ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡æ™‚ã®å…¨ãƒªã‚¹ãƒŠãƒ¼ */\n+  private messageListeners = new Set<(data: unknown) => void>();\n+  /** \n+   * expectMessage ã§å¾…æ©Ÿä¸­ã®ãƒ—ãƒ­ãƒŸã‚¹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ã‚»ãƒƒãƒˆã€‚\n+   * ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã«ä¸€æ‹¬ã§ reject ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã€‚\n+   */\n+  private pendingExpectations = new Set<{\n+    predicate: (data: unknown) => boolean;\n+    // å¤–éƒ¨ã‹ã‚‰æŒ‡å®šã•ã‚ŒãŸä»»æ„ã®å‹ T ã¸å¤‰æ›ã™ã‚‹ãŸã‚ã€æ„å›³çš„ã« any ã‚’ä½¿ç”¨ã€‚\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    resolve: (data: any) => void;\n+    reject: (reason: Error) => void;\n+  }>();\n+\n+  constructor(private readonly workerUrl: string) {}\n+\n+  /**\n+   * Worker ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’é–‹å§‹ã—ã¾ã™ã€‚\n+   */\n+  async spawn(): Promise<void> {\n+    if (this.worker) return;\n+\n+    this.worker = new Worker(this.workerUrl);\n+    \n+    // æ­£å¸¸ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å—ä¿¡\n+    this.worker.onmessage = (e: MessageEvent) => {\n+      // 1. ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªã‚¹ãƒŠãƒ¼ã¸ã®é€šçŸ¥\n+      this.messageListeners.forEach((listener) => listener(e.data));\n+\n+      // 2. å¾…æ©Ÿä¸­ã® expectMessage ãƒ—ãƒ­ãƒŸã‚¹ã®è§£æ±ºãƒã‚§ãƒƒã‚¯\n+      for (const exp of this.pendingExpectations) {\n+        if (exp.predicate(e.data)) {\n+          this.pendingExpectations.delete(exp);\n+          exp.resolve(e.data);\n+        }\n+      }\n+    };\n+\n+    // Worker å†…éƒ¨ã§ã®ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚\n+    this.worker.onerror = (e: ErrorEvent) => {\n+      const error = new EngineError(\n+        EngineErrorCode.INTERNAL_ERROR,\n+        `Worker error: ${e.message}`\n+      );\n+      \n+      // å¾…æ©Ÿä¸­ã®å…¨ã¦ã® Promise ã‚’ç•°å¸¸çµ‚äº†ã•ã›ã‚‹ (ãƒãƒ³ã‚°ã‚¢ãƒƒãƒ—é˜²æ­¢)\n+      this.pendingExpectations.forEach((exp) => exp.reject(error));\n+      this.pendingExpectations.clear();\n+      \n+      console.error(\"WorkerCommunicator Error:\", e);\n+    };\n+  }\n+\n+  /**\n+   * Worker ã¸ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã™ã€‚\n+   * \n+   * @param message é€ä¿¡ãƒ‡ãƒ¼ã‚¿ (æ–‡å­—åˆ—ã€ãƒã‚¤ãƒŠãƒªã€ã¾ãŸã¯ UCI ã‚³ãƒãƒ³ãƒ‰)\n+   * @param transfer ã‚¼ãƒ­ã‚³ãƒ”ãƒ¼è»¢é€ã‚’è¡Œã† ArrayBuffer ç­‰ã®ãƒªã‚¹ãƒˆ\n+   */\n+  postMessage(message: string | Uint8Array | object, transfer?: Transferable[]): void {\n+    if (!this.worker) {\n+      throw new EngineError(EngineErrorCode.INTERNAL_ERROR, \"Worker has not been spawned yet.\");\n+    }\n+    this.worker.postMessage(message, transfer || []);\n+  }\n+\n+  /**\n+   * æ¡ä»¶ã«åˆè‡´ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ Worker ã‹ã‚‰å±Šãã¾ã§éåŒæœŸã§å¾…æ©Ÿã—ã¾ã™ã€‚\n+   * \n+   * @param predicate å—ä¿¡ãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…ã™ã‚‹ã‚‚ã®ã‹åˆ¤å®šã™ã‚‹é–¢æ•°\n+   * @returns æœŸå¾…ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå±Šã„ãŸæ™‚ã«è§£æ±ºã•ã‚Œã‚‹ Promise\n+   */\n+  expectMessage<T>(predicate: (data: unknown) => boolean): Promise<T> {\n+    return new Promise((resolve, reject) => {\n+      this.pendingExpectations.add({ predicate, resolve, reject });\n+    });\n+  }\n+\n+  /**\n+   * ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è³¼èª­ã‚’é–‹å§‹ã—ã¾ã™ã€‚\n+   * \n+   * @returns è³¼èª­ã‚’è§£é™¤ã™ã‚‹ãŸã‚ã®é–¢æ•°\n+   */\n+  onMessage(callback: (data: unknown) => void): () => void {\n+    this.messageListeners.add(callback);\n+    return () => this.messageListeners.delete(callback);\n+  }\n+\n+  /**\n+   * Worker ã‚’å³åº§ã«çµ‚äº†ã—ã€å…¨ã¦ã®å¾…æ©ŸçŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã€‚\n+   */\n+  terminate(): void {\n+    if (this.worker) {\n+      this.worker.terminate();\n+      this.worker = null;\n+    }\n+    this.messageListeners.clear();\n+    this.pendingExpectations.clear();\n+  }",
    "path": "packages/core/src/workers/WorkerCommunicator.ts",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸ”´ Critical_\n\n**`terminate()` ãŒå¾…æ©Ÿä¸­ã® `expectMessage` Promise ã‚’ reject ã›ãšã«ã‚¯ãƒªã‚¢ã—ã¦ã„ã‚‹**\n\n`pendingExpectations.clear()` ã¯ Promise ã‚’ reject ã›ãšã«ç ´æ£„ã™ã‚‹ãŸã‚ã€`expectMessage()` ã‚’ `await` ã—ã¦ã„ã‚‹å‘¼ã³å‡ºã—å…ƒãŒæ°¸ä¹…ã«ãƒãƒ³ã‚°ã—ã¾ã™ã€‚`onerror` ãƒãƒ³ãƒ‰ãƒ©ã§ã¯æ­£ã—ãå…¨ä»¶ reject ã—ã¦ã„ã‚‹ã®ã«ã€`terminate()` ã§ã¯è¡Œã‚ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\n\n<details>\n<summary>ğŸ› terminate æ™‚ã« pending ã‚’ reject ã™ã‚‹ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n   terminate(): void {\n     if (this.worker) {\n       this.worker.terminate();\n       this.worker = null;\n     }\n     this.messageListeners.clear();\n+    const terminationError = new EngineError(\n+      EngineErrorCode.INTERNAL_ERROR,\n+      \"Worker was terminated.\"\n+    );\n+    this.pendingExpectations.forEach((exp) => exp.reject(terminationError));\n     this.pendingExpectations.clear();\n   }\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/workers/WorkerCommunicator.ts` around lines 105 - 112,\nterminate() currently clears pendingExpectations without rejecting their\nPromises, causing any callers awaiting expectMessage() to hang; update\nterminate() (in WorkerCommunicator) to iterate over this.pendingExpectations and\ncall reject(new Error('Worker terminated')) for each pending entry (matching how\nonerror rejects expectations), then clear() the map and proceed to terminate the\nworker and clear messageListeners; ensure you reference the expectMessage()\ncontract so the rejection message is meaningful and avoid double-rejecting by\nchecking if an entry has an associated reject function before invoking it.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commit 688c607",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T10:56:45Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937823",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937823"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937823"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937823/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 148,
    "original_start_line": 105,
    "start_side": "RIGHT",
    "line": 154,
    "original_line": 112,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 112,
    "position": 154,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937825",
    "pull_request_review_id": 3783384054,
    "id": 2791937825,
    "node_id": "PRRC_kwDORJ0gd86maZch",
    "diff_hunk": "@@ -1,15 +1,211 @@\n-import { IEngineAdapterMetadata } from \"@multi-game-engines/core\";\n+import {\n+  BaseAdapter,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  ILicenseInfo,\n+  IEngineSourceConfig,\n+  ISearchTask,\n+  UCIParser,\n+  WorkerCommunicator,\n+  IEngineLoader,\n+  EngineError,\n+} from \"@multi-game-engines/core\";\n \n-export const stockfishMetadata: IEngineAdapterMetadata = {\n-  id: \"stockfish\",\n-  name: \"Stockfish via WASM\",\n-  version: \"16.1\",\n-  engineLicense: {\n+/**\n+ * Stockfish (WASM) ç”¨ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å®Ÿè£…ã€‚\n+ * \n+ * EngineLoader ã‚’ä»‹ã—ã¦ CDN (jsDelivr ç­‰) ã‹ã‚‰ WASM ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å–å¾—ã—ã€\n+ * WebWorker å†…ã§å®Ÿè¡Œã€UCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§é€šä¿¡ã‚’è¡Œã„ã¾ã™ã€‚\n+ */\n+export class StockfishAdapter extends BaseAdapter<\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult\n+> {\n+  readonly id = \"stockfish\";\n+  readonly name = \"Stockfish via WASM\";\n+  readonly version = \"16.1\";\n+\n+  readonly engineLicense: ILicenseInfo = {\n     name: \"GPL-3.0-only\",\n     url: \"https://stockfishchess.org/\",\n-  },\n-  adapterLicense: {\n+  };\n+\n+  readonly adapterLicense: ILicenseInfo = {\n     name: \"MIT\",\n     url: \"https://opensource.org/licenses/MIT\",\n-  },\n-};\n+  };\n+\n+  /** ã‚¨ãƒ³ã‚¸ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šã€‚Stage 1 ã§ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ CDN ã‚’å‚ç…§ã—ã¾ã™ã€‚ */\n+  readonly sources: Record<string, IEngineSourceConfig> = {\n+    main: {\n+      url: \"https://cdn.jsdelivr.net/npm/stockfish@16.1.0/src/stockfish.js\",\n+      // å®Ÿé‹ç”¨æ™‚ã«ã¯æ­£ç¢ºãªãƒãƒƒã‚·ãƒ¥å€¤ã‚’æŒ‡å®šã—ã¦æ”¹ç«„ã‚’é˜²æ­¢ã—ã¾ã™ã€‚\n+      sri: \"\", ",
    "path": "packages/adapter-stockfish/src/stockfish.ts",
    "commit_id": "590c674c4e6aa548c57e4eb5a3322e2561f6057d",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "gemini-code-assist[bot]",
      "id": 176961590,
      "node_id": "BOT_kgDOCow4Ng",
      "avatar_url": "https://avatars.githubusercontent.com/in/956858?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D",
      "html_url": "https://github.com/apps/gemini-code-assist",
      "followers_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "![security-medium](https://www.gstatic.com/codereviewagent/security-medium-priority.svg) ![medium](https://www.gstatic.com/codereviewagent/medium-priority.svg)\n\nThe `sri` property is set to an empty string `\"\"`. This disables Subresource Integrity (SRI) verification when `EngineLoader` fetches resources from a public CDN, violating the project's technical specification (TECHNICAL_SPECS.md section 1.3) and the repository's \"security first\" principle. If the CDN is compromised, a malicious script could be served to users without detection. Please provide a valid SRI hash for the `stockfish@16.1.0/src/stockfish.js` script in the `sources` configuration to ensure resource integrity.\n\n<details>\n<summary>References</summary>\n\n1. The repository's style guide emphasizes a 'security first' principle, which is violated by disabling SRI. <sup>([link](https://github.com/hdkz-dev/multi-game-engines/blob/main/.gemini/styleguide.md))</sup>\n2. The project's technical specification (TECHNICAL_SPECS.md section 1.3) mandates SRI for external resources to prevent tampering.\n</details>",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:12Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937825",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937825"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937825"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937825/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 45,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 55,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937829",
    "pull_request_review_id": 3783384054,
    "id": 2791937829,
    "node_id": "PRRC_kwDORJ0gd86maZcl",
    "diff_hunk": "@@ -0,0 +1,94 @@\n+import {\n+  IProtocolParser,\n+} from \"./types\";\n+import {\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  Move,\n+} from \"../types\";\n+\n+/**\n+ * æ±ç”¨çš„ãª UCI (Universal Chess Interface) ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ‘ãƒ¼ã‚µãƒ¼ã€‚\n+ * Stockfish ãªã©ã®ãƒã‚§ã‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã€ãŠã‚ˆã³æ´¾ç”Ÿãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®åŸºåº•ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚\n+ */\n+export class UCIParser implements IProtocolParser<IBaseSearchOptions, IBaseSearchInfo, IBaseSearchResult> {\n+  /**\n+   * \"info depth 10 score cp 50 pv e2e4 ...\" å½¢å¼ã®è¡Œã‚’è§£æã—ã¾ã™ã€‚\n+   */\n+  parseInfo(line: string): IBaseSearchInfo | null {\n+    if (!line.startsWith(\"info \")) return null;\n+\n+    const info: IBaseSearchInfo = {\n+      depth: 0,\n+      score: 0,\n+      raw: line,\n+    };\n+\n+    const parts = line.split(\" \");\n+    for (let i = 1; i < parts.length; i++) {\n+      switch (parts[i]) {\n+        case \"depth\":\n+          info.depth = parseInt(parts[++i], 10);\n+          break;\n+        case \"score\": {\n+          const scoreType = parts[++i]; // \"cp\" or \"mate\"\n+          const scoreValue = parseInt(parts[++i], 10);\n+          info.score = scoreType === \"mate\" ? scoreValue * 10000 : scoreValue;\n+          break;\n+        }\n+        case \"nps\":\n+          info.nps = parseInt(parts[++i], 10);\n+          break;\n+        case \"time\":\n+          info.time = parseInt(parts[++i], 10);\n+          break;\n+        case \"pv\":\n+          info.pv = parts.slice(i + 1) as Move[];\n+          i = parts.length; // PV ã¯è¡Œã®æœ€å¾Œã¾ã§ç¶šã\n+          break;\n+      }\n+    }\n+\n+    return info;\n+  }\n+\n+  /**\n+   * \"bestmove e2e4 ponder e7e5\" å½¢å¼ã®è¡Œã‚’è§£æã—ã¾ã™ã€‚\n+   */\n+  parseResult(line: string): IBaseSearchResult | null {\n+    if (!line.startsWith(\"bestmove \")) return null;\n+\n+    const parts = line.split(\" \");\n+    const result: IBaseSearchResult = {\n+      bestMove: parts[1] as Move,\n+      raw: line,\n+    };\n+\n+    const ponderIndex = parts.indexOf(\"ponder\");\n+    if (ponderIndex !== -1 && ponderIndex + 1 < parts.length) {\n+      result.ponder = parts[ponderIndex + 1] as Move;\n+    }\n+\n+    return result;\n+  }\n+\n+  /**\n+   * æ¢ç´¢é–‹å§‹ã‚³ãƒãƒ³ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã™ã€‚\n+   */\n+  createSearchCommand(options: IBaseSearchOptions): string {\n+    let cmd = `position fen ${options.fen}\n+go`;",
    "path": "packages/core/src/protocols/UCIParser.ts",
    "commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "gemini-code-assist[bot]",
      "id": 176961590,
      "node_id": "BOT_kgDOCow4Ng",
      "avatar_url": "https://avatars.githubusercontent.com/in/956858?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D",
      "html_url": "https://github.com/apps/gemini-code-assist",
      "followers_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "![security-medium](https://www.gstatic.com/codereviewagent/security-medium-priority.svg) ![medium](https://www.gstatic.com/codereviewagent/medium-priority.svg)\n\nThe `createSearchCommand` method constructs a UCI command string by directly concatenating the `options.fen` property without any sanitization or validation. Since the UCI protocol uses newlines to separate commands, an attacker can inject arbitrary UCI commands (e.g., `quit`, `setoption`) by including newlines in the FEN string. This could lead to denial of service or unauthorized configuration changes of the engine.\n\nRecommendation: Sanitize the `options.fen` string by removing or escaping newline characters before concatenation.\n\n```suggestion\n    const sanitizedFen = options.fen.replace(/[\\r\\n]/g, \" \");\n    let cmd = `position fen ${sanitizedFen}\ngo`;\n```",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:12Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937829",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937829"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937829"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937829/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 80,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 81,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 81,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937837",
    "pull_request_review_id": 3783384054,
    "id": 2791937837,
    "node_id": "PRRC_kwDORJ0gd86maZct",
    "diff_hunk": "@@ -0,0 +1,94 @@\n+import {\n+  IProtocolParser,\n+} from \"./types\";\n+import {\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  Move,\n+} from \"../types\";\n+\n+/**\n+ * æ±ç”¨çš„ãª UCI (Universal Chess Interface) ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ‘ãƒ¼ã‚µãƒ¼ã€‚\n+ * Stockfish ãªã©ã®ãƒã‚§ã‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã€ãŠã‚ˆã³æ´¾ç”Ÿãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®åŸºåº•ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚\n+ */\n+export class UCIParser implements IProtocolParser<IBaseSearchOptions, IBaseSearchInfo, IBaseSearchResult> {\n+  /**\n+   * \"info depth 10 score cp 50 pv e2e4 ...\" å½¢å¼ã®è¡Œã‚’è§£æã—ã¾ã™ã€‚\n+   */\n+  parseInfo(line: string): IBaseSearchInfo | null {\n+    if (!line.startsWith(\"info \")) return null;\n+\n+    const info: IBaseSearchInfo = {\n+      depth: 0,\n+      score: 0,\n+      raw: line,\n+    };\n+\n+    const parts = line.split(\" \");\n+    for (let i = 1; i < parts.length; i++) {\n+      switch (parts[i]) {\n+        case \"depth\":\n+          info.depth = parseInt(parts[++i], 10);\n+          break;\n+        case \"score\": {\n+          const scoreType = parts[++i]; // \"cp\" or \"mate\"\n+          const scoreValue = parseInt(parts[++i], 10);\n+          info.score = scoreType === \"mate\" ? scoreValue * 10000 : scoreValue;",
    "path": "packages/core/src/protocols/UCIParser.ts",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "947a7ef60e6d98216e0115288c98b00f0fd69380",
    "user": {
      "login": "gemini-code-assist[bot]",
      "id": 176961590,
      "node_id": "BOT_kgDOCow4Ng",
      "avatar_url": "https://avatars.githubusercontent.com/in/956858?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D",
      "html_url": "https://github.com/apps/gemini-code-assist",
      "followers_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gemini-code-assist%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "![medium](https://www.gstatic.com/codereviewagent/medium-priority.svg)\n\n`mate` ã‚¹ã‚³ã‚¢ã‚’ `10000` ã¨ã„ã†ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã‚’æ›ã‘ã¦è¡¨ç¾ã—ã¦ã„ã¾ã™ãŒã€ã“ã‚Œã¯å¯èª­æ€§ã‚’ä½ä¸‹ã•ã›ã€å°†æ¥çš„ã«æ„å›³ãŒåˆ†ã‹ã‚Šã«ãããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\nã“ã®ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã‚’ã€æ„å›³ãŒæ˜ç¢ºã«ã‚ã‹ã‚‹åå‰ä»˜ãå®šæ•°ï¼ˆä¾‹: `MATE_SCORE_FLAG`ï¼‰ã¨ã—ã¦æŠ½å‡ºã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ‰ã®è‡ªå·±æ–‡æ›¸åŒ–ãŒä¿ƒé€²ã•ã‚Œã€ä¿å®ˆæ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚\n\n```suggestion\n          const MATE_SCORE_FLAG = 10000;\n          info.score = scoreType === \"mate\" ? scoreValue * MATE_SCORE_FLAG : scoreValue;\n```",
    "created_at": "2026-02-11T08:11:12Z",
    "updated_at": "2026-02-11T08:11:12Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937837",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937837"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2791937837"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2791937837/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 40,
    "original_line": 37,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 37,
    "position": 40,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792567553",
    "pull_request_review_id": 3784043436,
    "id": 2792567553,
    "node_id": "PRRC_kwDORJ0gd86mczMB",
    "diff_hunk": "@@ -0,0 +1,116 @@\n+import { EngineError } from \"../errors/EngineError\";\n+import { EngineErrorCode } from \"../types\";\n+\n+/**\n+ * WebWorker ã¨ã®ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼é€šä¿¡ã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹ã€‚\n+ * \n+ * ä¸»ãªæ©Ÿèƒ½:\n+ * - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€å—ä¿¡ (postMessage)\n+ * - ç‰¹å®šã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¾…æ©Ÿã™ã‚‹ Promise ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (expectMessage)\n+ * - Worker å†…éƒ¨ã‚¨ãƒ©ãƒ¼ã®æ¤œçŸ¥ã¨ã€å¾…æ©Ÿä¸­ã® Promise ã¸ã®ä¾‹å¤–ä¼æ’­\n+ */\n+export class WorkerCommunicator {\n+  private worker: Worker | null = null;\n+  /** ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡æ™‚ã®å…¨ãƒªã‚¹ãƒŠãƒ¼ */\n+  private messageListeners = new Set<(data: unknown) => void>();\n+  /** \n+   * expectMessage ã§å¾…æ©Ÿä¸­ã®ãƒ—ãƒ­ãƒŸã‚¹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ã‚»ãƒƒãƒˆã€‚\n+   * ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã«ä¸€æ‹¬ã§ reject ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã€‚\n+   */\n+  private pendingExpectations = new Set<{\n+    predicate: (data: unknown) => boolean;\n+    /** \n+     * å¤–éƒ¨ã‹ã‚‰æŒ‡å®šã•ã‚ŒãŸä»»æ„ã®å‹ T ã¸å®‰å…¨ã«å¤‰æ›ã™ã‚‹ãŸã‚ã€\n+     * Promise è§£æ±ºç”¨ã¨ã—ã¦æ„å›³çš„ã« any ã‚’ä½¿ç”¨ã€‚\n+     */\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    resolve: (data: any) => void;\n+    reject: (reason: Error) => void;\n+  }>();\n+\n+  constructor(private readonly workerUrl: string) {}\n+\n+  /**\n+   * Worker ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’é–‹å§‹ã—ã¾ã™ã€‚\n+   */\n+  async spawn(): Promise<void> {\n+    if (this.worker) return;\n+\n+    this.worker = new Worker(this.workerUrl);\n+    \n+    // æ­£å¸¸ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å—ä¿¡\n+    this.worker.onmessage = (e: MessageEvent) => {\n+      // 1. ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªã‚¹ãƒŠãƒ¼ã¸ã®é€šçŸ¥\n+      this.messageListeners.forEach((listener) => listener(e.data));\n+\n+      // 2. å¾…æ©Ÿä¸­ã® expectMessage ãƒ—ãƒ­ãƒŸã‚¹ã®è§£æ±ºãƒã‚§ãƒƒã‚¯\n+      for (const exp of this.pendingExpectations) {\n+        if (exp.predicate(e.data)) {\n+          this.pendingExpectations.delete(exp);\n+          exp.resolve(e.data);\n+        }\n+      }",
    "path": "packages/core/src/workers/WorkerCommunicator.ts",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "7d1a9d5892799174d6afeab161b3144967941d4c",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**å˜ä¸€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§è¤‡æ•°ã® pending expectation ãŒ resolve ã•ã‚Œã‚‹å¯èƒ½æ€§**\n\n`for...of` ãƒ«ãƒ¼ãƒ—å†…ã§ `break` ãŒãªã„ãŸã‚ã€1ã¤ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¤‡æ•°ã® `expectMessage` ã® predicate ã«ãƒãƒƒãƒã—ãŸå ´åˆã€ã™ã¹ã¦ãŒåŒã˜ãƒ‡ãƒ¼ã‚¿ã§ resolve ã•ã‚Œã¾ã™ã€‚UCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ã‚ˆã†ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ-ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯ã€é€šå¸¸1ã¤ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯1ã¤ã®å¾…æ©Ÿã«ã®ã¿å¯¾å¿œã™ã‚‹ãŸã‚ã€æœ€åˆã®ãƒãƒƒãƒå¾Œã« `break` ã™ã¹ãã§ã™ã€‚\n\nã¾ãŸã€`predicate` ãŒä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã—ãŸå ´åˆã€`onmessage` ãƒãƒ³ãƒ‰ãƒ©å…¨ä½“ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã€æ®‹ã‚Šã® expectation ãŒè©•ä¾¡ã•ã‚Œã¾ã›ã‚“ã€‚\n\n<details>\n<summary>ğŸ› ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n       for (const exp of this.pendingExpectations) {\n-        if (exp.predicate(e.data)) {\n-          this.pendingExpectations.delete(exp);\n-          exp.resolve(e.data);\n+        try {\n+          if (exp.predicate(e.data)) {\n+            this.pendingExpectations.delete(exp);\n+            exp.resolve(e.data);\n+            break;\n+          }\n+        } catch {\n+          // predicate ã®ä¾‹å¤–ã¯ç„¡è¦–ã—ã¦æ¬¡ã® expectation ã‚’è©•ä¾¡\n         }\n```\n</details>\n\n<!-- suggestion_start -->\n\n<details>\n<summary>ğŸ“ Committable suggestion</summary>\n\n> â€¼ï¸ **IMPORTANT**\n> Carefully review the code before committing. Ensure that it accurately replaces the highlighted code, contains no missing lines, and has no issues with indentation. Thoroughly test & benchmark the code to ensure it meets the requirements.\n\n```suggestion\n      for (const exp of this.pendingExpectations) {\n        try {\n          if (exp.predicate(e.data)) {\n            this.pendingExpectations.delete(exp);\n            exp.resolve(e.data);\n            break;\n          }\n        } catch {\n          // predicate ã®ä¾‹å¤–ã¯ç„¡è¦–ã—ã¦æ¬¡ã® expectation ã‚’è©•ä¾¡\n        }\n      }\n```\n\n</details>\n\n<!-- suggestion_end -->\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/workers/WorkerCommunicator.ts` around lines 47 - 52, When\nprocessing incoming messages in the onmessage handler, a single message can\ncurrently resolve multiple pending expectations because the loop over\npendingExpectations doesn't stop after the first match; update the logic in\nWorkerCommunicator.ts so that after finding and handling the first matching\nexpectation (the one where exp.predicate(e.data) is true), you delete it and\ncall exp.resolve(e.data) then break out of the loop to avoid resolving others;\nadditionally wrap the call to exp.predicate(e.data) in a try/catch so a thrown\nexception from predicate doesn't crash the handler and instead skips that\nexpectation (optionally logging the error) â€” look for the pendingExpectations\ncollection, the expectMessage usage, and the exp.predicate/exp.resolve calls to\napply the change.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commit 688c607",
    "created_at": "2026-02-11T10:41:35Z",
    "updated_at": "2026-02-11T10:56:43Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792567553",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792567553"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792567553"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792567553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 50,
    "original_start_line": 47,
    "start_side": "RIGHT",
    "line": 61,
    "original_line": 52,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 52,
    "position": 61,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792567573",
    "pull_request_review_id": 3784043436,
    "id": 2792567573,
    "node_id": "PRRC_kwDORJ0gd86mczMV",
    "diff_hunk": "@@ -0,0 +1,116 @@\n+import { EngineError } from \"../errors/EngineError\";\n+import { EngineErrorCode } from \"../types\";\n+\n+/**\n+ * WebWorker ã¨ã®ä½ãƒ¬ã‚¤ãƒ¤ãƒ¼é€šä¿¡ã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹ã€‚\n+ * \n+ * ä¸»ãªæ©Ÿèƒ½:\n+ * - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€å—ä¿¡ (postMessage)\n+ * - ç‰¹å®šã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¾…æ©Ÿã™ã‚‹ Promise ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (expectMessage)\n+ * - Worker å†…éƒ¨ã‚¨ãƒ©ãƒ¼ã®æ¤œçŸ¥ã¨ã€å¾…æ©Ÿä¸­ã® Promise ã¸ã®ä¾‹å¤–ä¼æ’­\n+ */\n+export class WorkerCommunicator {\n+  private worker: Worker | null = null;\n+  /** ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡æ™‚ã®å…¨ãƒªã‚¹ãƒŠãƒ¼ */\n+  private messageListeners = new Set<(data: unknown) => void>();\n+  /** \n+   * expectMessage ã§å¾…æ©Ÿä¸­ã®ãƒ—ãƒ­ãƒŸã‚¹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ã‚»ãƒƒãƒˆã€‚\n+   * ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã«ä¸€æ‹¬ã§ reject ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã€‚\n+   */\n+  private pendingExpectations = new Set<{\n+    predicate: (data: unknown) => boolean;\n+    /** \n+     * å¤–éƒ¨ã‹ã‚‰æŒ‡å®šã•ã‚ŒãŸä»»æ„ã®å‹ T ã¸å®‰å…¨ã«å¤‰æ›ã™ã‚‹ãŸã‚ã€\n+     * Promise è§£æ±ºç”¨ã¨ã—ã¦æ„å›³çš„ã« any ã‚’ä½¿ç”¨ã€‚\n+     */\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    resolve: (data: any) => void;\n+    reject: (reason: Error) => void;\n+  }>();\n+\n+  constructor(private readonly workerUrl: string) {}\n+\n+  /**\n+   * Worker ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’é–‹å§‹ã—ã¾ã™ã€‚\n+   */\n+  async spawn(): Promise<void> {\n+    if (this.worker) return;\n+\n+    this.worker = new Worker(this.workerUrl);\n+    \n+    // æ­£å¸¸ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å—ä¿¡\n+    this.worker.onmessage = (e: MessageEvent) => {\n+      // 1. ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªã‚¹ãƒŠãƒ¼ã¸ã®é€šçŸ¥\n+      this.messageListeners.forEach((listener) => listener(e.data));\n+\n+      // 2. å¾…æ©Ÿä¸­ã® expectMessage ãƒ—ãƒ­ãƒŸã‚¹ã®è§£æ±ºãƒã‚§ãƒƒã‚¯\n+      for (const exp of this.pendingExpectations) {\n+        if (exp.predicate(e.data)) {\n+          this.pendingExpectations.delete(exp);\n+          exp.resolve(e.data);\n+        }\n+      }\n+    };\n+\n+    // Worker å†…éƒ¨ã§ã®ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚\n+    this.worker.onerror = (e: ErrorEvent) => {\n+      const error = new EngineError(\n+        EngineErrorCode.INTERNAL_ERROR,\n+        `Worker error: ${e.message}`\n+      );\n+      \n+      // å¾…æ©Ÿä¸­ã®å…¨ã¦ã® Promise ã‚’ç•°å¸¸çµ‚äº†ã•ã›ã‚‹ (ãƒãƒ³ã‚°ã‚¢ãƒƒãƒ—é˜²æ­¢)\n+      this.pendingExpectations.forEach((exp) => exp.reject(error));\n+      this.pendingExpectations.clear();\n+      \n+      console.error(\"WorkerCommunicator Error:\", e);\n+    };\n+  }\n+\n+  /**\n+   * Worker ã¸ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã™ã€‚\n+   * \n+   * @param message é€ä¿¡ãƒ‡ãƒ¼ã‚¿ (æ–‡å­—åˆ—ã€ãƒã‚¤ãƒŠãƒªã€ã¾ãŸã¯ UCI ã‚³ãƒãƒ³ãƒ‰)\n+   * @param transfer ã‚¼ãƒ­ã‚³ãƒ”ãƒ¼è»¢é€ã‚’è¡Œã† ArrayBuffer ç­‰ã®ãƒªã‚¹ãƒˆ\n+   */\n+  postMessage(message: string | Uint8Array | object, transfer?: Transferable[]): void {\n+    if (!this.worker) {\n+      throw new EngineError(EngineErrorCode.INTERNAL_ERROR, \"Worker has not been spawned yet.\");\n+    }\n+    this.worker.postMessage(message, transfer || []);\n+  }\n+\n+  /**\n+   * æ¡ä»¶ã«åˆè‡´ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ Worker ã‹ã‚‰å±Šãã¾ã§éåŒæœŸã§å¾…æ©Ÿã—ã¾ã™ã€‚\n+   * \n+   * @param predicate å—ä¿¡ãƒ‡ãƒ¼ã‚¿ãŒæœŸå¾…ã™ã‚‹ã‚‚ã®ã‹åˆ¤å®šã™ã‚‹é–¢æ•°\n+   * @returns æœŸå¾…ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå±Šã„ãŸæ™‚ã«è§£æ±ºã•ã‚Œã‚‹ Promise\n+   */\n+  expectMessage<T>(predicate: (data: unknown) => boolean): Promise<T> {\n+    return new Promise((resolve, reject) => {\n+      this.pendingExpectations.add({ predicate, resolve, reject });\n+    });\n+  }",
    "path": "packages/core/src/workers/WorkerCommunicator.ts",
    "commit_id": "eb3e6cfc484b5428c3df1792e3be9013adbfc5be",
    "original_commit_id": "7d1a9d5892799174d6afeab161b3144967941d4c",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_ğŸ› ï¸ Refactor suggestion_ | _ğŸŸ  Major_\n\n**`expectMessage` ã«ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã¨ `AbortSignal` ã®ã‚µãƒãƒ¼ãƒˆãŒãªã„**\n\n`expectMessage` ã¯æ¡ä»¶ã«åˆè‡´ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šã‹ãªã„é™ã‚Šæ°¸ä¹…ã«ãƒãƒ³ã‚°ã—ã¾ã™ã€‚ã‚¨ãƒ³ã‚¸ãƒ³ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¦ã‚‚ `onerror` ãŒç™ºç«ã—ãªã„ã‚±ãƒ¼ã‚¹ï¼ˆä¾‹: Worker å†…ã§ç„¡é™ãƒ«ãƒ¼ãƒ—ï¼‰ã§ã¯ã€Promise ãŒè§£æ±ºã•ã‚Œã¾ã›ã‚“ã€‚\n\nã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã¯ `AbortSignal` ã®å„ªå…ˆæ¡ç”¨ãŒæ±‚ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚`options` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ `timeoutMs` ã‚„ `signal: AbortSignal` ã‚’å—ã‘ä»˜ã‘ã€ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½ã«ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚\n\n<details>\n<summary>â™»ï¸ ä¿®æ­£æ¡ˆï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ + AbortSignalï¼‰</summary>\n\n```diff\n- expectMessage<T>(predicate: (data: unknown) => boolean): Promise<T> {\n-   return new Promise((resolve, reject) => {\n-     this.pendingExpectations.add({ predicate, resolve, reject });\n-   });\n+ expectMessage<T>(\n+   predicate: (data: unknown) => boolean,\n+   options?: { timeoutMs?: number; signal?: AbortSignal }\n+ ): Promise<T> {\n+   const { timeoutMs, signal } = options ?? {};\n+   return new Promise<T>((resolve, reject) => {\n+     const entry = { predicate, resolve: resolve as (data: unknown) => void, reject };\n+     this.pendingExpectations.add(entry);\n+\n+     if (timeoutMs !== undefined) {\n+       setTimeout(() => {\n+         if (this.pendingExpectations.delete(entry)) {\n+           reject(new EngineError(EngineErrorCode.INTERNAL_ERROR, \"expectMessage timed out.\"));\n+         }\n+       }, timeoutMs);\n+     }\n+\n+     if (signal) {\n+       signal.addEventListener(\"abort\", () => {\n+         if (this.pendingExpectations.delete(entry)) {\n+           reject(new EngineError(EngineErrorCode.INTERNAL_ERROR, \"expectMessage aborted.\"));\n+         }\n+       }, { once: true });\n+     }\n+   });\n  }\n```\n</details>\n\nAs per coding guidelines, ã€Œæœ€æ–° Web æ¨™æº–ã®æ¡ç”¨å„ªå…ˆ: ... AbortSignal ... ã‚’æœ€å„ªå…ˆã§æ¡ç”¨ã™ã‚‹ã“ã¨ã€ã€‚\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/workers/WorkerCommunicator.ts` around lines 89 - 93, The\nexpectMessage method currently blocks indefinitely; modify expectMessage<T> to\naccept an optional options object (e.g., { timeoutMs?: number, signal?:\nAbortSignal }) and make it cancelable: create the Promise as before but register\na timeout timer when timeoutMs is provided and attach a signal.aborted listener\nwhen signal is provided (treat AbortSignal as higher priority), ensure both the\ntimer and listener remove the pending expectation from this.pendingExpectations\nand reject the Promise with an appropriate AbortError/TimeoutError; on\nsuccessful resolve (predicate match) clear the timer, remove the abort listener,\nand remove the expectation; also guard against double-settling so resolve/reject\nonly once.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->\n\nâœ… Addressed in commit 688c607",
    "created_at": "2026-02-11T10:41:35Z",
    "updated_at": "2026-02-11T10:56:40Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792567573",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792567573"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792567573"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792567573/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 89,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 93,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 93,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975290",
    "pull_request_review_id": 3784460554,
    "id": 2792975290,
    "node_id": "PRRC_kwDORJ0gd86meWu6",
    "diff_hunk": "@@ -0,0 +1,59 @@\n+name: CI\n+\n+on:\n+  push:\n+    branches: [ main ]\n+  pull_request:\n+    branches: [ main ]\n+\n+jobs:\n+  build-and-test:\n+    runs-on: ubuntu-latest\n+\n+    strategy:\n+      matrix:\n+        node-version: [22.x]\n+\n+    steps:\n+    - uses: actions/checkout@v4\n+\n+    - name: Use Node.js ${{ matrix.node-version }}\n+      uses: actions/setup-node@v4\n+      with:\n+        node-version: ${{ matrix.node-version }}\n+\n+    - name: Install pnpm\n+      uses: pnpm/action-setup@v4\n+      with:\n+        version: 10\n+\n+    - name: Get pnpm store directory\n+      shell: bash\n+      run: |\n+        echo \"STORE_PATH=$(pnpm store path --silent)\" >> $GITHUB_ENV\n+\n+    - uses: actions/cache@v4\n+      name: Setup pnpm cache\n+      with:\n+        path: ${{ env.STORE_PATH }}\n+        key: ${{ runner.os }}-pnpm-store-${{ hashFiles('**/pnpm-lock.yaml') }}\n+        restore-keys: |\n+          ${{ runner.os }}-pnpm-store-\n+\n+    - name: Install dependencies\n+      run: pnpm install",
    "path": ".github/workflows/ci.yml",
    "commit_id": "b83cd1cc903f37506f986ad6fb2feec970ae7f02",
    "original_commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_ğŸ› ï¸ Refactor suggestion_ | _ğŸŸ  Major_\n\n**CI ã§ã¯ `pnpm install --frozen-lockfile` ã‚’ä½¿ç”¨ã™ã¹ãã§ã™ã€‚**\n\nCI ç’°å¢ƒã§ `--frozen-lockfile` ã‚’ä»˜ã‘ãªã„ã¨ã€`pnpm-lock.yaml` ã¨ `package.json` ã®ä¸æ•´åˆæ™‚ã«ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ãŒæš—é»™çš„ã«æ›´æ–°ã•ã‚Œã€å†ç¾ä¸å¯èƒ½ãªãƒ“ãƒ«ãƒ‰ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\n\n\n<details>\n<summary>ğŸ”§ ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n     - name: Install dependencies\n-      run: pnpm install\n+      run: pnpm install --frozen-lockfile\n```\n</details>\n\n<!-- suggestion_start -->\n\n<details>\n<summary>ğŸ“ Committable suggestion</summary>\n\n> â€¼ï¸ **IMPORTANT**\n> Carefully review the code before committing. Ensure that it accurately replaces the highlighted code, contains no missing lines, and has no issues with indentation. Thoroughly test & benchmark the code to ensure it meets the requirements.\n\n```suggestion\n    - name: Install dependencies\n      run: pnpm install --frozen-lockfile\n```\n\n</details>\n\n<!-- suggestion_end -->\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn @.github/workflows/ci.yml around lines 43 - 44, CI step \"Install\ndependencies\" currently runs \"pnpm install\" which can implicitly update\npnpm-lock.yaml; change the run command in that step (the Install dependencies\nstep) to use \"pnpm install --frozen-lockfile\" so the workflow fails if\npackage.json and pnpm-lock.yaml mismatch and prevents non-reproducible builds.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T12:18:29Z",
    "updated_at": "2026-02-11T12:18:32Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975290",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975290"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975290"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975290/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 43,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 44,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 44,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975304",
    "pull_request_review_id": 3784460554,
    "id": 2792975304,
    "node_id": "PRRC_kwDORJ0gd86meWvI",
    "diff_hunk": "@@ -1,15 +1,249 @@\n-import { IEngineAdapterMetadata } from \"@multi-game-engines/core\";\n+import {\n+  BaseAdapter,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  ILicenseInfo,\n+  IEngineSourceConfig,\n+  ISearchTask,\n+  UCIParser,\n+  WorkerCommunicator,\n+  IEngineLoader,\n+  EngineError,\n+  EngineErrorCode,\n+} from \"@multi-game-engines/core\";\n \n-export const stockfishMetadata: IEngineAdapterMetadata = {\n-  id: \"stockfish\",\n-  name: \"Stockfish via WASM\",\n-  version: \"16.1\",\n-  engineLicense: {\n+/**\n+ * Stockfish (WASM) ç”¨ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å®Ÿè£…ã€‚\n+ * \n+ * EngineLoader ã‚’ä»‹ã—ã¦ CDN (jsDelivr ç­‰) ã‹ã‚‰ WASM ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å–å¾—ã—ã€\n+ * WebWorker å†…ã§å®Ÿè¡Œã€UCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§é€šä¿¡ã‚’è¡Œã„ã¾ã™ã€‚\n+ */\n+export class StockfishAdapter extends BaseAdapter<\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult\n+> {\n+  readonly id = \"stockfish\";\n+  readonly name = \"Stockfish via WASM\";\n+  readonly version = \"16.1\";\n+\n+  readonly engineLicense: ILicenseInfo = {\n     name: \"GPL-3.0-only\",\n     url: \"https://stockfishchess.org/\",\n-  },\n-  adapterLicense: {\n+  };\n+\n+  readonly adapterLicense: ILicenseInfo = {\n     name: \"MIT\",\n     url: \"https://opensource.org/licenses/MIT\",\n-  },\n-};\n+  };\n+\n+  /** \n+   * ã‚¨ãƒ³ã‚¸ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šã€‚\n+   * TODO: æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒãƒƒã‚·ãƒ¥ã¨ã‚µã‚¤ã‚ºã‚’è‡ªå‹•ç”Ÿæˆã—ã¦åŸ‹ã‚è¾¼ã¿ã€æ”¹ç«„ã‚’é˜²æ­¢ã™ã‚‹ã“ã¨ã€‚\n+   * (Stage 1 ã§ã¯ç©ºæ–‡å­—åˆ—ã‚’è¨±å®¹ã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™)\n+   */\n+  readonly sources: Record<string, IEngineSourceConfig> = {\n+    main: {\n+      url: \"https://cdn.jsdelivr.net/npm/stockfish@16.1.0/src/stockfish.js\",\n+      sri: \"\", \n+      size: 0, \n+      type: \"worker-js\",\n+    },\n+  };\n+\n+  readonly parser = new UCIParser();\n+  private communicator: WorkerCommunicator | null = null;\n+  private pendingResolve: ((result: IBaseSearchResult) => void) | null = null;\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private pendingReject: ((reason?: any) => void) | null = null;",
    "path": "packages/adapter-stockfish/src/stockfish.ts",
    "commit_id": "b83cd1cc903f37506f986ad6fb2feec970ae7f02",
    "original_commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_ğŸ› ï¸ Refactor suggestion_ | _ğŸŸ  Major_\n\n**`any` ã®ä½¿ç”¨ã¯ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«é•åã—ã¦ã„ã¾ã™**\n\n`pendingReject` ã®å‹ã§ `any` ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ãŒã€ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã¯ `unknown` ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†æ±‚ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚`Promise` ã® reject ã¯ `unknown` ã§å‹ä»˜ã‘å¯èƒ½ã§ã™ã€‚\n\n<details>\n<summary>â™»ï¸ ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n-  // eslint-disable-next-line `@typescript-eslint/no-explicit-any`\n-  private pendingReject: ((reason?: any) => void) | null = null;\n+  private pendingReject: ((reason?: unknown) => void) | null = null;\n```\n</details>\n\nAs per coding guidelines: ã€Œç¦æ­¢: `any` ã®ä½¿ç”¨ã€‚ä»£ã‚ã‚Šã« `unknown` ã¨å‹ã‚¬ãƒ¼ãƒ‰ã€ã¾ãŸã¯å¢ƒç•Œä»˜ãã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€\n\n<!-- suggestion_start -->\n\n<details>\n<summary>ğŸ“ Committable suggestion</summary>\n\n> â€¼ï¸ **IMPORTANT**\n> Carefully review the code before committing. Ensure that it accurately replaces the highlighted code, contains no missing lines, and has no issues with indentation. Thoroughly test & benchmark the code to ensure it meets the requirements.\n\n```suggestion\n  private pendingReject: ((reason?: unknown) => void) | null = null;\n```\n\n</details>\n\n<!-- suggestion_end -->\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/adapter-stockfish/src/stockfish.ts` around lines 58 - 59, Replace\nthe explicit any on pendingReject with unknown to comply with the guideline:\nchange the type of the field pendingReject from ((reason?: any) => void) | null\nto ((reason?: unknown) => void) | null (and remove the now-unnecessary\neslint-disable comment); if any callers inspect or handle the rejection reason,\nadd appropriate type guards or casts where they access the rejected value.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T12:18:30Z",
    "updated_at": "2026-02-11T12:18:32Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975304",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975304"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975304"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975304/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 58,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 59,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 69,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975313",
    "pull_request_review_id": 3784460554,
    "id": 2792975313,
    "node_id": "PRRC_kwDORJ0gd86meWvR",
    "diff_hunk": "@@ -1,15 +1,249 @@\n-import { IEngineAdapterMetadata } from \"@multi-game-engines/core\";\n+import {\n+  BaseAdapter,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  ILicenseInfo,\n+  IEngineSourceConfig,\n+  ISearchTask,\n+  UCIParser,\n+  WorkerCommunicator,\n+  IEngineLoader,\n+  EngineError,\n+  EngineErrorCode,\n+} from \"@multi-game-engines/core\";\n \n-export const stockfishMetadata: IEngineAdapterMetadata = {\n-  id: \"stockfish\",\n-  name: \"Stockfish via WASM\",\n-  version: \"16.1\",\n-  engineLicense: {\n+/**\n+ * Stockfish (WASM) ç”¨ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å®Ÿè£…ã€‚\n+ * \n+ * EngineLoader ã‚’ä»‹ã—ã¦ CDN (jsDelivr ç­‰) ã‹ã‚‰ WASM ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å–å¾—ã—ã€\n+ * WebWorker å†…ã§å®Ÿè¡Œã€UCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§é€šä¿¡ã‚’è¡Œã„ã¾ã™ã€‚\n+ */\n+export class StockfishAdapter extends BaseAdapter<\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult\n+> {\n+  readonly id = \"stockfish\";\n+  readonly name = \"Stockfish via WASM\";\n+  readonly version = \"16.1\";\n+\n+  readonly engineLicense: ILicenseInfo = {\n     name: \"GPL-3.0-only\",\n     url: \"https://stockfishchess.org/\",\n-  },\n-  adapterLicense: {\n+  };\n+\n+  readonly adapterLicense: ILicenseInfo = {\n     name: \"MIT\",\n     url: \"https://opensource.org/licenses/MIT\",\n-  },\n-};\n+  };\n+\n+  /** \n+   * ã‚¨ãƒ³ã‚¸ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šã€‚\n+   * TODO: æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒãƒƒã‚·ãƒ¥ã¨ã‚µã‚¤ã‚ºã‚’è‡ªå‹•ç”Ÿæˆã—ã¦åŸ‹ã‚è¾¼ã¿ã€æ”¹ç«„ã‚’é˜²æ­¢ã™ã‚‹ã“ã¨ã€‚\n+   * (Stage 1 ã§ã¯ç©ºæ–‡å­—åˆ—ã‚’è¨±å®¹ã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™)\n+   */\n+  readonly sources: Record<string, IEngineSourceConfig> = {\n+    main: {\n+      url: \"https://cdn.jsdelivr.net/npm/stockfish@16.1.0/src/stockfish.js\",\n+      sri: \"\", \n+      size: 0, \n+      type: \"worker-js\",\n+    },\n+  };\n+\n+  readonly parser = new UCIParser();\n+  private communicator: WorkerCommunicator | null = null;\n+  private pendingResolve: ((result: IBaseSearchResult) => void) | null = null;\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private pendingReject: ((reason?: any) => void) | null = null;\n+  private infoController: ReadableStreamDefaultController<IBaseSearchInfo> | null = null;\n+  private blobUrl: string | null = null;\n+  private activeLoader: IEngineLoader | null = null;\n+\n+  /**\n+   * ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€æº–å‚™å®Œäº†çŠ¶æ…‹ã«ã—ã¾ã™ã€‚\n+   */\n+  async load(loader?: IEngineLoader): Promise<void> {\n+    if (this._status === \"ready\") return;\n+\n+    const startTime = Date.now();\n+    this.emitStatusChange(\"loading\");\n+    this.activeLoader = loader || null;\n+\n+    try {\n+      let workerUrl = this.sources.main.url;\n+\n+      // ãƒ–ãƒªãƒƒã‚¸ã‹ã‚‰ãƒ­ãƒ¼ãƒ€ãƒ¼ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€SRIæ¤œè¨¼ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åˆ©ç”¨ã™ã‚‹\n+      if (loader) {\n+        this.emitProgress({ \n+          phase: \"downloading\", \n+          percentage: 10, \n+          i18n: { key: \"loading_resource\", defaultMessage: \"Loading engine resource...\" } \n+        });\n+        this.blobUrl = await loader.loadResource(this.id, this.sources.main);\n+        workerUrl = this.blobUrl;\n+      }\n+\n+      // WebWorker ã‚’èµ·å‹•ã—ã€é€šä¿¡è·¯ã‚’ç¢ºç«‹\n+      this.communicator = new WorkerCommunicator(workerUrl);\n+      await this.communicator.spawn();\n+      this.communicator.onMessage((data) => this.handleMessage(data));\n+\n+      // ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆUCIï¼‰åˆæœŸåŒ–\n+      this.communicator.postMessage(\"uci\");\n+      \n+      // 'uciok' ãŒè¿”ã‚‹ã®ã‚’å¾…ã¤ï¼ˆæœ€å¤§10ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼‰\n+      // AbortController ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚ã« expectMessage ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹\n+      const ac = new AbortController();\n+      const timeoutId = setTimeout(() => ac.abort(), 10000);\n+\n+      try {\n+        await this.communicator.expectMessage<string>(\n+          (data) => data === \"uciok\", \n+          { signal: ac.signal }\n+        );\n+      } catch (e) {\n+        if (ac.signal.aborted) {\n+          throw new EngineError(EngineErrorCode.SEARCH_TIMEOUT, \"UCI initialization timed out\");\n+        }\n+        throw e;\n+      } finally {\n+        clearTimeout(timeoutId);\n+      }\n+\n+      this.emitStatusChange(\"ready\");\n+      this.emitProgress({ \n+        phase: \"ready\", \n+        percentage: 100, \n+        i18n: { key: \"ready\", defaultMessage: \"Ready\" } \n+      });\n+      \n+      // çµ±è¨ˆæƒ…å ±ã®åé›†\n+      this.emitTelemetry({\n+        event: \"load_complete\",\n+        timestamp: Date.now(),\n+        attributes: { load_time_ms: Date.now() - startTime, cached: !!this.blobUrl }\n+      });\n+    } catch (error) {\n+      this.emitStatusChange(\"error\");\n+      \n+      // é€”ä¸­ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸå ´åˆã€Blob URL ãŒãƒªãƒ¼ã‚¯ã—ãªã„ã‚ˆã†ã«ç¢ºå®Ÿã«è§£æ”¾ã™ã‚‹\n+      if (this.blobUrl && loader) {\n+        loader.revoke(this.blobUrl);\n+        this.blobUrl = null;\n+      }\n+\n+      throw EngineError.from(error, this.id);\n+    }\n+  }\n+\n+  /**\n+   * æœªåŠ å·¥ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ¢ç´¢ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\n+   */\n+  searchRaw(command: string | Uint8Array): ISearchTask<IBaseSearchInfo, IBaseSearchResult> {\n+    if (this._status !== \"ready\") {\n+      throw new Error(\"Engine is not ready. Call load() first.\");\n+    }\n+\n+    this.emitStatusChange(\"busy\");\n+\n+    // å¤ã„ Promise ãŒæ®‹ã£ã¦ã„ãŸã‚‰ reject ã—ã¦ã‚¯ãƒªã‚¢ï¼ˆãƒªãƒ¼ã‚¯é˜²æ­¢ï¼‰\n+    if (this.pendingReject) {\n+      this.pendingReject(new EngineError(EngineErrorCode.INTERNAL_ERROR, \"New search started before previous completed\"));\n+      this.pendingReject = null;\n+      this.pendingResolve = null;\n+    }",
    "path": "packages/adapter-stockfish/src/stockfish.ts",
    "commit_id": "b83cd1cc903f37506f986ad6fb2feec970ae7f02",
    "original_commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**å¤ã„ `infoController` ãŒ close ã•ã‚Œãšã«ç½®ãæ›ãˆã‚‰ã‚Œã¾ã™**\n\næ–°ã—ã„æ¢ç´¢ã®é–‹å§‹å‰ã« `pendingReject` ã‚’å‘¼ã³å‡ºã—ã¦å‰å›ã® Promise ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦ã„ã¾ã™ãŒã€`infoController` ã‚’ close ã—ã¦ã„ãªã„ãŸã‚ã€å‰å›ã® info ã‚¹ãƒˆãƒªãƒ¼ãƒ ã® consumer ãŒãƒãƒ³ã‚°ã—ã¾ã™ã€‚\n\n<details>\n<summary>ğŸ› ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n     if (this.pendingReject) {\n       this.pendingReject(new EngineError(EngineErrorCode.INTERNAL_ERROR, \"New search started before previous completed\"));\n       this.pendingReject = null;\n       this.pendingResolve = null;\n+      if (this.infoController) {\n+        try { this.infoController.close(); } catch { /* already closed */ }\n+        this.infoController = null;\n+      }\n     }\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/adapter-stockfish/src/stockfish.ts` around lines 151 - 156,\nå‰å›ã®æ¤œç´¢ã‚’ä¸­æ–­ã™ã‚‹éš›ã« pendingReject/pendingResolve ã‚’å‘¼ã‚“ã§Promiseã‚’ç ´æ£„ã—ã¦ã„ã‚‹ãŒã€å¤ã„ infoController\nãŒ close ã•ã‚Œã¦ãŠã‚‰ãšå‰å›ã® info ã‚¹ãƒˆãƒªãƒ¼ãƒ ã® consumer ãŒãƒãƒ³ã‚°ã™ã‚‹ãŸã‚ã€è©²å½“ç®‡æ‰€ï¼ˆä¾‹: startSearch / æ¤œç´¢é–‹å§‹ãƒ­ã‚¸ãƒƒã‚¯å†…ã®\nthis.pendingReject ãƒ–ãƒ­ãƒƒã‚¯ï¼‰ã§ pendingReject ã‚’å‘¼ã¶å‰ã«ç¾åœ¨ã® this.infoController ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ç¢ºå®Ÿã«\nclose() ã‚’å‘¼ã³ã€å¿…è¦ãªã‚‰ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠã‚’è§£é™¤ã—ã¦ã‹ã‚‰ this.infoController = null ã«ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã—ã¦ãã ã•ã„ï¼ˆnull\nè¨­å®šã¯ this.pendingReject/this.pendingResolve ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨æ•´åˆã•ã›ã‚‹ã“ã¨ï¼‰ã€‚\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T12:18:30Z",
    "updated_at": "2026-02-11T12:18:32Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975313",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975313"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975313"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975313/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 151,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 156,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 166,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975319",
    "pull_request_review_id": 3784460554,
    "id": 2792975319,
    "node_id": "PRRC_kwDORJ0gd86meWvX",
    "diff_hunk": "@@ -1,15 +1,249 @@\n-import { IEngineAdapterMetadata } from \"@multi-game-engines/core\";\n+import {\n+  BaseAdapter,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  ILicenseInfo,\n+  IEngineSourceConfig,\n+  ISearchTask,\n+  UCIParser,\n+  WorkerCommunicator,\n+  IEngineLoader,\n+  EngineError,\n+  EngineErrorCode,\n+} from \"@multi-game-engines/core\";\n \n-export const stockfishMetadata: IEngineAdapterMetadata = {\n-  id: \"stockfish\",\n-  name: \"Stockfish via WASM\",\n-  version: \"16.1\",\n-  engineLicense: {\n+/**\n+ * Stockfish (WASM) ç”¨ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å®Ÿè£…ã€‚\n+ * \n+ * EngineLoader ã‚’ä»‹ã—ã¦ CDN (jsDelivr ç­‰) ã‹ã‚‰ WASM ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å–å¾—ã—ã€\n+ * WebWorker å†…ã§å®Ÿè¡Œã€UCI ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§é€šä¿¡ã‚’è¡Œã„ã¾ã™ã€‚\n+ */\n+export class StockfishAdapter extends BaseAdapter<\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult\n+> {\n+  readonly id = \"stockfish\";\n+  readonly name = \"Stockfish via WASM\";\n+  readonly version = \"16.1\";\n+\n+  readonly engineLicense: ILicenseInfo = {\n     name: \"GPL-3.0-only\",\n     url: \"https://stockfishchess.org/\",\n-  },\n-  adapterLicense: {\n+  };\n+\n+  readonly adapterLicense: ILicenseInfo = {\n     name: \"MIT\",\n     url: \"https://opensource.org/licenses/MIT\",\n-  },\n-};\n+  };\n+\n+  /** \n+   * ã‚¨ãƒ³ã‚¸ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã®è¨­å®šã€‚\n+   * TODO: æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒãƒƒã‚·ãƒ¥ã¨ã‚µã‚¤ã‚ºã‚’è‡ªå‹•ç”Ÿæˆã—ã¦åŸ‹ã‚è¾¼ã¿ã€æ”¹ç«„ã‚’é˜²æ­¢ã™ã‚‹ã“ã¨ã€‚\n+   * (Stage 1 ã§ã¯ç©ºæ–‡å­—åˆ—ã‚’è¨±å®¹ã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™)\n+   */\n+  readonly sources: Record<string, IEngineSourceConfig> = {\n+    main: {\n+      url: \"https://cdn.jsdelivr.net/npm/stockfish@16.1.0/src/stockfish.js\",\n+      sri: \"\", \n+      size: 0, \n+      type: \"worker-js\",\n+    },\n+  };\n+\n+  readonly parser = new UCIParser();\n+  private communicator: WorkerCommunicator | null = null;\n+  private pendingResolve: ((result: IBaseSearchResult) => void) | null = null;\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private pendingReject: ((reason?: any) => void) | null = null;\n+  private infoController: ReadableStreamDefaultController<IBaseSearchInfo> | null = null;\n+  private blobUrl: string | null = null;\n+  private activeLoader: IEngineLoader | null = null;\n+\n+  /**\n+   * ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€æº–å‚™å®Œäº†çŠ¶æ…‹ã«ã—ã¾ã™ã€‚\n+   */\n+  async load(loader?: IEngineLoader): Promise<void> {\n+    if (this._status === \"ready\") return;\n+\n+    const startTime = Date.now();\n+    this.emitStatusChange(\"loading\");\n+    this.activeLoader = loader || null;\n+\n+    try {\n+      let workerUrl = this.sources.main.url;\n+\n+      // ãƒ–ãƒªãƒƒã‚¸ã‹ã‚‰ãƒ­ãƒ¼ãƒ€ãƒ¼ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€SRIæ¤œè¨¼ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åˆ©ç”¨ã™ã‚‹\n+      if (loader) {\n+        this.emitProgress({ \n+          phase: \"downloading\", \n+          percentage: 10, \n+          i18n: { key: \"loading_resource\", defaultMessage: \"Loading engine resource...\" } \n+        });\n+        this.blobUrl = await loader.loadResource(this.id, this.sources.main);\n+        workerUrl = this.blobUrl;\n+      }\n+\n+      // WebWorker ã‚’èµ·å‹•ã—ã€é€šä¿¡è·¯ã‚’ç¢ºç«‹\n+      this.communicator = new WorkerCommunicator(workerUrl);\n+      await this.communicator.spawn();\n+      this.communicator.onMessage((data) => this.handleMessage(data));\n+\n+      // ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆUCIï¼‰åˆæœŸåŒ–\n+      this.communicator.postMessage(\"uci\");\n+      \n+      // 'uciok' ãŒè¿”ã‚‹ã®ã‚’å¾…ã¤ï¼ˆæœ€å¤§10ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼‰\n+      // AbortController ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚ã« expectMessage ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹\n+      const ac = new AbortController();\n+      const timeoutId = setTimeout(() => ac.abort(), 10000);\n+\n+      try {\n+        await this.communicator.expectMessage<string>(\n+          (data) => data === \"uciok\", \n+          { signal: ac.signal }\n+        );\n+      } catch (e) {\n+        if (ac.signal.aborted) {\n+          throw new EngineError(EngineErrorCode.SEARCH_TIMEOUT, \"UCI initialization timed out\");\n+        }\n+        throw e;\n+      } finally {\n+        clearTimeout(timeoutId);\n+      }\n+\n+      this.emitStatusChange(\"ready\");\n+      this.emitProgress({ \n+        phase: \"ready\", \n+        percentage: 100, \n+        i18n: { key: \"ready\", defaultMessage: \"Ready\" } \n+      });\n+      \n+      // çµ±è¨ˆæƒ…å ±ã®åé›†\n+      this.emitTelemetry({\n+        event: \"load_complete\",\n+        timestamp: Date.now(),\n+        attributes: { load_time_ms: Date.now() - startTime, cached: !!this.blobUrl }\n+      });\n+    } catch (error) {\n+      this.emitStatusChange(\"error\");\n+      \n+      // é€”ä¸­ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸå ´åˆã€Blob URL ãŒãƒªãƒ¼ã‚¯ã—ãªã„ã‚ˆã†ã«ç¢ºå®Ÿã«è§£æ”¾ã™ã‚‹\n+      if (this.blobUrl && loader) {\n+        loader.revoke(this.blobUrl);\n+        this.blobUrl = null;\n+      }\n+\n+      throw EngineError.from(error, this.id);\n+    }\n+  }\n+\n+  /**\n+   * æœªåŠ å·¥ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ¢ç´¢ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\n+   */\n+  searchRaw(command: string | Uint8Array): ISearchTask<IBaseSearchInfo, IBaseSearchResult> {\n+    if (this._status !== \"ready\") {\n+      throw new Error(\"Engine is not ready. Call load() first.\");\n+    }\n+\n+    this.emitStatusChange(\"busy\");\n+\n+    // å¤ã„ Promise ãŒæ®‹ã£ã¦ã„ãŸã‚‰ reject ã—ã¦ã‚¯ãƒªã‚¢ï¼ˆãƒªãƒ¼ã‚¯é˜²æ­¢ï¼‰\n+    if (this.pendingReject) {\n+      this.pendingReject(new EngineError(EngineErrorCode.INTERNAL_ERROR, \"New search started before previous completed\"));\n+      this.pendingReject = null;\n+      this.pendingResolve = null;\n+    }\n+\n+    // çµæœè¿”å´ç”¨ã® Promise\n+    const resultPromise = new Promise<IBaseSearchResult>((resolve, reject) => {\n+      this.pendingResolve = resolve;\n+      this.pendingReject = reject;\n+    });\n+\n+    // æ€è€ƒçŠ¶æ³ï¼ˆinfoï¼‰ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ç”¨ã® ReadableStream\n+    // æ³¨æ„: infoStream ã¯ä¸€åº¦ã ã‘æ¶ˆè²»ã•ã‚Œã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¾ã™ï¼ˆFacade ã§åˆ¶å¾¡ï¼‰\n+    const infoStream = new ReadableStream<IBaseSearchInfo>({\n+      start: (controller) => {\n+        this.infoController = controller;\n+      },\n+    });\n+\n+    const infoAsyncIterable: AsyncIterable<IBaseSearchInfo> = {\n+      [Symbol.asyncIterator]: () => {\n+        const reader = infoStream.getReader();\n+        return {\n+          async next(): Promise<IteratorResult<IBaseSearchInfo>> {\n+            const { done, value } = await reader.read();\n+            if (done) return { done: true, value: undefined };\n+            return { done: false, value: value! };\n+          },\n+        };\n+      },\n+    };\n+\n+    if (!this.communicator) {\n+        throw new EngineError(EngineErrorCode.INTERNAL_ERROR, \"Communicator is null\");\n+    }\n+    // ã‚¨ãƒ³ã‚¸ãƒ³ã«æ¢ç´¢ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡\n+    this.communicator.postMessage(command);\n+\n+    return {\n+      info: infoAsyncIterable,\n+      result: resultPromise,\n+      stop: async () => {\n+        if (this.communicator) {\n+            this.communicator.postMessage(this.parser.createStopCommand());\n+        }\n+      },\n+    };\n+  }\n+\n+  /**\n+   * ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å®Œå…¨ã«åœæ­¢ã—ã€ãƒªã‚½ãƒ¼ã‚¹ã‚’è§£æ”¾ã—ã¾ã™ã€‚\n+   */\n+  async dispose(): Promise<void> {\n+    if (this.pendingReject) {\n+      this.pendingReject(new EngineError(EngineErrorCode.INTERNAL_ERROR, \"Adapter disposed\"));\n+      this.pendingReject = null;\n+    }\n+    this.communicator?.terminate();\n+    this.communicator = null;\n+    \n+    // ç”Ÿæˆã•ã‚ŒãŸ Blob URL ã‚’è§£æ”¾\n+    if (this.blobUrl && this.activeLoader) {\n+      this.activeLoader.revoke(this.blobUrl);\n+      this.blobUrl = null;\n+    }\n+\n+    this.emitStatusChange(\"terminated\");\n+    this.clearListeners();\n+  }",
    "path": "packages/adapter-stockfish/src/stockfish.ts",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n**`dispose()` ã§ `pendingResolve` ã¨ `infoController` ãŒã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã•ã‚Œã¦ã„ã¾ã›ã‚“**\n\n1. `pendingReject` ã‚’å‘¼ã³å‡ºã—ãŸå¾Œã€`pendingResolve` ãŒ `null` ã«è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼ˆãƒ€ãƒ³ã‚°ãƒªãƒ³ã‚°å‚ç…§ï¼‰ã€‚\n2. ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªæ¢ç´¢ä¸­ã« `dispose()` ãŒå‘¼ã°ã‚Œã‚‹ã¨ã€`infoController` ãŒ close ã•ã‚Œãšã€info ã‚¹ãƒˆãƒªãƒ¼ãƒ ã® consumer ãŒãƒãƒ³ã‚°ã—ã¾ã™ã€‚\n\n<details>\n<summary>ğŸ› ä¿®æ­£æ¡ˆ</summary>\n\n```diff\n   async dispose(): Promise<void> {\n     if (this.pendingReject) {\n       this.pendingReject(new EngineError(EngineErrorCode.INTERNAL_ERROR, \"Adapter disposed\"));\n       this.pendingReject = null;\n+      this.pendingResolve = null;\n+    }\n+\n+    if (this.infoController) {\n+      try {\n+        this.infoController.close();\n+      } catch {\n+        // already closed\n+      }\n+      this.infoController = null;\n     }\n+\n     this.communicator?.terminate();\n     this.communicator = null;\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/adapter-stockfish/src/stockfish.ts` around lines 205 - 221, The\ndispose() method currently only calls pendingReject and leaves pendingResolve\ndangling and doesn't close the info stream; update dispose() so after invoking\npendingReject(...) you also set pendingResolve = null and pendingReject = null\nto avoid lingering references, and if an infoController exists call\ninfoController.close() (or equivalent shutdown method) and set infoController =\nnull so any consumers of the info stream are unblocked; keep the existing\ncommunicator termination, blobUrl revocation (activeLoader.revoke(this.blobUrl))\nand emitStatusChange(\"terminated\")/clearListeners() behavior.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:poseidon:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T12:18:30Z",
    "updated_at": "2026-02-11T12:18:32Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975319",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975319"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975319"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975319/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 164,
    "original_start_line": 205,
    "start_side": "RIGHT",
    "line": 177,
    "original_line": 221,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 231,
    "position": 187,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975322",
    "pull_request_review_id": 3784460554,
    "id": 2792975322,
    "node_id": "PRRC_kwDORJ0gd86meWva",
    "diff_hunk": "@@ -0,0 +1,201 @@\n+import {\n+  IEngineBridge,\n+  IEngineAdapter,\n+  IEngine,\n+  IMiddleware,\n+  ICapabilities,\n+  ISecurityStatus,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  MiddlewarePriority,\n+  EngineStatus,\n+  ILoadProgress,\n+  ITelemetryEvent,\n+  EngineErrorCode,\n+  IEngineLoader,\n+} from \"../types\";\n+import { EngineFacade } from \"./EngineFacade\";\n+import { CapabilityDetector } from \"../capabilities/CapabilityDetector\";\n+import { SecurityAdvisor } from \"../capabilities/SecurityAdvisor\";\n+import { EngineLoader } from \"./EngineLoader\";\n+import { createFileStorage } from \"../storage\";\n+import { EngineError } from \"../errors/EngineError\";\n+\n+/**\n+ * è¤‡æ•°ã®ã‚¨ãƒ³ã‚¸ãƒ³ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’é›†ä¸­ç®¡ç†ã™ã‚‹ãƒ–ãƒªãƒƒã‚¸ã‚¯ãƒ©ã‚¹ã€‚\n+ * \n+ * å½¹å‰²:\n+ * 1. å„ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ï¼ˆStockfish, ã‚„ã­ã†ã‚‰ç‹ç­‰ï¼‰ã®ç™»éŒ²ã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†\n+ * 2. ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒã‚§ãƒ¼ãƒ³ï¼ˆå…¥å‡ºåŠ›ã®åŠ å·¥ï¼‰ã®çµ±åˆ\n+ * 3. ã‚¨ãƒ³ã‚¸ãƒ³ã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªï¼‰ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é›†ç´„ï¼ˆãƒãƒ–ãƒªãƒ³ã‚°ï¼‰\n+ * 4. å®Ÿè¡Œç’°å¢ƒã®èƒ½åŠ›è¨ºæ–­ã¨ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã®æä¾›\n+ */\n+export class EngineBridge implements IEngineBridge {\n+  /**\n+   * ç™»éŒ²ã•ã‚ŒãŸã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ãƒãƒƒãƒ—ã€‚\n+   * ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼ˆOptions/Info/Resultï¼‰ãŒã‚¨ãƒ³ã‚¸ãƒ³ã”ã¨ã«ç•°ãªã‚‹ãŸã‚ã€\n+   * å†…éƒ¨ç®¡ç†ç”¨ã¨ã—ã¦æ„å›³çš„ã« any ã‚’è¨±å®¹ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ä¿æŒã—ã¾ã™ã€‚\n+   */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private adapters = new Map<string, IEngineAdapter<any, any, any>>();\n+  \n+  /** \n+   * ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«é©ç”¨ã•ã‚Œã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ãƒªã‚¹ãƒˆã€‚\n+   * é€šä¿¡ãƒ‡ãƒ¼ã‚¿å‹ãŒå¤šå²ã«ã‚ãŸã‚‹ãŸã‚ã€å†…éƒ¨çš„ã«ã¯ any ã‚’è¨±å®¹ã—ã¾ã™ã€‚\n+   */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private middlewares: IMiddleware<any, any>[] = [];\n+  \n+  /** ä½œæˆæ¸ˆã¿ Facade ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆæ’ä»–åˆ¶å¾¡ã®çŠ¶æ…‹ã‚’ç¶­æŒã™ã‚‹ãŸã‚ï¼‰ */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private facades = new Map<string, EngineFacade<any, any, any>>();\n+\n+  /** ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã”ã¨ã®ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­è§£é™¤é–¢æ•°ãƒªã‚¹ãƒˆ */\n+  private adapterUnsubscribers = new Map<string, (() => void)[]>();\n+\n+  /** éåŒæœŸã§åˆæœŸåŒ–ã•ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã® Promise */\n+  private loaderPromise: Promise<EngineLoader> | null = null;\n+\n+  // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ã‚»ãƒƒãƒˆ\n+  private statusListeners = new Set<(id: string, status: EngineStatus) => void>();\n+  private progressListeners = new Set<(id: string, progress: ILoadProgress) => void>();\n+  private telemetryListeners = new Set<(id: string, event: ITelemetryEvent) => void>();",
    "path": "packages/core/src/bridge/EngineBridge.ts",
    "commit_id": "590c674c4e6aa548c57e4eb5a3322e2561f6057d",
    "original_commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ¡ Minor_\n\n**`progressListeners` ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ãŒã€å¯¾å¿œã™ã‚‹ã‚°ãƒ­ãƒ¼ãƒãƒ«è³¼èª­ãƒ¡ã‚½ãƒƒãƒ‰ãŒãªã„**\n\nLine 62 ã§ `progressListeners` ãŒå®šç¾©ã•ã‚Œã€`registerAdapter` å†… (Line 115-117) ã§ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®é€²æ—ã‚¤ãƒ™ãƒ³ãƒˆãŒè»¢é€ã•ã‚Œã¦ã„ã¾ã™ãŒã€`onGlobalStatusChange` ã‚„ `onGlobalTelemetry` ã®ã‚ˆã†ãªå…¬é–‹ãƒ¡ã‚½ãƒƒãƒ‰ãŒ `progressListeners` ã«å¯¾ã—ã¦å­˜åœ¨ã—ã¾ã›ã‚“ã€‚é€²æ—ãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ã™ã‚‹æ‰‹æ®µãŒãªãã€`progressListeners` ã¯å¸¸ã«ç©ºã®ã¾ã¾ã§ã™ã€‚\n\n<details>\n<summary>â™»ï¸ `onGlobalProgress` ãƒ¡ã‚½ãƒƒãƒ‰ã®è¿½åŠ ææ¡ˆ</summary>\n\n```diff\n+  /**\n+   * å…¨ã‚¨ãƒ³ã‚¸ãƒ³ã®é€²æ—çŠ¶æ³ã‚’ä¸€æ‹¬ç›£è¦–ã—ã¾ã™ã€‚\n+   * `@returns` è³¼èª­è§£é™¤é–¢æ•°\n+   */\n+  onGlobalProgress(callback: (id: string, progress: ILoadProgress) => void): () => void {\n+    this.progressListeners.add(callback);\n+    return () => this.progressListeners.delete(callback);\n+  }\n```\n\nã¾ãŸã€`IEngineBridge` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã‚‚ `onGlobalProgress` ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\n</details>\n\n\n\n\nAlso applies to: 174-186\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/bridge/EngineBridge.ts` around lines 60 - 63, The file\ndefines progressListeners (private progressListeners) and forwards adapter\nprogress events in registerAdapter but lacks a public way to subscribe; add a\nnew public method onGlobalProgress(callback: (id: string, progress:\nILoadProgress) => void): () => void to EngineBridge and declare it on the\nIEngineBridge interface; implement it to add the callback to progressListeners\nand return an unsubscribe function (mirroring\nonGlobalStatusChange/onGlobalTelemetry behavior) so adapter-forwarded progress\nevents are actually received by consumers.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T12:18:30Z",
    "updated_at": "2026-02-11T12:18:32Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975322",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975322"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975322"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975322/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 60,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 63,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 63,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975323",
    "pull_request_review_id": 3784460554,
    "id": 2792975323,
    "node_id": "PRRC_kwDORJ0gd86meWvb",
    "diff_hunk": "@@ -0,0 +1,201 @@\n+import {\n+  IEngineBridge,\n+  IEngineAdapter,\n+  IEngine,\n+  IMiddleware,\n+  ICapabilities,\n+  ISecurityStatus,\n+  IBaseSearchOptions,\n+  IBaseSearchInfo,\n+  IBaseSearchResult,\n+  MiddlewarePriority,\n+  EngineStatus,\n+  ILoadProgress,\n+  ITelemetryEvent,\n+  EngineErrorCode,\n+  IEngineLoader,\n+} from \"../types\";\n+import { EngineFacade } from \"./EngineFacade\";\n+import { CapabilityDetector } from \"../capabilities/CapabilityDetector\";\n+import { SecurityAdvisor } from \"../capabilities/SecurityAdvisor\";\n+import { EngineLoader } from \"./EngineLoader\";\n+import { createFileStorage } from \"../storage\";\n+import { EngineError } from \"../errors/EngineError\";\n+\n+/**\n+ * è¤‡æ•°ã®ã‚¨ãƒ³ã‚¸ãƒ³ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’é›†ä¸­ç®¡ç†ã™ã‚‹ãƒ–ãƒªãƒƒã‚¸ã‚¯ãƒ©ã‚¹ã€‚\n+ * \n+ * å½¹å‰²:\n+ * 1. å„ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ï¼ˆStockfish, ã‚„ã­ã†ã‚‰ç‹ç­‰ï¼‰ã®ç™»éŒ²ã¨ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†\n+ * 2. ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒã‚§ãƒ¼ãƒ³ï¼ˆå…¥å‡ºåŠ›ã®åŠ å·¥ï¼‰ã®çµ±åˆ\n+ * 3. ã‚¨ãƒ³ã‚¸ãƒ³ã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªï¼‰ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é›†ç´„ï¼ˆãƒãƒ–ãƒªãƒ³ã‚°ï¼‰\n+ * 4. å®Ÿè¡Œç’°å¢ƒã®èƒ½åŠ›è¨ºæ–­ã¨ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã®æä¾›\n+ */\n+export class EngineBridge implements IEngineBridge {\n+  /**\n+   * ç™»éŒ²ã•ã‚ŒãŸã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ãƒãƒƒãƒ—ã€‚\n+   * ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼ˆOptions/Info/Resultï¼‰ãŒã‚¨ãƒ³ã‚¸ãƒ³ã”ã¨ã«ç•°ãªã‚‹ãŸã‚ã€\n+   * å†…éƒ¨ç®¡ç†ç”¨ã¨ã—ã¦æ„å›³çš„ã« any ã‚’è¨±å®¹ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ä¿æŒã—ã¾ã™ã€‚\n+   */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private adapters = new Map<string, IEngineAdapter<any, any, any>>();\n+  \n+  /** \n+   * ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«é©ç”¨ã•ã‚Œã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ãƒªã‚¹ãƒˆã€‚\n+   * é€šä¿¡ãƒ‡ãƒ¼ã‚¿å‹ãŒå¤šå²ã«ã‚ãŸã‚‹ãŸã‚ã€å†…éƒ¨çš„ã«ã¯ any ã‚’è¨±å®¹ã—ã¾ã™ã€‚\n+   */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private middlewares: IMiddleware<any, any>[] = [];\n+  \n+  /** ä½œæˆæ¸ˆã¿ Facade ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆæ’ä»–åˆ¶å¾¡ã®çŠ¶æ…‹ã‚’ç¶­æŒã™ã‚‹ãŸã‚ï¼‰ */\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  private facades = new Map<string, EngineFacade<any, any, any>>();\n+\n+  /** ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã”ã¨ã®ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­è§£é™¤é–¢æ•°ãƒªã‚¹ãƒˆ */\n+  private adapterUnsubscribers = new Map<string, (() => void)[]>();\n+\n+  /** éåŒæœŸã§åˆæœŸåŒ–ã•ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã® Promise */\n+  private loaderPromise: Promise<EngineLoader> | null = null;\n+\n+  // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ã‚»ãƒƒãƒˆ\n+  private statusListeners = new Set<(id: string, status: EngineStatus) => void>();\n+  private progressListeners = new Set<(id: string, progress: ILoadProgress) => void>();\n+  private telemetryListeners = new Set<(id: string, event: ITelemetryEvent) => void>();\n+\n+  /**\n+   * ç’°å¢ƒã«é©ã—ãŸ EngineLoader ã‚’éåŒæœŸã§å–å¾—ã—ã¾ã™ã€‚\n+   * åˆå›å‘¼ã³å‡ºã—æ™‚ã« CapabilityDetector ã¨ FileStorage ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚\n+   * åˆæœŸåŒ–ã«å¤±æ•—ã—ãŸå ´åˆã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã€å†è©¦è¡Œå¯èƒ½ã«ã—ã¾ã™ã€‚\n+   */\n+  async getLoader(): Promise<IEngineLoader> {\n+    if (!this.loaderPromise) {\n+      this.loaderPromise = (async () => {\n+        try {\n+          const caps = await this.checkCapabilities();\n+          const storage = createFileStorage(caps);\n+          return new EngineLoader(storage);\n+        } catch (err) {\n+          this.loaderPromise = null;\n+          throw err;\n+        }\n+      })();\n+    }\n+    return this.loaderPromise;\n+  }\n+\n+  /**\n+   * ã‚¨ãƒ³ã‚¸ãƒ³ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’ãƒ–ãƒªãƒƒã‚¸ã«ç™»éŒ²ã—ã¾ã™ã€‚\n+   * ç™»éŒ²æ™‚ã«ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ–ãƒªãƒƒã‚¸ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªã‚¹ãƒŠãƒ¼ã¸è»¢é€ã™ã‚‹è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚\n+   * æ—¢å­˜ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ãŒã‚ã‚‹å ´åˆã¯ã€å¤ã„ãƒªã‚¹ãƒŠãƒ¼ã‚’è§£é™¤ã—ã¦ä¸Šæ›¸ãã—ã¾ã™ã€‚\n+   */\n+  registerAdapter<\n+    T_OPTIONS extends IBaseSearchOptions,\n+    T_INFO extends IBaseSearchInfo,\n+    T_RESULT extends IBaseSearchResult,\n+  >(adapter: IEngineAdapter<T_OPTIONS, T_INFO, T_RESULT>): void {\n+    const id = adapter.id;\n+\n+    if (this.adapters.has(id)) {\n+      console.warn(`Adapter with ID \"${id}\" is already registered. Overwriting.`);\n+      // æ—¢å­˜ã®ãƒªã‚¹ãƒŠãƒ¼ã‚’è§£é™¤\n+      const oldUnsubs = this.adapterUnsubscribers.get(id);\n+      oldUnsubs?.forEach(unsub => unsub());\n+      this.adapterUnsubscribers.delete(id);\n+      // Facade ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚‚ç„¡åŠ¹åŒ–\n+      this.facades.delete(id);\n+    }\n+\n+    // ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å€‹åˆ¥ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ä¼æ’­ï¼ˆãƒãƒ–ãƒªãƒ³ã‚°ï¼‰ã•ã›ã‚‹\n+    const unsubscribers: (() => void)[] = [];\n+    \n+    unsubscribers.push(adapter.onStatusChange((status) => {\n+      this.statusListeners.forEach(cb => cb(id, status));\n+    }));\n+    \n+    unsubscribers.push(adapter.onProgress((progress) => {\n+      this.progressListeners.forEach(cb => cb(id, progress));\n+    }));\n+    \n+    if (adapter.onTelemetry) {\n+      unsubscribers.push(adapter.onTelemetry((event) => {\n+        this.telemetryListeners.forEach(cb => cb(id, event));\n+      }));\n+    }\n+\n+    this.adapterUnsubscribers.set(id, unsubscribers);\n+    this.adapters.set(id, adapter);\n+  }\n+\n+  /**\n+   * æŒ‡å®šã•ã‚ŒãŸã‚¨ãƒ³ã‚¸ãƒ³IDã«å¯¾å¿œã™ã‚‹åˆ©ç”¨è€…å‘ã‘ Facade ã‚’å–å¾—ã—ã¾ã™ã€‚\n+   * åŒä¸€IDã«å¯¾ã—ã¦ã¯åŒã˜ Facade ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã—ã€ã‚¿ã‚¹ã‚¯ã®çŠ¶æ…‹ï¼ˆæ’ä»–åˆ¶å¾¡ï¼‰ã‚’å…±æœ‰ã—ã¾ã™ã€‚\n+   * \n+   * @throws {EngineError} ã‚¨ãƒ³ã‚¸ãƒ³ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã«ç™ºç”Ÿ\n+   */\n+  getEngine<\n+    T_OPTIONS extends IBaseSearchOptions = IBaseSearchOptions,\n+    T_INFO extends IBaseSearchInfo = IBaseSearchInfo,\n+    T_RESULT extends IBaseSearchResult = IBaseSearchResult,\n+  >(id: string): IEngine<T_OPTIONS, T_INFO, T_RESULT> {\n+    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã‚ã‚Œã°ãã‚Œã‚’è¿”ã™\n+    if (this.facades.has(id)) {\n+      return this.facades.get(id) as unknown as IEngine<T_OPTIONS, T_INFO, T_RESULT>;\n+    }\n+\n+    const adapter = this.adapters.get(id);\n+    if (!adapter) {\n+      throw new EngineError(EngineErrorCode.INTERNAL_ERROR, `Engine \"${id}\" not found.`);\n+    }\n+\n+    // å„ªå…ˆåº¦ãŒé«˜ã„é †ã«ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ã‚½ãƒ¼ãƒˆ\n+    const sortedMiddlewares = [...this.middlewares].sort(\n+      (a, b) => (b.priority ?? MiddlewarePriority.NORMAL) - (a.priority ?? MiddlewarePriority.NORMAL)\n+    );\n+\n+    // åˆ©ç”¨è€…ã¯ã“ã® Facade ã‚’é€šã˜ã¦ã‚¨ãƒ³ã‚¸ãƒ³ã‚’æ“ä½œã™ã‚‹\n+    const facade = new EngineFacade<T_OPTIONS, T_INFO, T_RESULT>(adapter, sortedMiddlewares, this);\n+    this.facades.set(id, facade);\n+    \n+    return facade;\n+  }\n+\n+  /**\n+   * ãƒ–ãƒªãƒƒã‚¸å…¨ä½“ã«é©ç”¨ã™ã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’è¿½åŠ ã—ã¾ã™ã€‚\n+   * æ³¨æ„: æ—¢ç”Ÿæˆæ¸ˆã¿ã® Facade ã«ã¯åæ˜ ã•ã‚Œã¾ã›ã‚“ï¼ˆè¨­è¨ˆä¸Šã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ï¼‰ã€‚\n+   */\n+  use<T_INFO = unknown, T_RESULT = unknown>(middleware: IMiddleware<T_INFO, T_RESULT>): void {\n+    this.middlewares.push(middleware);\n+  }\n+\n+  /**\n+   * å…¨ã‚¨ãƒ³ã‚¸ãƒ³ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰åŒ–ã‚’ä¸€æ‹¬ç›£è¦–ã—ã¾ã™ã€‚\n+   * @returns è³¼èª­è§£é™¤é–¢æ•°\n+   */\n+  onGlobalStatusChange(callback: (id: string, status: EngineStatus) => void): () => void {\n+    this.statusListeners.add(callback);\n+    return () => this.statusListeners.delete(callback);\n+  }",
    "path": "packages/core/src/bridge/EngineBridge.ts",
    "commit_id": "fcf8e45b2bbfe1bf3ba6f8dac6a93f1fc9647b1b",
    "original_commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ¡ Minor_\n\n<details>\n<summary>ğŸ§© Analysis chain</summary>\n\nğŸ Script executed:\n\n```shell\n# Find the EngineBridge.ts file and check the implementation\nfind . -name \"EngineBridge.ts\" -type f | head -5\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 113\n\n---\n\nğŸ Script executed:\n\n```shell\n# Find the types.ts file in packages/core/src\nfind . -path \"*/packages/core/src/types.ts\" -type f\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 99\n\n---\n\nğŸ Script executed:\n\n```shell\n# Read EngineBridge.ts around lines 174-177 and 183-186\ncat -n ./packages/core/src/bridge/EngineBridge.ts | sed -n '170,190p'\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 770\n\n---\n\nğŸ Script executed:\n\n```shell\n# Read types.ts around lines 452-454 to see the IEngineBridge interface\ncat -n ./packages/core/src/types.ts | sed -n '450,460p'\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 490\n\n---\n\nğŸ Script executed:\n\n```shell\n# Search for usages of onGlobalStatusChange and onGlobalTelemetry\nrg -n 'onGlobalStatusChange|onGlobalTelemetry' --type=ts -A2\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 1102\n\n---\n\nğŸ Script executed:\n\n```shell\n# Check the line count of types.ts to understand context better\nwc -l ./packages/core/src/types.ts\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 103\n\n---\n\nğŸ Script executed:\n\n```shell\n# Check if EngineBridge implements IEngineBridge\ncat -n ./packages/core/src/bridge/EngineBridge.ts | head -30\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 1032\n\n---\n\nğŸ Script executed:\n\n```shell\n# Search for class declaration and implements clause\nrg -n 'class EngineBridge' --type=ts -A5\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 510\n\n---\n\nğŸ Script executed:\n\n```shell\n# Check for actual usages that call these methods\nrg -n 'onGlobalStatusChange\\(|onGlobalTelemetry\\(' --type=ts -B2 -A2\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 956\n\n---\n\nğŸ Script executed:\n\n```shell\n# Also check if there are any test files that test this behavior\nfd -e spec.ts -e test.ts | xargs rg -l 'onGlobalStatusChange|onGlobalTelemetry' 2>/dev/null\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 55\n\n---\n\nğŸ Script executed:\n\n```shell\n# Check if IEngineBridge is exported and used elsewhere\nrg -n 'IEngineBridge' --type=ts -B1 -A1 | head -50\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 1046\n\n---\n\nğŸ Script executed:\n\n```shell\n# Look for any variable typed as IEngineBridge\nrg -n ': IEngineBridge' --type=ts -B2 -A3\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 544\n\n---\n\nğŸ Script executed:\n\n```shell\n# Check if EngineFacade calls onGlobalStatusChange or onGlobalTelemetry through the bridge\ncat -n ./packages/core/src/bridge/EngineFacade.ts | head -100\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 3422\n\n---\n\nğŸ Script executed:\n\n```shell\n# Search for calls to these methods in EngineFacade\nrg -n 'this\\.bridge\\?.onGlobalStatusChange|this\\.bridge\\?.onGlobalTelemetry' --type=ts -B2 -A2\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 53\n\n---\n\nğŸ Script executed:\n\n```shell\n# Search more broadly for any calls to these methods\nrg -n '\\.onGlobalStatusChange|\\.onGlobalTelemetry' --type=ts\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 53\n\n---\n\nğŸ Script executed:\n\n```shell\n# Check the entire IEngineBridge interface definition\ncat -n ./packages/core/src/types.ts | sed -n '419,455p'\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 1561\n\n---\n\nğŸ Script executed:\n\n```shell\n# Let's double-check by looking at the complete context of both methods and how they're documented\ncat -n ./packages/core/src/bridge/EngineBridge.ts | sed -n '168,190p'\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 789\n\n---\n\n\n\n</details>\n\n**`onGlobalStatusChange` / `onGlobalTelemetry` ã®æˆ»ã‚Šå€¤å‹ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ä¸ä¸€è‡´**\n\nå®Ÿè£…ã§ã¯ `() => void`ï¼ˆè³¼èª­è§£é™¤é–¢æ•°ï¼‰ã‚’è¿”ã—ã¦ã„ã¾ã™ãŒã€`IEngineBridge` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆ`packages/core/src/types.ts` lines 452-454ï¼‰ã§ã¯ã“ã‚Œã‚‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®æˆ»ã‚Šå€¤ã¯ `void` ã¨å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚å‘¼ã³å‡ºã—å´ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹çµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å ´åˆã€è³¼èª­è§£é™¤é–¢æ•°ã‚’å–å¾—ã§ãã¾ã›ã‚“ã€‚\n\nå®Ÿè£…ã®JSDocã‚³ãƒ¡ãƒ³ãƒˆï¼ˆ`@returns è³¼èª­è§£é™¤é–¢æ•°`ï¼‰ã®æ„å›³ã‚’åæ˜ ã—ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®æˆ»ã‚Šå€¤å‹ã‚’ `() => void` ã«æ›´æ–°ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/bridge/EngineBridge.ts` around lines 174 - 177, The\nimplementation of onGlobalStatusChange and onGlobalTelemetry returns an\nunsubscribe function (() => void) but IEngineBridge currently types these\nmethods as returning void; update the IEngineBridge interface (methods\nonGlobalStatusChange and onGlobalTelemetry) to return () => void to match the\nimplementation and JSDoc so callers accessing the API via the interface can\nreceive the unsubscribe function.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T12:18:30Z",
    "updated_at": "2026-02-11T12:18:32Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975323",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975323"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975323"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 159,
    "original_start_line": 174,
    "start_side": "RIGHT",
    "line": 162,
    "original_line": 177,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 177,
    "position": 162,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975327",
    "pull_request_review_id": 3784460554,
    "id": 2792975327,
    "node_id": "PRRC_kwDORJ0gd86meWvf",
    "diff_hunk": "@@ -0,0 +1,77 @@\n+import { IFileStorage, IEngineSourceConfig, IEngineLoader, EngineErrorCode } from \"../types\";\n+import { SecurityAdvisor } from \"../capabilities/SecurityAdvisor\";\n+import { EngineError } from \"../errors/EngineError\";\n+\n+/**\n+ * ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒã‚¤ãƒŠãƒªã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®‰å…¨ã‹ã¤åŠ¹ç‡çš„ã«ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã®ã‚µãƒ¼ãƒ“ã‚¹ã€‚\n+ * \n+ * ç‰¹å¾´:\n+ * - SRI (Subresource Integrity) ã«ã‚ˆã‚‹æ”¹ç«„é˜²æ­¢\n+ * - FileStorage (OPFS/IndexedDB) ã«ã‚ˆã‚‹æ°¸ç¶šåŒ–ã‚­ãƒ£ãƒƒã‚·ãƒ¥\n+ * - Blob URL ã«ã‚ˆã‚‹ WebWorker ã®ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªèµ·å‹•\n+ */\n+export class EngineLoader implements IEngineLoader {\n+  constructor(private readonly storage: IFileStorage) {}\n+\n+  /**\n+   * æŒ‡å®šã•ã‚ŒãŸè¨­å®šã«åŸºã¥ã„ã¦ãƒªã‚½ãƒ¼ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚\n+   * ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ãã‚Œã‚’åˆ©ç”¨ã—ã€å­˜åœ¨ã—ãªã„å ´åˆã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚\n+   * \n+   * @returns ç”Ÿæˆã•ã‚ŒãŸ Blob URLã€‚WebWorker ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ç›´æ¥æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚\n+   * @throws {EngineError} SRIä¸ä¸€è‡´ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³æ™‚ã«ç™ºç”Ÿ\n+   */\n+  async loadResource(engineId: string, config: IEngineSourceConfig): Promise<string> {\n+    // 1. SRI ã®å½¢å¼ãƒã‚§ãƒƒã‚¯ (Fail-fast)\n+    if (config.sri && !SecurityAdvisor.isValidSRI(config.sri)) {\n+      throw new EngineError(\n+        EngineErrorCode.SRI_MISMATCH,\n+        `Invalid SRI hash format: ${config.sri}`,\n+        engineId\n+      );\n+    }\n+\n+    const cacheKey = `${engineId}_${config.sri}`;\n+    \n+    // 2. æ°¸ç¶šã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ã‹ã‚‰å–å¾—ã‚’è©¦ã¿ã‚‹\n+    const cached = await this.storage.get(cacheKey);\n+    if (cached) {\n+      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã‚ã‚Œã° Blob URL ã‚’ç”Ÿæˆã—ã¦å³åº§ã«è¿”ã™\n+      return URL.createObjectURL(new Blob([cached], { type: \"application/javascript\" }));",
    "path": "packages/core/src/bridge/EngineLoader.ts",
    "commit_id": "b83cd1cc903f37506f986ad6fb2feec970ae7f02",
    "original_commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ  Major_\n\n<details>\n<summary>ğŸ§© Analysis chain</summary>\n\nğŸ Script executed:\n\n```shell\n# EngineLoader.ts ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ ã‚’ç¢ºèª\nfind . -name \"EngineLoader.ts\" -type f\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 113\n\n---\n\nğŸ Script executed:\n\n```shell\n# IEngineSourceConfig ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®šç¾©ã‚’æ¢ã™\nrg -n \"interface IEngineSourceConfig|type IEngineSourceConfig\" --type ts -A 10\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 702\n\n---\n\nğŸ Script executed:\n\n```shell\n# EngineLoader.ts ã®è¡Œ 39 ã¨ 65 ã®å‰å¾Œã‚’ç¢ºèª\nrg -n \"createObjectURL\" --type ts -B 5 -A 2\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 1981\n\n---\n\nğŸ Script executed:\n\n```shell\n# IEngineSourceConfig ã®å®Œå…¨ãªå®šç¾©ã‚’å–å¾—\ncat -n packages/core/src/types.ts | sed -n '154,180p'\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 852\n\n---\n\nğŸ Script executed:\n\n```shell\n# loadResource ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Œå…¨ãªå®Ÿè£…ã‚’ç¢ºèª\ncat -n packages/core/src/bridge/EngineLoader.ts | head -70\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 2779\n\n---\n\nğŸ Script executed:\n\n```shell\n# è¿”ã•ã‚ŒãŸ blob URL ãŒã©ã“ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèª\nrg -n \"loadResource\" --type ts -A 10 | grep -E \"(loadResource|instantiate|WebAssembly)\" -A 5\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 2521\n\n---\n\nğŸ Script executed:\n\n```shell\n# WebAssembly ã®ä½¿ç”¨ç®‡æ‰€ã‚’ç¢ºèª\nrg -n \"instantiate|WebAssembly\" --type ts -B 2 -A 2\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 2894\n\n---\n\nğŸ Script executed:\n\n```shell\n# ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å®Ÿè£…ã‚’ç¢ºèª - stockfish ã¨ä»–ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼\nfd -e ts \"adapter\" --type f | head -20\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 160\n\n---\n\nğŸ Script executed:\n\n```shell\n# config.type ã«åŸºã¥ã„ã¦ãƒªã‚½ãƒ¼ã‚¹ã‚’ã©ã†æ‰±ã†ã‹ã‚’ç¢ºèª\nrg -n 'config\\.type|\\.type.*case' --type ts -B 2 -A 2\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 53\n\n---\n\nğŸ Script executed:\n\n```shell\n# config.type ã®ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åºƒãæ¤œç´¢\nrg -n \"type\" packages/core/src/bridge/EngineLoader.ts packages/adapter-stockfish/src/\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 745\n\n---\n\nğŸ Script executed:\n\n```shell\n# WASM ã® instantiate ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œç´¢\nrg -n \"instantiate|fetch.*wasm\" --type ts\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 53\n\n---\n\nğŸ Script executed:\n\n```shell\n# BaseAdapter ã®å®Ÿè£…ã‚’ç¢ºèª\ncat -n packages/core/src/adapters/BaseAdapter.ts | head -100\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 3473\n\n---\n\nğŸ Script executed:\n\n```shell\n# ã™ã¹ã¦ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å®Ÿè£…ã‚’ç¢ºèª\nfind packages -name \"*.ts\" -path \"*/adapter-*/src/*\" -type f | head -20\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 154\n\n---\n\nğŸ Script executed:\n\n```shell\n# IEngineSourceConfig ã® sources ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ä½¿ç”¨æ–¹æ³•ã‚’ç¢ºèª\nrg -n \"sources\\.\" --type ts -B 2 -A 2\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 871\n\n---\n\nğŸ Script executed:\n\n```shell\n# WebWorker ã§ BLOB URL ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª\nrg -n \"new Worker|WorkerCommunicator\" --type ts -B 3 -A 3\n```\n\nRepository: hdkz-dev/multi-game-engines\n\nLength of output: 8238\n\n---\n\n\n\n</details>\n\n**`config.type` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå®Œå…¨ã«ç„¡è¦–ã•ã‚Œã¦ãŠã‚Šã€MIME ã‚¿ã‚¤ãƒ—ã®æ±ºå®šãŒãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹**\n\n`IEngineSourceConfig.type` ã«ã¯ `\"wasm\"`, `\"worker-js\"`, `\"webgpu-compute\"` ç­‰ 5 ã¤ã®å®Ÿè¡Œã‚¿ã‚¤ãƒ—ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ãŒã€`EngineLoader.loadResource()` ã§ã¯ã“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä¸€åˆ‡ä½¿ç”¨ã›ãšã€å¸¸ã« `\"application/javascript\"` ã‚’ Blob ã® MIME ã‚¿ã‚¤ãƒ—ã¨ã—ã¦å›ºå®šã—ã¦ã„ã¾ã™ã€‚\n\nç¾åœ¨ã¯ stockfish ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ï¼ˆ`\"worker-js\"` ã‚¿ã‚¤ãƒ—ã®ã¿ï¼‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãŸã‚å®Ÿå®³ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€å°†æ¥ WASM ã‚„ WebGPU ãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹éš›ã«ã¯ã€ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦æ­£ã—ã„ MIME ã‚¿ã‚¤ãƒ—ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚`WebAssembly.instantiateStreaming()` ã‚„å„ç’°å¢ƒã® MIME ã‚¿ã‚¤ãƒ—æ¤œè¨¼ã§å•é¡ŒãŒç”Ÿã˜ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\n\n<details>\n<summary>â™»ï¸ config.type ã«åŸºã¥ã MIME ã‚¿ã‚¤ãƒ—ã®åˆ‡ã‚Šæ›¿ãˆå®Ÿè£…</summary>\n\n```diff\n+  private getMimeType(config: IEngineSourceConfig): string {\n+    switch (config.type) {\n+      case \"wasm\":\n+        return \"application/wasm\";\n+      case \"webgpu-compute\":\n+        return \"application/octet-stream\";\n+      default:\n+        return \"application/javascript\";\n+    }\n+  }\n+\n   async loadResource(engineId: string, config: IEngineSourceConfig): Promise<string> {\n     // ...\n     if (cached) {\n-      return URL.createObjectURL(new Blob([cached], { type: \"application/javascript\" }));\n+      return URL.createObjectURL(new Blob([cached], { type: this.getMimeType(config) }));\n     }\n     // ...\n-    return URL.createObjectURL(new Blob([data], { type: \"application/javascript\" }));\n+    return URL.createObjectURL(new Blob([data], { type: this.getMimeType(config) }));\n   }\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/bridge/EngineLoader.ts` at line 39,\nEngineLoader.loadResource() currently hardcodes the Blob MIME type to\n\"application/javascript\" and ignores IEngineSourceConfig.type; change the logic\naround the Blob creation (the line returning URL.createObjectURL(new\nBlob([cached], { type: ... }))) to switch the MIME type based on config.type\n(use \"application/wasm\" for \"wasm\", \"application/javascript\" for \"worker-js\" and\nJS-based adapters like \"webgpu-compute\", and a safe fallback such as\n\"application/octet-stream\" for unknown types) so that\nWebAssembly.instantiateStreaming and other consumers receive the correct\nContent-Type; ensure you reference IEngineSourceConfig.type when selecting the\ntype and keep the existing URL.createObjectURL/new Blob flow.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T12:18:30Z",
    "updated_at": "2026-02-11T12:18:32Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975327",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975327"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975327"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 39,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 39,
    "position": 1,
    "subject_type": "line"
  },
  {
    "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975331",
    "pull_request_review_id": 3784460554,
    "id": 2792975331,
    "node_id": "PRRC_kwDORJ0gd86meWvj",
    "diff_hunk": "@@ -0,0 +1,77 @@\n+import { IFileStorage, IEngineSourceConfig, IEngineLoader, EngineErrorCode } from \"../types\";\n+import { SecurityAdvisor } from \"../capabilities/SecurityAdvisor\";\n+import { EngineError } from \"../errors/EngineError\";\n+\n+/**\n+ * ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒã‚¤ãƒŠãƒªã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®‰å…¨ã‹ã¤åŠ¹ç‡çš„ã«ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã®ã‚µãƒ¼ãƒ“ã‚¹ã€‚\n+ * \n+ * ç‰¹å¾´:\n+ * - SRI (Subresource Integrity) ã«ã‚ˆã‚‹æ”¹ç«„é˜²æ­¢\n+ * - FileStorage (OPFS/IndexedDB) ã«ã‚ˆã‚‹æ°¸ç¶šåŒ–ã‚­ãƒ£ãƒƒã‚·ãƒ¥\n+ * - Blob URL ã«ã‚ˆã‚‹ WebWorker ã®ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªèµ·å‹•\n+ */\n+export class EngineLoader implements IEngineLoader {\n+  constructor(private readonly storage: IFileStorage) {}\n+\n+  /**\n+   * æŒ‡å®šã•ã‚ŒãŸè¨­å®šã«åŸºã¥ã„ã¦ãƒªã‚½ãƒ¼ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚\n+   * ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ãã‚Œã‚’åˆ©ç”¨ã—ã€å­˜åœ¨ã—ãªã„å ´åˆã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚\n+   * \n+   * @returns ç”Ÿæˆã•ã‚ŒãŸ Blob URLã€‚WebWorker ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ç›´æ¥æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚\n+   * @throws {EngineError} SRIä¸ä¸€è‡´ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³æ™‚ã«ç™ºç”Ÿ\n+   */\n+  async loadResource(engineId: string, config: IEngineSourceConfig): Promise<string> {\n+    // 1. SRI ã®å½¢å¼ãƒã‚§ãƒƒã‚¯ (Fail-fast)\n+    if (config.sri && !SecurityAdvisor.isValidSRI(config.sri)) {\n+      throw new EngineError(\n+        EngineErrorCode.SRI_MISMATCH,\n+        `Invalid SRI hash format: ${config.sri}`,\n+        engineId\n+      );\n+    }\n+\n+    const cacheKey = `${engineId}_${config.sri}`;\n+    \n+    // 2. æ°¸ç¶šã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ã‹ã‚‰å–å¾—ã‚’è©¦ã¿ã‚‹\n+    const cached = await this.storage.get(cacheKey);\n+    if (cached) {\n+      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã‚ã‚Œã° Blob URL ã‚’ç”Ÿæˆã—ã¦å³åº§ã«è¿”ã™\n+      return URL.createObjectURL(new Blob([cached], { type: \"application/javascript\" }));\n+    }\n+\n+    // 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒãªã„å ´åˆã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰å–å¾— (SRI æ¤œè¨¼ä»˜ã)\n+    const options = SecurityAdvisor.getSafeFetchOptions(config.sri);\n+    const response = await fetch(config.url, {\n+      ...options,\n+      signal: AbortSignal.timeout(30_000), // 30ç§’ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ\n+    });",
    "path": "packages/core/src/bridge/EngineLoader.ts",
    "commit_id": "b83cd1cc903f37506f986ad6fb2feec970ae7f02",
    "original_commit_id": "bd47e2424e56651184dda7892c06bc57f0b5f9f6",
    "user": {
      "login": "coderabbitai[bot]",
      "id": 136622811,
      "node_id": "BOT_kgDOCCSy2w",
      "avatar_url": "https://avatars.githubusercontent.com/in/347564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coderabbitai%5Bbot%5D",
      "html_url": "https://github.com/apps/coderabbitai",
      "followers_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coderabbitai%5Bbot%5D/received_events",
      "type": "Bot",
      "user_view_type": "public",
      "site_admin": false
    },
    "body": "_âš ï¸ Potential issue_ | _ğŸŸ¡ Minor_\n\n**`fetch` + `response.arrayBuffer()` ã§ SRI æ¤œè¨¼ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«æ³¨æ„**\n\n`fetch` API ã® `integrity` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£å…¨ä½“ã®æ¶ˆè²»å¾Œã«æ¤œè¨¼ã•ã‚Œã¾ã™ã€‚`response.ok` ãƒã‚§ãƒƒã‚¯ï¼ˆLine 49ï¼‰ã¯ HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ã¿ã‚’æ¤œæŸ»ã—ã€SRI ä¸ä¸€è‡´ã¯ `fetch` è‡ªä½“ãŒ reject ã™ã‚‹ãŸã‚ã€ã“ã“ã§ã¯å•é¡Œã‚ã‚Šã¾ã›ã‚“ãŒã€Line 57 ã® `response.arrayBuffer()` ãŒã‚¨ãƒ©ãƒ¼ã‚’æŠ•ã’ãŸå ´åˆã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ‡æ–­ã‚„ SRI ä¸ä¸€è‡´ã®ä¾‹å¤–ãŒ `EngineError` ã«ãƒ©ãƒƒãƒ—ã•ã‚Œãšã«ä¼æ’­ã—ã¾ã™ã€‚\n\n<details>\n<summary>ğŸ›¡ï¸ fetch + arrayBuffer ã‚’ã¾ã¨ã‚ã¦ EngineError ã§ãƒ©ãƒƒãƒ—ã™ã‚‹ææ¡ˆ</summary>\n\n```diff\n     // 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒãªã„å ´åˆã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰å–å¾— (SRI æ¤œè¨¼ä»˜ã)\n     const options = SecurityAdvisor.getSafeFetchOptions(config.sri);\n-    const response = await fetch(config.url, {\n-      ...options,\n-      signal: AbortSignal.timeout(30_000), // 30ç§’ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ\n-    });\n-    \n-    if (!response.ok) {\n+    let data: ArrayBuffer;\n+    try {\n+      const response = await fetch(config.url, {\n+        ...options,\n+        signal: AbortSignal.timeout(30_000),\n+      });\n+      if (!response.ok) {\n+        throw new EngineError(\n+          EngineErrorCode.NETWORK_ERROR,\n+          `Failed to download engine resource: ${config.url} (${response.status})`,\n+          engineId\n+        );\n+      }\n+      data = await response.arrayBuffer();\n+    } catch (err) {\n+      if (err instanceof EngineError) throw err;\n       throw new EngineError(\n         EngineErrorCode.NETWORK_ERROR,\n-        `Failed to download engine resource: ${config.url} (${response.status})`,\n-        engineId\n+        `Failed to fetch engine resource: ${config.url}`,\n+        engineId,\n+        err\n       );\n     }\n-\n-    const data = await response.arrayBuffer();\n```\n</details>\n\n<details>\n<summary>ğŸ¤– Prompt for AI Agents</summary>\n\n```\nIn `@packages/core/src/bridge/EngineLoader.ts` around lines 44 - 47, The fetch and\nsubsequent response.arrayBuffer() call in EngineLoader (where you call\nfetch(config.url, {..., signal: AbortSignal.timeout(30_000)})) must be wrapped\nin a single try/catch so any network errors, SRI mismatch rejections, or\narrayBuffer() failures are caught and rethrown as an EngineError; update the\nlogic around the fetch + response.arrayBuffer() sequence to catch all\nexceptions, include the config.url and HTTP status/context in the EngineError\nmessage, and preserve the original error as the cause so callers of EngineLoader\ncan handle failures uniformly.\n```\n\n</details>\n\n<!-- fingerprinting:phantom:medusa:phoenix -->\n\n<!-- This is an auto-generated comment by CodeRabbit -->",
    "created_at": "2026-02-11T12:18:30Z",
    "updated_at": "2026-02-11T12:18:32Z",
    "html_url": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975331",
    "pull_request_url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975331"
      },
      "html": {
        "href": "https://github.com/hdkz-dev/multi-game-engines/pull/8#discussion_r2792975331"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/8"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/hdkz-dev/multi-game-engines/pulls/comments/2792975331/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 44,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 47,
    "side": "RIGHT",
    "author_association": "NONE",
    "original_position": 47,
    "position": 1,
    "subject_type": "line"
  }
]
