# アーキテクチャと設計

このドキュメントでは、`multi-game-engines` の設計原則と技術アーキテクチャについて説明します。

## コアコンセプト

システムは主に3つのレイヤーで構成されています。

1.  **ブリッジ (Core)**: エンジンのライフサイクルを管理し、統一されたAPIを提供するオーケストレーター。
2.  **アダプターインターフェース**: すべてのエンジン実装が遵守すべき厳密に定義されたインターフェース。
3.  **エンジンアダプター**: 統一されたAPIコールをエンジン固有のコマンド（チェスのUCI、将棋のUSIなど）に変換する実装レイヤー。

## プラグインシステム

誰でもプラグインを作成できるように、`@multi-game-engines/core` パッケージは `BaseAdapter` クラスと `IEngine` インターフェースをエクスポートします。

### 拡張性

共通のタスク（探索、指し手、評価）のための統一インターフェースを提供しつつ、エンジン独自の機能を活用できる設計にしています。アダプターはエンジン固有のメソッドを公開でき、ユーザーはTypeScriptのジェネリクスを使用して型安全にアクセスできます。

```typescript
const stockfish = bridge.getEngine<StockfishAdapter>('stockfish');
stockfish.setSkillLevel(20); // エンジン固有のメソッド
```

## ライセンス戦略

- **コア (Core)**: MITライセンス。エンジン固有のコードを含まず、あらゆるプロジェクトで使用可能です。
- **アダプター (Adapters)**: 各アダプターは個別のnpmパッケージです。これにより、StockfishのようなGPLライセンスのエンジンをエコシステムに含めつつ、コアライブラリや利用者のアプリケーションにGPLを強制することを避けることができます（そのアダプターを明示的に使用しない限り）。

## エンジンのロード (WASM/リモート)

エンジンのロード方法はアダプターが責任を持ちます。
- **WASM**: アダプターパッケージに `.wasm` ファイルを含めるか、実行時にCDNから取得します。
- **Worker**: メインスレッドをブロックしないよう、アダプターはエンジンの実行にWeb Workerを使用することが推奨されます。